<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Webpack 基础入门 | 林之介4rozeN</title><meta name="keywords" content="webpack"><meta name="author" content="4rozeN"><meta name="copyright" content="4rozeN"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Webpack 基础入门"><meta name="application-name" content="Webpack 基础入门"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Webpack 基础入门"><meta property="og:url" content="https://4rozen.github.io/posts/37010.html"><meta property="og:site_name" content="林之介4rozeN"><meta property="og:description" content="本篇文章是Webpack的入门学习笔记，详细记录了从零开始配置Webpack工程的完整过程。内容包含处理TypeScript、JavaScript兼容性（Babel）、CSS&amp;#x2F;Sass、图片字体等静态资源的方法，以及搭建开发环境（webpack-dev-server, ESLint）和生产环境优化（"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E5%89%8D%E7%AB%AF/webpack_basic.webp"><meta property="article:author" content="4rozeN"><meta property="article:tag" content="blog, programming, CTF, Vue, backend, Git, Uni-app"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E5%89%8D%E7%AB%AF/webpack_basic.webp"><meta name="description" content="本篇文章是Webpack的入门学习笔记，详细记录了从零开始配置Webpack工程的完整过程。内容包含处理TypeScript、JavaScript兼容性（Babel）、CSS&amp;#x2F;Sass、图片字体等静态资源的方法，以及搭建开发环境（webpack-dev-server, ESLint）和生产环境优化（"><link rel="shortcut icon" href="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/ico/favicon.ico"><link rel="canonical" href="https://4rozen.github.io/posts/37010.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><meta name="google-site-verification" content="ggjgSh07y0_dbMruvoZhis-cgZn-t6ujdG7N1z7ZA88"/><meta name="msvalidate.01" content="F0E34077A7291AC38724F6A3804B1B29"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.7.2/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/node-snackbar/0.1.16/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/fancyapps-ui/6.0.30/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"等你回来(∠・ω< )⌒☆","backTitle":"欢迎回来(‾◡◝)"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://4rozen-blog.netlify.app/.netlify/functions/twikoo',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":1},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"both","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: undefined,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"bottom","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":120,"languages":{"author":"作者: 4rozeN","link":"链接: ","source":"来源: 林之介4rozeN","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '林之介4rozeN',
  title: 'Webpack 基础入门',
  postAI: '',
  pageFillDescription: ' 前言,  概念,  功能,  创建简单工程,  核心概念,  基础配置,  开发模式与生产模式概念,  处理 TS,  ts-loader,  js 兼容性问题,  Babel,  核心功能,  常见应用场景,  应用 Babel,  为什么 ts-loader 需要跳过类型检查,  fork-ts-checker-webpack-plugin,  处理 CSS,  处理 sass,  处理图片资源,  分类输出资源,  处理字体图标资源,  处理其他资源,  处理 Html 资源,  搭建开发服务器,  ESLint,  安装 ESLint,  ESLint 配置,  生产模式,  dev 环境,  prod 环境,  改写命令脚本,  CSS 提取优化,  MiniCssExtractPlugin,  CSS 兼容性,  优化 css 的 loader 结构,  CSS 压缩,  html 和 js 压缩前言相关知识较为琐碎学习起来需要静心本文基于文档和一些视频资料记录一些基础配置概念完成入门概念本质上是一个用于现代应用程序的静态模块打包工具当处理应用程序时它会在内部从一个或多个入口点构建一个依赖图然后将你项目中所需的每一个模块组合成一个或多个它们均为静态资源用于展示你的内容功能本体功能是有限的开发模式仅能编译中的语法生产模式能编译中的语法还能压缩代码创建简单工程在一个空的目录下执行命令创建以下结构的项目简单导入安装和是核心本体而则是命令行工具用来和人类进行交互的表示安装到开发环境在的项可以找到和是两种不同的交互前者为命令行式后者则是可视化界面对于什么时候安装到开发环境什么时候安装到生产环境区分原则就是运行时是否需要该依赖对于我们还需要安装核心概念入口这将指定从哪个文件开始分析依赖进行打包输出这将指定打包完的文件输出到哪里去加载器本体只能处理其他资源需要借助才能解析插件扩展的功能模式主要分为两种模式和基础配置入口起点指示应该使用哪个模块来作为构建其内部依赖图的开始这就是说你需要给指定一个分析入口就会从这个入口文件中分析得到一张依赖关系图本身不会运行你的代码此阶段只专注于分析依赖入口起点其默认值为一般通过的配置文件进行配置可以指定一个或多个不同的入口对于我们目前的项目结构入口文件就是在项目根目录下新建文件引入的模块入口文件从入口文件开始解析依赖关系这样就做好了入口文件的标识的配置文件运行在环境下的所以默认采用模块语法而不是语法具体应该选哪种语法其实取决于项目结构以及所依赖的生态环境默认最常见历史原因目前绝大多数插件和的文档与示例仍然使用兼容性最好几乎所有版本都支持现代写法在支持后可以把配置文件写成使用时需要在里加或者把文件命名为更适合想要在前后端统一用的项目如果是学习小项目用更省心如果整个项目已经全局采用比如生态可以考虑配置也写属性告诉在哪里输出它所创建的以及如何命名这些文件主要输出文件的默认值是其他生成文件默认放置在文件夹中你可以通过在配置中指定一个字段来配置这些处理过程引入的模块入口文件从入口文件开始解析依赖关系输出文件名是的全局变量代表当前执行脚本所在的目录每次打包前清空目录再就是加载器和插件了当前我们的项目比较简单干净所以目前并不需要可以留空先看看运行效果你还可以根据字段给指定运行模式有和两种默认是所以最后一个简单的配置文件如下引入的模块入口文件从入口文件开始解析依赖关系输出文件名是的全局变量代表当前执行脚本所在的目录每次打包前清空目录配置插件配置表示的运行模式有和两种默认是开发模式与生产模式概念通过选项来区分运行环境常见的有开发模式和生产模式开发模式优化点速度优先帮助开发调试特点不压缩不混淆代码构建更快自动启用方便定位源码保留有用的警告和错误信息通常配合实现热更新生产模式优化点体积优先帮助上线运行更快特点自动压缩并混淆删除未使用代码自动分离优化缓存作用域提升减少函数包装输出的尽可能小加载更快本文前半段的相关配置基本关注于开发模式在这个模式下我们先前提到本身并不能处理除了和以外的文件所以我们需要配置一系列东西帮助完成工作处理现在基本项目都需要用到那么优先处理是必要的否则无法输出正确的写一段简单的式的代码如下定义一个类型定义一个函数使用函数操作因为我们之前已经在中引入了所以我们可以直接运行看看没有经过任何配置的将输出什么样的执行命令这将输出定义一个类型可以看到无法处理该文件并贴心提示你你或许需要一个合适的来处理该文件类型于是我们来安装帮处理文件有的同学可能会问我们之前不是用已经安装了吗那直接配置不就好了是的但这不是说两者只需要一个而是他们完全可以搭配干活完成更精细的控制对于编译器它只会做语法检查转换成不会做打包不处理的依赖不打包图片而是个打包工具他本身不懂有了后不用单独跑在打包时就会自动把转成这就是说整个工作流程如下当我们安装了之后并且配置了文件再执行时发现要处理文件它调用编译器读取按配置比如转成输出再交给打包于是我们编写的如下配置匹配文件后缀名为或的文件当中有多个时会从右到左依次执行排除目录提升编译速度并且在根目录下创建编译范围指定编译的文件目录我们来逐项说明指定编译之后的语法版本取决于项目需要兼容多旧的浏览器比如最终代码能在老旧的上运行现在一般是支持等常用特性告诉编译器生成的模块化方案这里是最新的语法详细解释常见取值现代模块始终使用支持的最新语法输出场景现代打包工具支持与类似但只保证符合版本场景需要固定在标准不跟随的更新系列输出场景里最常见的模块系统老旧工具链默认配置文件就是输出风格模块依赖场景老项目前端按需加载通用模块定义兼容全局变量场景要发布一个库给不同环境使用时输出模块场景用动态加载模块的老项目特定引入的新选项模拟的真实模块解析方式支持里的场景写服务端项目特别是用时推荐允许用语法导入模块比如否则你要写在导入路径时强制区分大小写防止在大小写不敏感的文件系统如上编译通过但在上运行失败指定编译时要包含的库声明文件影响类型检查和代码补全提供等类型提供最新的内置对象类型比如这里的中我写主要是为了给后面的高版本语法转换预留的现在写好了配置文件也配置好了可以运行试试了执行命令不出意外肯定是编译成功的但是我们也无法通过实际效果亲眼看到这是因为我们的是引入的的我们需要给它改成下的此时页面就能正常看到效果了兼容性问题但是这就完了吗其实上述操作编译过后的文件是有可能存在一定的兼容性问题的对于老旧浏览器例如只会降级语法比如删除函数但不会新的特性比如还需要来处理是一个编译器对于来说是它的一个核心功能语法转换箭头函数普通函数构造函数原型垫片新等自动引入来兼容老环境插件和预设插件处理具体语法比如预设插件集合比如常见应用场景前端保证新语法在旧浏览器可运行项目转换项目用最新语法但运行在老版本库开发发布前打包成多种模块格式应用我们首先来重写一下方便展示转换效果定义类型模拟异步请求使用的是否包含操作接着我们安装安装完成之后在中进行配置配置匹配文件后缀名为或的文件使用进行编译当中有多个时会从右到左依次执行使用进行编译跳过类型检查提升编译速度使用进行编译当数组中有多个时会从右到左依次执行排除目录提升编译速度因为处理的是所以它需要运行在之后等待被转换为这里的需要我们提供一个配置文件也可以直接写在中使用预设这里是而不是预设名这里的如果存在多个预设处理顺序也是从右到左解释如下的核心预设用来根据目标环境决定要转换哪些语法和它包含了大量插件例如箭头函数转换插件模板字符串转换插件新方法插件指定代码需要兼容哪些环境浏览器使用率大于的浏览器不包含停止更新的浏览器强制兼容告诉按需注入而不是全量引入例如会检测到你用到了自动引入对应而不是把所有都打包进去指定的版本会用提供缺失的为什么需要跳过类型检查这里为什么需要跳过类型检查呢这是因为编译过程中包含类型检查构建速度较慢因为编译时要等类型检查完成如果项目较小是可以的如果项目是中大型项目完全可以新开独立进程交给完成的工作流程仅转译到跳过类型检查做语法转换比如转成等在单独的进程里做类型检查需要注意的是对三个东西的版本都有要求更多要求详见其文档目前我们的项目中可以在中找到和它们都是高于要求的所以可以使用配置如下引入插件此时再进行编译这将报错这是因为我们没有安装无法进行这也是文档的一个小问题了有时候不会指明全部需要的依赖项执行安装命令安装到生产环境为什么是生产依赖呢前面说过安装到生产还是开发环境主要看它需不需要被运行这里我们为了追求编译打包后的代码体积小所以采用的是按需使用而不是会在编译过后的代码文件中依然引用如果是全量引入那就要在入口文件中手动引入在入口文件手动引入全量引入情况下不再插入单独模块而是依赖入口文件的全量导入也就可以不在生产环境使用了此时再次执行编译命令就可以到查找是否在转换后使用了模拟异步请求使用的是否包含操作能看到相关的导入语句可以说明已经发生了处理前面提到本身不能处理除了和以外的资源所以也要借助来处理即注意文档中可能没有提到安装自己在安装时需要一起安装接着我们在中创建然后在入口文件中进行引用最后在配置文件中配置此时就可以编译试试了处理对于和如果你会了其中一种那么其他的大差不差本文在此介绍的处理方法安装配置将字符串生成为节点将转化成模块将编译成那么我们在目录下删除别忘记移除入口文件中对它的引入然后创建一个和文件来检验当然这两个文件也需要到入口文件中进行引入之后执行编译命令之后应该就能看到效果了处理图片资源在时处理图片资源通过的是将资源原封不动地输出和将图片转换为格式可指定大小阈值现在已经将这两个功能内置了我们只需要简单配置一下即可要处理图片首先要有图片资源我将下面这张浪客剑心追忆篇的海报和风骚律师的海报放入到中如果你没有图片资源可以下载下面这两张图片测试按照文档进行配置可以通过搜索找到文档详见资源模块打包成静态资源图片大小小于的会被转为格式配置好了但是我们还没指定图片放在哪于是在中给页面增加两个用来放图接着在和中写样式追忆风骚律师执行编译命令之后可以看到追忆被输出为原数据格式而风骚律师则被输出为格式分类输出资源观察打包目录可以看到输出结果是没有分类的我们最好对各类资源进行分类这样方便管理修改配置文件输出文件名输出文件名是的全局变量代表当前执行脚本所在的目录每次打包前清空目录配置匹配文件后缀名为的文件输出文件名匹配文件后缀名为或的文件输出文件名匹配文件后缀名为的文件打包成静态资源图片大小小于的会被转为格式输出文件名中使用文件原名使用文件指纹取生成的值的前位使用原扩展名和需要说明的是和是两个不同的占位符整个项目构建的值一次构建一个值缺点只要有一个文件改动所有文件的都会变缓存不友好根据内容生成的不同的值不同优点只改动某个入口文件时其他的文件名不变更适合持久缓存根据文件内容生成最精细化的方式只有内容变化时才会生成新的适合生产环境比如抽离文件常用处理字体图标资源要处理字体图标资源首先得要有这些资源推荐从阿里巴巴矢量图标库中下载这些资源随便点开一个图标库将一些图标加入到项目需要登录如果此前没有项目就需要创建项目如果已经有项目直接选择一个项目加入到项目即可加入之后将会跳转到项目详情页我们将这些图标资源下载到本地仅作演示以后图标资源也可能是通过服务器得到的下载到本地的图标资源是一个压缩包的形式我们将其剪切到目录下并将其解压解压后的目录如下这之中的也可以指导你如何使用图标资源这三种方式主要是兼容性的区别在以上可以使用在以上可以用在以上可以用我们一般使用的方式进行使用依照指导文档我们将剪切到目录中需要注意的是中引入的路径需要进行修改我们将字体文件从的深层目录移动出来剪切到目录下然后将中的路径修改如下别忘了我们还得导入才能被打包在中引入此时就可以执行打包命令看看效果了不过默认打包的结构肯定不是我们期望的我们可以像配置图片资源一样配置它们原味输出静态资源输出文件名表示将资源原封不动的输出这里为了输出字体文件名短点所以不保留原名了为了在页面中能显示这三个图标我们还需要按照的指导加入标签别忘记更新的路径名和图标名一致这样执行打包命令就可以在看到效果了处理其他资源其实上述资源已经是我们经常会使用到的资源了处理其他资源如视频资源等我们也只需要原封不动将其输出就可以了所以就扩大一下的匹配范围就行扩大匹配范围原味输出静态资源输出文件名处理资源安装接着在配置文件中进行引入并配置引入启用插件并且在中取消手动引入编译后的不再需要手动引入此时执行打包命令你会发现打包输出的中所以我们还需要给这个插件配置字段插件配置参数指定生成的以哪个文件为参考生成结构参数指定生成的以哪个文件为参考生成一致的元素结构搭建开发服务器每次写完代码都需要手动执行打包命令才能同步代码太麻烦了我们安装来自动化执行然后在的配置文件中进行配置插件配置参数指定生成的以哪个文件为参考生成结构主机名端口号静态文件目录自动打开浏览器此时打包命令需要执行的是需要注意的是如果使用开发服务器那么实际是不会输出文件的编译打包结果存在内存之中可组装的和检查工具主要被用来检测和语法可以配置各种功能安装在中是一个而在中是一个插件执行命令安装和到开发环境在配置文件中进行引入指定要约束的文件位置指定要检查的文件后缀名插件没完全兼容的版本带来的需要手动指定路径配置和一样也是依照配置文件工作配置文件有很多种写法写在中配置项适合简单项目会自动查找读取它们配置文件只需要存在一个其中写法是推出的新标准叫做平面配置逐步替代它必须是一个文件如果你的项目用的工具链都比较新比如最新版建议直接用如果你需要兼容老工具暂时用更省心我们这里使用写法需要注意的是我们的项目环境默认在环境而环境下文件默认是模块我们需要将配置文件后缀改为就会自动按方式解析你也可以在中声明但是一旦加了项目里的所有文件都变成会影响等其他配置所以除非项目的相关生态能统一所有配置文件全为一种语法要么全是要么全是否则还是只改个别文件的后缀让自己识别为好于是我们在根目录下创建由于的配置项十分的多所以我们一般不会自己手写全部规则而是使用官方推荐的规则然后在官方的规则下面写一些自定义的规则覆盖冲突规则即可例如官方维护的推荐规则集代替了过去里常用的官方的插件解析器集成了和推荐用法提供常见的全局变量集合比如等让知道这些名字是合法的不会误报上面三个基本够用了执行安装命令接着我们配置完整的全局基础规则和推荐规则下的前端代码浏览器环境下的配置环境允许允许忽略不需要检查的文件如果是旧的配置应当是其中中的指的是或者前者是历史渊源后者是通俗解释生产模式在生产模式下我们主要关注代码运行速度代码打包速度在根目录下创建目录将根目录下的移动到目录下重命名为并复制一份重命名为环境我们对进行修改引入的模块入口文件从入口文件开始解析依赖关系输出文件名是的全局变量代表当前执行脚本所在的目录开发模式无输出每次打包前清空目录配置插件配置指定要约束的文件位置指定要检查的文件后缀名插件没完全兼容的版本带来的需要手动指定路径参数指定生成的以哪个文件为参考生成结构主机名端口号静态文件目录自动打开浏览器启用源码地图表示的运行模式有和两种默认是在开发模式下编译打包发生在内存中没有输出结果不会写入到磁盘变成文件所以的我写成实际开发模式会忽略此项配置因为我们改动了配置文件所在的路径需要给使用绝对路径的配置项纠正路径所以插件部分的的路径都往上了一级入口文件为什么不改呢首先入口文件并非绝对路径其次因为是运行在环境中的的运行环境又是相对于执行命令时的路径也就是根目录所以入口文件不需要改动也能找到正确的文件它直接走的模块查找机制最终解析到中的绝对路径和配置文件在哪个目录没关系环境生产环境也需要修改配置文件引入的模块入口文件从入口文件开始解析依赖关系输出文件名是的全局变量代表当前执行脚本所在的目录是的全局变量代表当前执行脚本所在的目录每次打包前清空目录配置插件配置指定要约束的文件位置指定要检查的文件后缀名插件没完全兼容的版本带来的需要手动指定路径参数指定生成的以哪个文件为参考生成结构主机名端口号静态文件目录自动打开浏览器表示的运行模式有和两种默认是改写命令脚本前面我们配置了现在又分离了开发和生产环境此时执行命令急需改造修改将原来的项改成下面配置的是一个对象所以其中的命令顺序没有关系配置了上述命令脚本以后我们使用开发模式进行查看就只需要运行简单的命令这将先触发的检查然后再启动开发服务器一旦检测到语法问题触发报错打包将停止生产模式同理执行简单命令即可打包生成静态结果提取优化目前我们打包有个问题被打包到文件中样式只能等待到被执行完毕才能被应用而在执行的过程中浏览器可能已经渲染出了原始的结构页面表现为裸结构等待到执行完毕标签终于被插入完毕样式被应用浏览器又重新渲染这在用户看来就是闪屏现象针对这个现象我们要做的就是把单独提取出来变成标签让可以和并行下载并且在首次渲染之前就能应用样式避免闪屏为什么单独抽取为标签可以避免闪屏要知道为什么需要你对浏览器渲染原理有一定了解可以看看我之前写的浏览器渲染原理简单来说当浏览器解析遇到会下载启动的预解析线程使得在较早阶段可用浏览器会等待关键就绪再做首次完全渲染即使主解析线程继续解析渲染会等因此当是通过提前可用时首次绘制就包含正确样式从而避免闪屏出现代价是阻塞渲染的时间但通常能改善一点视觉稳定性如果你想验证可以按照下面的思路进行在本地启动并使用在一般浏览器叫开发者工具的设置为并禁用刷新页面你会看到先是裸文本再有样式在面板录制加载过程查看首次绘制和后面的能明显看到样式注入引起的重排临时把放到头部或把直接注入观察差异安装插件安装之后我们就不再需要了顾名思义它就是用来动态插入生成标签的我们将其改为匹配文件后缀名为的文件输出文件名匹配文件后缀名为或的文件输出文件名注意改动的是生产环境的配置文件别搞错了这之后可以使用打包命令看看效果了可以看到默认是打包到了目录下我们自然希望它在目录下所以继续配置插件输出文件名这样就好了兼容性兼容性是老生常谈的问题了我们一般使用来解决在中是一个安装命令接着修改的开发配置文件匹配文件后缀名为的文件预设输出文件名匹配文件后缀名为或的文件能解决大部分的兼容性问题输出文件名请注意中的执行顺序是从右到左所以对于普通的应当是将配置写在最右让其第一个被执行先处理兼容性问题然后让处理内容最后让提取文件为标签对于等应当是将配置写在预编译之后让处理预编译得到的代码而非和代码除了预设我们还可以让知道兼容性要做到什么程度在中增加配置实际上兼容性不需要做到如此好此处仅作演示兼容的浏览器版本越久远就越需要更多的兼容性代码文件体积也会一定程度的增加一般我们会配置为注释仅供参考实际不需要每个主流浏览器的最近两个版本全球市场份额大于的浏览器太旧的不考虑排除掉已经废弃的浏览器因为我们此前的中使用到了而布局是存在一定兼容性问题的所以我们可以直接执行生产打包看看效果变成了这就说明正确配置了优化的结构目前我们的配置中关于的相关是存在一定重复代码的因为我没有处理每一种所以较少如果你们写了那就很多重复代码了我们可以将它们抽离为函数精简代码结构引入的模块配置匹配文件后缀名为的文件输出文件名匹配文件后缀名为或的文件输出文件名这里函数的参数是剩余参数所以传入多个参数时需要理解的处理顺序从右到左传入合适的参数例如输出此时也能正确处理压缩压缩需要使用到插件安装命令引入插件与等配置项平级压缩文件执行生产打包命令之后如果看到目录下的文件如果是一行那就说明压缩生效了和压缩目前打包后会自动压缩但是并不会说实话这很奇怪按理来说是都会被压缩的翻看了官方文档译自带最新的如果你使用的是或更高版本并且希望自定义选项你仍然需要安装说实话我没看懂这左右脑互搏的说明自带安装过了安装引入并应用这样执行生产打包就能看到效果了我后来想了想文档的意思应该是如果你覆盖了默认的比如加了就必须自己安装并手动添加否则不会压缩至此基础篇完结撒花最终代码地址',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-09-21 01:41:25',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 8 || hour >= 22
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="referrer" content="no-referrer" /><link rel="shortcut icon" href="/img/ico/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/css/anzhiyu.css"><link href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@300..700&family=Noto+Sans+SC:wght@100..900&family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/rss2.xml" title="林之介4rozeN" type="application/rss+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/avatar/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://4rozen.github.com/" title="我的博客"><img class="back-menu-item-icon" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/ico/favicon.ico" alt="我的博客"/><span class="back-menu-item-text">我的博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="https://4rozen.github.io/sliph-scope-view/" title="个体值修改"><img class="back-menu-item-icon" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/icon/%E5%B0%8F%E7%81%AB%E9%BE%99.png" alt="个体值修改"/><span class="back-menu-item-text">个体值修改</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/4rozeN/Simple-Animated-Guns-Fixed" title="MC枪械模组"><img class="back-menu-item-icon" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E6%88%91%E7%9A%84%E9%A1%B9%E7%9B%AE/SAG.jpg" alt="MC枪械模组"/><span class="back-menu-item-text">MC枪械模组</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/4rozeN/Datapack_S.A.G" title="SAG数据包"><img class="back-menu-item-icon" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E6%88%91%E7%9A%84%E9%A1%B9%E7%9B%AE/SAG.jpg" alt="SAG数据包"/><span class="back-menu-item-text">SAG数据包</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">林之介4rozeN</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)" rel="external nofollow noreferrer">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 文章分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 文章标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/loveU/wx_zanshang.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" alt="微信" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/loveU/wx_zanshang.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/loveU/alipay_zanshang.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/loveU/alipay_zanshang.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/API/" style="font-size: 1.05rem;">API<sup>1</sup></a><a href="/tags/Bootstrap/" style="font-size: 1.05rem;">Bootstrap<sup>1</sup></a><a href="/tags/Bug/" style="font-size: 1.05rem;">Bug<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 1.05rem;">CSS<sup>2</sup></a><a href="/tags/CTF-WP/" style="font-size: 1.05rem;">CTF-WP<sup>1</sup></a><a href="/tags/DOH/" style="font-size: 1.05rem;">DOH<sup>1</sup></a><a href="/tags/Fabric/" style="font-size: 1.05rem;">Fabric<sup>3</sup></a><a href="/tags/Fluid/" style="font-size: 1.05rem;">Fluid<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>1</sup></a><a href="/tags/GitHubActions/" style="font-size: 1.05rem;">GitHubActions<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>6</sup></a><a href="/tags/JS%E8%AE%A1%E6%97%B6%E5%99%A8/" style="font-size: 1.05rem;">JS计时器<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem;">JavaScript<sup>5</sup></a><a href="/tags/Minecraft/" style="font-size: 1.05rem;">Minecraft<sup>5</sup></a><a href="/tags/Modding/" style="font-size: 1.05rem;">Modding<sup>1</sup></a><a href="/tags/PHP/" style="font-size: 1.05rem;">PHP<sup>1</sup></a><a href="/tags/React/" style="font-size: 1.05rem;">React<sup>1</sup></a><a href="/tags/Strapi/" style="font-size: 1.05rem;">Strapi<sup>1</sup></a><a href="/tags/Vue/" style="font-size: 1.05rem;">Vue<sup>2</sup></a><a href="/tags/Windows11/" style="font-size: 1.05rem;">Windows11<sup>1</sup></a><a href="/tags/ejs/" style="font-size: 1.05rem;">ejs<sup>1</sup></a><a href="/tags/fluid/" style="font-size: 1.05rem;">fluid<sup>2</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>1</sup></a><a href="/tags/github/" style="font-size: 1.05rem;">github<sup>1</sup></a><a href="/tags/http/" style="font-size: 1.05rem;">http<sup>1</sup></a><a href="/tags/indexnow/" style="font-size: 1.05rem;">indexnow<sup>1</sup></a><a href="/tags/python/" style="font-size: 1.05rem;">python<sup>1</sup></a><a href="/tags/ssh/" style="font-size: 1.05rem;">ssh<sup>1</sup></a><a href="/tags/styl/" style="font-size: 1.05rem;">styl<sup>1</sup></a><a href="/tags/uni-app/" style="font-size: 1.05rem;">uni-app<sup>1</sup></a><a href="/tags/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/" style="font-size: 1.05rem;">事件循环<sup>1</sup></a><a href="/tags/%E5%85%A8%E6%88%90%E5%B0%B1%E5%B8%AE%E6%89%8B/" style="font-size: 1.05rem;">全成就帮手<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.05rem;">反序列化<sup>1</sup></a><a href="/tags/%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6/" style="font-size: 1.05rem;">属性描述符<sup>2</sup></a><a href="/tags/%E5%BC%82%E6%AD%A5/" style="font-size: 1.05rem;">异步<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%A4%9C%E5%88%87%E6%8D%A2%E8%83%8C%E6%99%AF/" style="font-size: 1.05rem;">日夜切换背景<sup>1</sup></a><a href="/tags/%E6%A8%A1%E7%BB%84%E5%BC%80%E5%8F%91/" style="font-size: 1.05rem;">模组开发<sup>1</sup></a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">笔记<sup>4</sup></a><a href="/tags/%E7%BE%8E%E5%8C%96/" style="font-size: 1.05rem;">美化<sup>3</sup></a><a href="/tags/%E9%9D%9E%E9%A2%84%E6%9C%9F%E8%BE%93%E5%85%A5/" style="font-size: 1.05rem;">非预期输入<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/09/"><span class="card-archive-list-date">九月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);" rel="external nofollow noreferrer"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/webpack/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>webpack</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Webpack 基础入门</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-03-02T00:50:13.000Z" title="发表于 2025-03-02 08:50:13">2025-03-02</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-09-20T17:41:25.753Z" title="更新于 2025-09-21 01:41:25">2025-09-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">11k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>42分钟</span></span></div></div></div><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E5%89%8D%E7%AB%AF/webpack_basic.webp"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://4rozen.github.io/posts/37010"><header><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a><a href="/tags/webpack/" tabindex="-1" itemprop="url">webpack</a><h1 id="CrawlerTitle" itemprop="name headline">Webpack 基础入门</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">4rozeN</span><time itemprop="dateCreated datePublished" datetime="2025-03-02T00:50:13.000Z" title="发表于 2025-03-02 08:50:13">2025-03-02</time><time itemprop="dateCreated datePublished" datetime="2025-09-20T17:41:25.753Z" title="更新于 2025-09-21 01:41:25">2025-09-21</time></header><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2>
<p>webpack 相关知识较为琐碎，学习起来需要静心。</p>
<p>本文基于 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://webpack.js.org/concepts/">Webpack v5 文档</a>和一些视频资料，记录一些基础配置、概念，完成 webpack 入门。</p>
<h2 id="概念"><a class="markdownIt-Anchor" href="#概念"></a> 概念</h2>
<p>本质上，<strong>webpack</strong> 是一个用于现代 JavaScript 应用程序的 <em>静态模块打包工具</em>。当 webpack 处理应用程序时，它会在内部从一个或多个入口点构建一个 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/concepts/dependency-graph/">依赖图 (dependency graph)</a>，然后将你项目中所需的每一个模块组合成一个或多个 <em>bundles</em>，它们均为静态资源，用于展示你的内容。</p>
<h2 id="功能"><a class="markdownIt-Anchor" href="#功能"></a> 功能</h2>
<p>webpack 本体功能是有限的：</p>
<ul>
<li>开发模式：仅能编译 JS 中的 <code>ES module</code> 语法</li>
<li>生产模式：能编译 JS 中的 <code>ES module</code> 语法，还能压缩 JS 代码</li>
</ul>
<h2 id="创建简单工程"><a class="markdownIt-Anchor" href="#创建简单工程"></a> 创建简单工程</h2>
<p>在一个空的目录下，执行命令：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></tbody></table></figure>
<p>创建以下结构的项目：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">├─📁 dist</span><br><span class="line">├─📁 src</span><br><span class="line">│ ├─📁 css</span><br><span class="line">│ ├─📁 font</span><br><span class="line">│ ├─📁 img</span><br><span class="line">│ ├─📄 asset.d.ts</span><br><span class="line">│ └─📄 index.ts</span><br><span class="line">├─📄 index.html</span><br><span class="line">├─📄 package-lock.json</span><br><span class="line">├─📄 package.json</span><br><span class="line">└─📄 webpack.config.js</span><br></pre></td></tr></tbody></table></figure>
<p><code>index.html</code> 简单导入 <code>index.ts</code>：</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>webpack-ts<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./src/index.ts"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>安装 webpack 和 webpack-cli：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack webpack-cli -D</span><br></pre></td></tr></tbody></table></figure>
<p>webpack 是核心本体，而 webpack-cli 则是命令行工具，用来和人类进行交互的；<code>-D</code> 表示安装到开发环境 <code>development</code>（在 <code>package.json</code> 的 <code>devDependencies</code> 项可以找到）。</p>
<blockquote>
<p><code>CLI（Command-Line Interface）</code>和 <code>GUI（Graphical User Interface）</code>是两种不同的交互，前者为命令行式，后者则是可视化界面。</p>
<p>对于什么时候安装到开发环境，什么时候安装到生产环境，区分原则就是：<strong>运行时是否需要该依赖</strong></p>
</blockquote>
<p>对于 ts，我们还需要安装 ts：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D typescript</span><br></pre></td></tr></tbody></table></figure>
<h2 id="核心概念"><a class="markdownIt-Anchor" href="#核心概念"></a> 核心概念</h2>
<ol>
<li>entry（入口）<br>
这将指定 webpack 从哪个文件开始分析依赖，进行打包</li>
<li> output（输出）<br>
这将指定 webpack 打包完的文件输出到哪里去</li>
<li> loader（加载器）<br>
webpack 本体只能处理 js、json，其他资源需要借助 loader 才能解析</li>
<li> plugins（插件）<br>
扩展 webpack 的功能</li>
<li> mode（模式）<br>
主要分为两种模式：<code>development</code> 和 <code>production</code></li>
</ol>
<h2 id="基础配置"><a class="markdownIt-Anchor" href="#基础配置"></a> 基础配置</h2>
<p><strong>入口起点 (entry point)</strong> 指示 webpack 应该使用哪个模块，来作为构建其内部 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/concepts/dependency-graph/">依赖图 (dependency graph)</a> 的开始。这就是说，你需要给 webpack 指定一个分析入口，webpack 就会从这个入口文件中分析得到一张依赖关系图，<strong>webpack 本身不会运行你的代码</strong>，此阶段只专注于分析依赖。</p>
<p>入口起点，其默认值为：<code>./src/index.js</code>，一般通过 webpack 的配置文件进行配置，可以指定一个或多个不同的入口。对于我们目前的项目结构，入口文件就是<code>./src/index.ts</code></p>
<p>在项目根目录下新建文件：<code>webpack.config.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>); <span class="comment">// 引入node.js的path模块</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">'./src/index.ts'</span>, <span class="comment">// 入口文件，webpack从入口文件开始解析依赖关系</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>这样就做好了入口文件的标识。</p>
<div class="note info no-icon flat"><p>Webpack 的配置文件运行在 <strong>Node.js 环境</strong> 下的，所以默认采用 <strong>CommonJS（CJS）</strong> 模块语法（<code>require</code> / <code>module.exports</code>），而不是 <strong>ECMAScript Modules（ESM）</strong> 语法（<code>import</code> / <code>export</code>）。</p>
<p>具体应该选哪种语法，其实取决于项目结构以及所依赖的生态环境：</p>
<p>1、<strong>CJS（默认 &amp; 最常见）</strong></p>
<ul>
<li>历史原因，目前绝大多数 Webpack 插件和 Loader 的文档与示例仍然使用 CJS。</li>
<li>兼容性最好，几乎所有 Node.js 版本都支持。</li>
</ul>
<p>2、<strong>ESM（现代写法）</strong></p>
<ul>
<li>在 Node.js 12+ 支持 ES Modules 后，可以把 Webpack 配置文件写成 ESM。</li>
<li>使用时需要在 <code>package.json</code> 里加 <code>"type": "module"</code>，或者把文件命名为 <code>webpack.config.mjs</code>。</li>
<li>更适合想要在前后端统一用 <code>import/export</code> 的项目。</li>
</ul>
<p>如果是学习 / 小项目，用 <strong>CJS</strong> 更省心。</p>
<p>如果整个项目已经全局采用 <strong>ESM</strong>（比如 Vue 3 + Vite 生态），可以考虑 Webpack 配置也写 ESM。</p>
</div>
<p><strong>output</strong> 属性告诉 webpack 在哪里输出它所创建的 <em>bundle</em>，以及如何命名这些文件。主要输出文件的默认值是 <code>./dist/main.js</code>，其他生成文件默认放置在 <code>./dist</code> 文件夹中。</p>
<p>你可以通过在配置中指定一个 <code>output</code> 字段，来配置这些处理过程：</p>
<p><code>webpack.config.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>); <span class="comment">// 引入node.js的path模块</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">'./src/index.ts'</span>, <span class="comment">// 入口文件，webpack从入口文件开始解析依赖关系</span></span><br><span class="line">  <span class="attr">output</span>: {</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">'main.js'</span>, <span class="comment">// 输出文件名</span></span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">'dist'</span>), <span class="comment">// __dirname是node.js的全局变量，代表当前执行脚本所在的目录</span></span><br><span class="line">    <span class="attr">clean</span>: <span class="literal">true</span> <span class="comment">// 每次打包前清空dist目录</span></span><br><span class="line">  },</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>再就是加载器和插件了，当前我们的项目比较简单干净，所以目前并不需要，可以留空先看看 webpack 运行效果。</p>
<p>你还可以根据 mode 字段给 webpack 指定运行模式，有 development 和 production 两种，默认是 production。所以，最后一个简单的 webpack 配置文件如下：</p>
<p><code>webpack.config.js</code>：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>); <span class="comment">// 引入node.js的path模块</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">'./src/index.ts'</span>, <span class="comment">// 入口文件，webpack从入口文件开始解析依赖关系</span></span><br><span class="line">  <span class="attr">output</span>: {</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">'main.js'</span>, <span class="comment">// 输出文件名</span></span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">'dist'</span>), <span class="comment">// __dirname是node.js的全局变量，代表当前执行脚本所在的目录</span></span><br><span class="line">    <span class="attr">clean</span>: <span class="literal">true</span> <span class="comment">// 每次打包前清空dist目录</span></span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// loader配置</span></span><br><span class="line">  <span class="attr">module</span>: {</span><br><span class="line">    <span class="attr">rules</span>: []</span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// 插件配置</span></span><br><span class="line">  <span class="attr">plugins</span>: [],</span><br><span class="line">  <span class="comment">// mode表示webpack的运行模式，有development和production两种，默认是production</span></span><br><span class="line">  <span class="attr">mode</span>: <span class="string">"development"</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="开发模式与生产模式概念"><a class="markdownIt-Anchor" href="#开发模式与生产模式概念"></a> 开发模式与生产模式概念</h2>
<p>Webpack 通过 <code>mode</code> 选项来区分运行环境，常见的有 <strong>development</strong>（开发模式） 和 <strong>production</strong>（生产模式）。</p>
<ol>
<li>开发模式（<code>mode: "development"</code>）</li>
</ol>
<ul>
<li>优化点：速度优先，帮助开发调试。</li>
<li>特点：
<ul>
<li>不压缩、不混淆代码。构建更快。</li>
<li>自动启用 <code>eval-cheap-module-source-map</code>，方便定位源码。</li>
<li>保留有用的警告和错误信息。</li>
<li>通常配合 <code>webpack-dev-server</code> 实现热更新。</li>
</ul>
</li>
</ul>
<ol start="2">
<li>生产模式（<code>mode: "production"</code>）</li>
</ol>
<ul>
<li>优化点：体积优先，帮助上线运行更快。</li>
<li>特点：
<ul>
<li>自动压缩（TerserPlugin）并混淆 JS。</li>
<li>Tree Shaking（删除未使用代码）。</li>
<li>自动分离 runtime，优化缓存。</li>
<li>scope hoisting（作用域提升），减少函数包装。</li>
<li>输出的 bundle 尽可能小、加载更快。</li>
</ul>
</li>
</ul>
<p>本文前半段的相关配置基本关注于开发模式。</p>
<p>在这个模式下，我们先前提到 webpack 本身并不能处理除了 js 和 json 以外的文件，所以我们需要配置一系列东西帮助 webpack 完成工作。</p>
<h2 id="处理ts"><a class="markdownIt-Anchor" href="#处理ts"></a> 处理 TS</h2>
<p>现在基本项目都需要用到 TS，那么优先处理 TS 是必要的，否则无法输出正确的 js。</p>
<p>写一段简单的 <code>hello, world</code> 式的 ts 代码如下：<code>src/index.ts</code></p>
<figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = {</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个函数</span></span><br><span class="line"><span class="keyword">const</span> greet = (<span class="attr">user</span>: <span class="title class_">User</span>): <span class="function"><span class="params">string</span> =&gt;</span> <span class="string">`Hello, <span class="subst">${user.name}</span>!`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">me</span>: <span class="title class_">User</span> = { <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">"Webpack + TS"</span> };</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">greet</span>(me));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 操作 DOM</span></span><br><span class="line"><span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">"div"</span>);</span><br><span class="line">el.<span class="property">textContent</span> = <span class="title function_">greet</span>(me);</span><br><span class="line">el.<span class="property">className</span> = <span class="string">"greeting"</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(el);</span><br></pre></td></tr></tbody></table></figure>
<p>因为我们之前已经在 <code>index.html</code> 中引入了 <code>index.ts</code>，所以我们可以直接运行 <code>webpack</code> 看看没有经过任何配置的 <code>webpack</code> 将输出什么样的 js：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行命令</span></span><br><span class="line">npx webpack</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这将输出：</span></span><br><span class="line">npx webpack</span><br><span class="line">asset main.js 1.51 KiB [emitted] (name: main)</span><br><span class="line">./src/index.ts 424 bytes [built] [code generated] [1 error]</span><br><span class="line"></span><br><span class="line">ERROR <span class="keyword">in</span> ./src/index.ts 2:5</span><br><span class="line">Module parse failed: Unexpected token (2:5)</span><br><span class="line">You may need an appropriate loader to handle this file <span class="built_in">type</span>, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders</span><br><span class="line">| // 定义一个类型</span><br><span class="line">&gt; <span class="built_in">type</span> User = {</span><br><span class="line">|     <span class="built_in">id</span>: number;</span><br><span class="line">|     name: string;</span><br><span class="line"></span><br><span class="line">webpack 5.101.3 compiled with 1 error <span class="keyword">in</span> 56 ms</span><br></pre></td></tr></tbody></table></figure>
<p>可以看到，webpack 无法处理该文件，并贴心提示你：<code>You may need an appropriate loader to handle this file type =&gt; 你或许需要一个合适的loader来处理该文件类型</code></p>
<h3 id="ts-loader"><a class="markdownIt-Anchor" href="#ts-loader"></a> ts-loader</h3>
<p>于是我们来安装 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/TypeStrong/ts-loader">ts-loader</a> 帮 webpack 处理 ts 文件：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ts-loader --save-dev</span><br></pre></td></tr></tbody></table></figure>
<p>有的同学可能会问，我们之前不是用 npm 已经安装了 ts 吗？那直接配置 <code>tsconfig.json</code> 不就好了？</p>
<p>是的，但这不是说两者只需要一个，而是他们完全可以搭配干活，完成更精细的控制。</p>
<p>对于 ts 编译器，它只会做 <strong>语法检查 + 转换成 JS</strong>，不会做打包（不处理 <code>import</code> 的依赖、不打包 CSS / 图片）；而 Webpack 是个打包工具，他本身不懂 TypeScript。有了 <code>ts-loader</code> 后，不用单独跑 <code>tsc</code>，Webpack 在打包时就会自动把 TS 转成 JS。</p>
<p>这就是说，整个工作流程如下：</p>
<p>当我们安装了 ts-loader 之后，并且配置了 tsconfig.json 文件，再执行 <code>npx webpack</code> 时：</p>
<ul>
<li>ts-loader → 发现要处理 <code>.ts</code> 文件</li>
<li>它调用 TypeScript 编译器 → 读取 <code>tsconfig.json</code></li>
<li>按配置（比如转成 ES5）输出 JS → 再交给 Webpack 打包</li>
</ul>
<p>于是，我们编写 webpack.config.js 的 module 如下：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// loader配置</span></span><br><span class="line"><span class="attr">module</span>: {</span><br><span class="line">  <span class="attr">rules</span>: [</span><br><span class="line">    {</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.tsx?$/</span>, <span class="comment">// 匹配文件后缀名为.ts或.tsx的文件</span></span><br><span class="line">      <span class="attr">use</span>: <span class="string">'ts-loader'</span>, <span class="comment">// 当use中有多个loader时，webpack会从右到左依次执行</span></span><br><span class="line">      <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> <span class="comment">// 排除node_modules目录，提升编译速度</span></span><br><span class="line">    }</span><br><span class="line">  ]</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure>
<p>并且在根目录下创建 <code>tsconfig.json</code>：</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"compilerOptions"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"target"</span><span class="punctuation">:</span> <span class="string">"es5"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"module"</span><span class="punctuation">:</span> <span class="string">"ESNext"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"esModuleInterop"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"forceConsistentCasingInFileNames"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"lib"</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">"DOM"</span><span class="punctuation">,</span> <span class="string">"ES2022"</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"include"</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">"src/**/*"</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">// 编译范围，指定编译的文件目录</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
<p>我们来逐项说明：</p>
<ol>
<li>
<p><strong>target</strong>：指定编译之后的 js 语法版本，取决于项目需要兼容多旧的浏览器，比如 <code>es5</code> 最终代码能在老旧的 IE11 上运行，现在一般是 <code>es2016+</code>，支持 async/await 等常用特性。</p>
</li>
<li>
<p><strong>module</strong>：告诉编译器生成的 JS 模块化方案，这里是最新的 ES Modules 语法（<code>import/export</code>）。</p>
<details class="folding-tag"><summary> 详细解释 </summary>
              <div class="content">
              <p>常见取值</p><ol><li>现代 ES 模块</li></ol><ul><li><code>ESNext</code><ul><li>始终使用 TS 支持的最新 ES Module 语法。</li><li>输出 <code>import</code> / <code>export</code>。</li><li>场景：现代打包工具（Webpack、Vite、Rollup）、Node.js 14+（支持 ES Modules）。</li></ul></li><li><code>ES6</code> / <code>ES2015</code><ul><li>与 <code>"ESNext"</code> 类似，但只保证符合 ES2015 版本。</li><li>场景：需要固定在 ES6 标准，不跟随 TS 的更新。</li></ul></li></ul><ol start="2"><li>CommonJS 系列</li></ol><ul><li><code>CommonJS</code><ul><li>输出 <code>require()</code> / <code>module.exports</code>。</li><li>场景：Node.js 里最常见的模块系统；老旧工具链。</li><li>Webpack 默认配置文件就是 CJS。</li></ul></li><li><code>AMD</code><ul><li>输出 AMD 风格模块，依赖 <code>require.js</code>。</li><li>场景：老项目，前端按需加载。</li></ul></li><li><code>UMD</code><ul><li>通用模块定义，兼容 CommonJS + AMD + 全局变量。</li><li>场景：要发布一个库给不同环境使用时。</li></ul></li><li><code>System</code><ul><li>输出 SystemJS 模块。</li><li>场景：用 SystemJS 动态加载模块的老项目。</li></ul></li></ul><ol start="3"><li>Node.js 特定</li></ol><ul><li><code>"Node16"</code> / <code>"NodeNext"</code><ul><li>TypeScript 4.7+ 引入的新选项。</li><li>模拟 Node.js 的真实模块解析方式（支持 <code>package.json</code> 里的 <code>"type": "module"</code>）。</li><li>场景：写 Node.js 服务端项目，特别是用 ESM 时推荐</li></ul></li></ul>
              </div>
            </details>
</li>
<li>
<p><strong>esModuleInterop</strong>：允许用 <code>import</code> 语法导入 CommonJS 模块。<br>
比如 <code>import express from "express";</code>（否则你要写 <code>import * as express from "express";</code>）。</p>
</li>
<li>
<p><strong>forceConsistentCasingInFileNames</strong>：在导入路径时，强制区分大小写，防止在大小写不敏感的文件系统（如 Windows）上编译通过，但在 Linux 上运行失败。</p>
</li>
<li>
<p><strong>lib</strong>：指定编译时要包含的库声明文件，影响类型检查和代码补全。</p>
<ul>
<li><code>"DOM"</code> → 提供 <code>document</code>、<code>window</code> 等类型。</li>
<li><code>"ES2022"</code> → 提供最新 ECMAScript 2022 的内置对象类型（比如 <code>Object.hasOwn</code>）</li>
</ul>
</li>
</ol>
<p>这里的 lib 中我写 <code>ES2022</code> 主要是为了给后面的高版本语法转换预留的。</p>
<p>现在写好了配置文件也配置好了 ts-loader，可以运行试试了：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行命令</span></span><br><span class="line">npx webpack</span><br></pre></td></tr></tbody></table></figure>
<p>不出意外，肯定是编译成功的。但是我们也无法通过实际效果亲眼看到，这是因为我们的 <code>index.html</code> 是引入的 <code>src</code> 的 <code>index.ts</code>，我们需要给它改成 <code>dist</code> 下的 <code>main.js</code>：</p>
<figure class="highlight diff"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class="container"&gt;&lt;/div&gt;</span><br><span class="line"><span class="deletion">- &lt;script src="./src/index.ts"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="addition">+ &lt;script src="./dist/main.js"&gt;&lt;/script&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>此时页面就能正常看到效果了：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509200217413.png" alt="image-20250920021730265"></p>
<h2 id="js兼容性问题"><a class="markdownIt-Anchor" href="#js兼容性问题"></a> js 兼容性问题</h2>
<p>但是，这就完了吗？其实，上述操作编译过后的 js 文件是有可能存在一定的兼容性问题的。</p>
<p>对于老旧浏览器，例如 IE11：TypeScript 只会降级 TS 语法（比如 <code>interface</code> → 删除，<code>class</code> → 函数），但不会 polyfill 新的 JS 特性。比如：<code>Promise</code>、<code>Array.includes</code> 还需要 Babel + core-js 来处理。</p>
<h2 id="babel"><a class="markdownIt-Anchor" href="#babel"></a> Babel</h2>
<p>Babel 是一个 JavaScript 编译器。对于 webpack 来说，babel 是它的一个 loader。</p>
<h3 id="核心功能"><a class="markdownIt-Anchor" href="#核心功能"></a> 核心功能</h3>
<ol>
<li><strong>语法转换</strong>
<ul>
<li><code>let/const</code> → <code>var</code></li>
<li>箭头函数 → 普通函数</li>
<li><code>class</code> → 构造函数 + 原型</li>
</ul>
</li>
<li><strong> Polyfill（垫片）</strong>
<ul>
<li>新 API（<code>Promise</code>、<code>Array.includes</code>、<code>Object.assign</code> 等）自动引入 <code>core-js</code> 来兼容老环境。</li>
</ul>
</li>
<li><strong>插件和预设</strong>
<ul>
<li>插件（plugins）：处理具体语法，比如 <code>@babel/plugin-transform-arrow-functions</code>。</li>
<li>预设（presets）：插件集合，比如 <code>@babel/preset-env</code>、<code>@babel/preset-react</code>、<code>@babel/preset-typescript</code>。</li>
</ul>
</li>
</ol>
<h3 id="常见应用场景"><a class="markdownIt-Anchor" href="#常见应用场景"></a> 常见应用场景</h3>
<ul>
<li><strong>前端</strong>：保证新语法在旧浏览器可运行。</li>
<li><strong>React/Vue 项目</strong>：转换 JSX / TS。</li>
<li><strong>Node 项目</strong>：用最新语法但运行在老版本 Node。</li>
<li><strong>库开发</strong>：发布前打包成多种模块格式（ESM / CJS）。</li>
</ul>
<h3 id="应用babel"><a class="markdownIt-Anchor" href="#应用babel"></a> 应用 Babel</h3>
<p>我们首先来<strong>重写</strong>一下 <code>src/index.ts</code> 方便展示转换效果：</p>
<figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Task</span> = {</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">done</span>: <span class="built_in">boolean</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模拟异步请求</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fetchTasks</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">Task</span>[]&gt; {</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> {</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> {</span><br><span class="line">            <span class="title function_">resolve</span>([</span><br><span class="line">                { <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">"Learn TypeScript"</span>, <span class="attr">done</span>: <span class="literal">true</span> },</span><br><span class="line">                { <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">"Play with Webpack"</span>, <span class="attr">done</span>: <span class="literal">false</span> },</span><br><span class="line">            ]);</span><br><span class="line">        }, <span class="number">500</span>);</span><br><span class="line">    });</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 ES6+ 的 includes</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">tags</span>: <span class="built_in">string</span>[] = [<span class="string">"ts"</span>, <span class="string">"webpack"</span>, <span class="string">"babel"</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">"是否包含 babel? -&gt;"</span>, tags.<span class="title function_">includes</span>(<span class="string">"babel"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// DOM 操作</span></span><br><span class="line"><span class="title function_">fetchTasks</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">tasks</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> list = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">"ul"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> t <span class="keyword">of</span> tasks) {</span><br><span class="line">        <span class="keyword">const</span> item = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">"li"</span>);</span><br><span class="line">        item.<span class="property">textContent</span> = <span class="string">`<span class="subst">${t.name}</span> - <span class="subst">${t.done ? <span class="string">"yes"</span> : <span class="string">"no"</span>}</span>`</span>;</span><br><span class="line">        list.<span class="title function_">appendChild</span>(item);</span><br><span class="line">    }</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">".container"</span>).<span class="title function_">appendChild</span>(list);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>接着我们<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/loaders/babel-loader/">安装 Babel</a>：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D babel-loader @babel/core @babel/preset-env</span><br></pre></td></tr></tbody></table></figure>
<p>安装完成之后，在 <code>webpack.config.js</code> 中进行配置：</p>
<figure class="highlight diff"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// loader配置</span><br><span class="line">module: {</span><br><span class="line">  rules: [</span><br><span class="line">    {</span><br><span class="line">      test: /\.tsx?$/, // 匹配文件后缀名为.ts或.tsx的文件</span><br><span class="line"><span class="deletion">-     use: 'ts-loader', // 使用ts-loader进行编译，当use中有多个loader时，webpack会从右到左依次执行</span></span><br><span class="line"><span class="addition">+     use: [</span></span><br><span class="line"><span class="addition">+       {</span></span><br><span class="line"><span class="addition">+         loader: "babel-loader",</span></span><br><span class="line"><span class="addition">+       },</span></span><br><span class="line"><span class="addition">+       {</span></span><br><span class="line"><span class="addition">+         loader: "ts-loader", // 使用ts-loader进行编译</span></span><br><span class="line"><span class="addition">+         options: {</span></span><br><span class="line"><span class="addition">+           transpileOnly: true // 跳过类型检查，提升编译速度</span></span><br><span class="line"><span class="addition">+         }</span></span><br><span class="line"><span class="addition">+       }</span></span><br><span class="line"><span class="addition">+     ], // 使用ts-loader进行编译，当use数组中有多个loader时，webpack会从右到左依次执行</span></span><br><span class="line">      exclude: /node_modules/ // 排除node_modules目录，提升编译速度</span><br><span class="line">    }</span><br><span class="line">  ]</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure>
<div class="note no-icon info flat"><p>因为 babel 处理的是 js，所以它需要<strong>运行在 ts-loader 之后</strong>，等待 ts 被转换为 js。</p>
</div>
<p>这里的 babel 需要我们提供一个配置文件（也可以直接写在 webpack.config.js 中）：<code>babel.config.js</code>：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">presets</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">"@babel/preset-env"</span>, <span class="comment">// 使用预设</span></span><br><span class="line">      {</span><br><span class="line">        <span class="attr">targets</span>: <span class="string">"&gt; 0.25%, not dead, ie 11"</span>,</span><br><span class="line">        <span class="attr">useBuiltIns</span>: <span class="string">"usage"</span>,</span><br><span class="line">        <span class="attr">corejs</span>: <span class="number">3</span>,</span><br><span class="line">      }, <span class="comment">// 这里是options而不是预设名</span></span><br><span class="line">    ],</span><br><span class="line">  ],</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>这里的 presets 如果存在多个预设，处理顺序也是从右到左。解释如下：</p>
<p>1、<code>@babel/preset-env</code></p>
<p>Babel 的核心预设，用来 <strong>根据目标环境决定要转换哪些语法和 API</strong>。</p>
<p>它包含了大量插件，例如：</p>
<ul>
<li>箭头函数转换插件</li>
<li>模板字符串转换插件</li>
<li> ES6+ 新方法 polyfill 插件</li>
</ul>
<p>2、<code>targets</code></p>
<p>指定代码需要兼容哪些环境 / 浏览器。</p>
<ul>
<li><code>&gt; 0.25%</code> ： 使用率大于 0.25% 的浏览器</li>
<li><code>not dead</code> ：不包含停止更新的浏览器</li>
<li><code>ie 11</code> ：强制兼容 IE11</li>
</ul>
<p>3、<code>useBuiltIns: "usage"</code></p>
<p>告诉 Babel <strong>按需注入 polyfill</strong>，而不是全量引入。例如 <code>const arr = [1,2].includes(2)</code>，Babel 会检测到你用到了 <code>Array.prototype.includes</code>，自动引入对应 polyfill，而不是把所有 ES6/ES2015 API 都打包进去。</p>
<p>4、<code>corejs: 3</code></p>
<ul>
<li>指定 polyfill 的版本</li>
<li> Babel 会用 <code>core-js@3</code> 提供缺失的 API</li>
</ul>
<h3 id="为什么ts-loader需要跳过类型检查"><a class="markdownIt-Anchor" href="#为什么ts-loader需要跳过类型检查"></a> 为什么 ts-loader 需要跳过类型检查</h3>
<p>这里为什么 ts-loader 需要跳过类型检查（<code>transpileOnly: true</code>）呢？</p>
<p>这是因为编译过程中 <strong>包含类型检查</strong>，构建速度较慢（因为 Webpack 编译时要等类型检查完成）。如果项目较小，是可以的；如果项目是中大型项目，完全可以新开独立进程交给 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/TypeStrong/fork-ts-checker-webpack-plugin">fork-ts-checker-webpack-plugin</a> 完成。</p>
<h2 id="fork-ts-checker-webpack-plugin"><a class="markdownIt-Anchor" href="#fork-ts-checker-webpack-plugin"></a> fork-ts-checker-webpack-plugin</h2>
<p><code>ts-loader（transpileOnly: true）</code> + <code>fork-ts-checker-webpack-plugin</code> + <code>babel-loader</code> 的工作流程：</p>
<ul>
<li>ts-loader：<strong>仅转译</strong> TS 到 JS（跳过类型检查）</li>
<li>babel-loader：做语法转换（比如转成 ES5，polyfill 等）</li>
<li>fork-ts-checker-webpack-plugin：在单独的进程里做 <strong>类型检查</strong></li>
</ul>
<p>需要注意的是，<strong>fork-ts-checker-webpack-plugin</strong> 对 <strong>Node</strong>、<strong>Webpack</strong>、<strong>TS</strong> 三个东西的版本都有要求（更多要求详见其 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/TypeStrong/fork-ts-checker-webpack-plugin">README</a> 文档）：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This plugin requires Node.js &gt;=14.0.0+, Webpack ^5.11.0, TypeScript ^3.6.0</span><br></pre></td></tr></tbody></table></figure>
<p>目前我们的项目中，可以在 <code>package.json</code> 中找到 webpack 和 TS：</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">"devDependencies"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"@babel/core"</span><span class="punctuation">:</span> <span class="string">"^7.28.4"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"@babel/preset-env"</span><span class="punctuation">:</span> <span class="string">"^7.28.3"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"babel-loader"</span><span class="punctuation">:</span> <span class="string">"^10.0.0"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"ts-loader"</span><span class="punctuation">:</span> <span class="string">"^9.5.4"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"typescript"</span><span class="punctuation">:</span> <span class="string">"^5.9.2"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"webpack"</span><span class="punctuation">:</span> <span class="string">"^5.101.3"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"webpack-cli"</span><span class="punctuation">:</span> <span class="string">"^6.0.1"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
<p>它们都是高于要求的，所以可以使用 fork-ts-checker-webpack-plugin：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev fork-ts-checker-webpack-plugin</span><br></pre></td></tr></tbody></table></figure>
<p>配置 <code>webpack.config.js</code> 如下：</p>
<figure class="highlight diff"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">+ // 引入插件</span></span><br><span class="line"><span class="addition">+ const ForkTsCheckerWebpackPlugin = require('fork-ts-checker-webpack-plugin');</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">- plugins: [],</span></span><br><span class="line"><span class="addition">+ plugins: [new ForkTsCheckerWebpackPlugin()],</span></span><br></pre></td></tr></tbody></table></figure>
<p>此时再进行编译：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx webpack</span><br></pre></td></tr></tbody></table></figure>
<p>这将报错。这是因为我们没有安装 <code>core.js</code> 无法进行 polyfill。这也是 webpack 文档的一个小问题了，有时候不会指明全部需要的依赖项。</p>
<p>执行安装命令，<strong>安装 core.js 到生产环境</strong>：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install core-js</span><br></pre></td></tr></tbody></table></figure>
<p>为什么是生产依赖呢？前面说过，安装到生产还是开发环境，主要看它需不需要被运行。这里我们为了追求编译打包后的代码体积小，所以采用的是按需使用 polyfill（<code>useBuiltIns: "usage"</code> 而不是 <code>useBuiltIns: "entry"</code>），Babel 会在编译过后的代码文件中依然引用 core.js</p>
<p>如果是全量引入，那就要在入口文件中手动引入：</p>
<figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在入口文件手动引入</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"core-js/stable"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"regenerator-runtime/runtime"</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>全量引入情况下 Babel 不再插入单独模块，而是依赖入口文件的全量导入，也就可以不在生产环境使用 core.js 了。</p>
<p>此时再次执行编译命令 <code>npx webpack</code> 就可以到 <code>dist/index.js</code> 查找 <code>index.ts</code> 是否在转换后使用 polyfill 了：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***/</span> <span class="string">"./src/index.ts"</span>:</span><br><span class="line"><span class="comment">/*!**********************!*\</span></span><br><span class="line"><span class="comment">  !*** ./src/index.ts ***!</span></span><br><span class="line"><span class="comment">  \**********************/</span></span><br><span class="line"><span class="comment">/***/</span> (<span class="function">(<span class="params">__unused_webpack_module, __webpack_exports__, __webpack_require__</span>) =&gt;</span> {</span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">"{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.concat.js */ \"./node_modules/core-js/modules/es.array.concat.js\");\n/* harmony import */ var core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.array.includes.js */ \"./node_modules/core-js/modules/es.array.includes.js\");\n/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.function.name.js */ \"./node_modules/core-js/modules/es.function.name.js\");\n/* harmony import */ var core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"./node_modules/core-js/modules/es.object.to-string.js\");\n/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! core-js/modules/es.promise.js */ \"./node_modules/core-js/modules/es.promise.js\");\n/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\n// 模拟异步请求\nfunction fetchTasks() {\n  return new Promise(function (resolve) {\n    setTimeout(function () {\n      resolve([{\n        id: 1,\n        name: \"Learn TypeScript\",\n        done: true\n      }, {\n        id: 2,\n        name: \"Play with Webpack\",\n        done: false\n      }]);\n    }, 500);\n  });\n}\n// 使用 ES6+ 的 includes\nvar tags = [\"ts\", \"webpack\", \"babel\"];\nconsole.log(\"是否包含 babel? -&gt;\", tags.includes(\"babel\"));\n// DOM 操作\nfetchTasks().then(function (tasks) {\n  var list = document.createElement(\"ul\");\n  for (var _i = 0, tasks_1 = tasks; _i &lt; tasks_1.length; _i++) {\n    var t = tasks_1[_i];\n    var item = document.createElement(\"li\");\n    item.textContent = \"\".concat(t.name, \" - \").concat(t.done ? \"yes\" : \"no\");\n    list.appendChild(item);\n  }\n  document.body.appendChild(list);\n});\n\n//# sourceURL=webpack://webpack-code/./src/index.ts?\n}"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/***/</span> })</span><br></pre></td></tr></tbody></table></figure>
<p>能看到 core.js 相关的导入语句：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* harmony import */</span> <span class="keyword">var</span> core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_0__ = <span class="title function_">__webpack_require__</span>(<span class="comment">/*! core-js/modules/es.array.concat.js */</span> <span class="string">"./node_modules/core-js/modules/es.array.concat.js"</span>);</span><br><span class="line"><span class="comment">/* harmony import */</span> <span class="keyword">var</span> core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__ = <span class="title function_">__webpack_require__</span>(<span class="comment">/*! core-js/modules/es.array.includes.js */</span> <span class="string">"./node_modules/core-js/modules/es.array.includes.js"</span>);</span><br><span class="line"><span class="comment">/* harmony import */</span> <span class="keyword">var</span> core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_2__ = <span class="title function_">__webpack_require__</span>(<span class="comment">/*! core-js/modules/es.function.name.js */</span> <span class="string">"./node_modules/core-js/modules/es.function.name.js"</span>);</span><br><span class="line"><span class="comment">/* harmony import */</span> <span class="keyword">var</span> core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_3__ = <span class="title function_">__webpack_require__</span>(<span class="comment">/*! core-js/modules/es.object.to-string.js */</span> <span class="string">"./node_modules/core-js/modules/es.object.to-string.js"</span>);</span><br><span class="line"><span class="comment">/* harmony import */</span> <span class="keyword">var</span> core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_4__ = <span class="title function_">__webpack_require__</span>(<span class="comment">/*! core-js/modules/es.promise.js */</span> <span class="string">"./node_modules/core-js/modules/es.promise.js"</span>);</span><br></pre></td></tr></tbody></table></figure>
<p>可以说明 polyfill 已经发生了。</p>
<h2 id="处理css"><a class="markdownIt-Anchor" href="#处理css"></a> 处理 CSS</h2>
<p>前面提到，webpack 本身不能处理除了 JS 和 json 以外的资源，所以 css 也要借助 loader 来处理，即 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/loaders/css-loader/#getting-started">css-loader</a>：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev css-loader style-loader</span><br></pre></td></tr></tbody></table></figure>
<div class="note no-icon warning flat"><p>注意，文档中可能没有提到安装 <code>style-loader</code>，自己在安装时需要一起安装。</p>
</div>
<p>接着我们在 <code>src/css</code> 中创建 <code>index.css</code>：</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> {</span><br><span class="line">    <span class="attribute">background-color</span>: rebeccapurple;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>然后在入口文件 <code>index.ts</code> 中进行引用：</p>
<figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"./css/index.css"</span></span><br></pre></td></tr></tbody></table></figure>
<p>最后，在 webpack 配置文件中配置 css-loader：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">module</span>: {</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      {</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">        <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>],</span><br><span class="line">      },</span><br><span class="line">    ],</span><br><span class="line">  },</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>此时就可以编译试试了。</p>
<h2 id="处理sass"><a class="markdownIt-Anchor" href="#处理sass"></a> 处理 sass</h2>
<p>对于 sass、less 和 stylus，如果你会了其中一种，那么其他的大差不差，本文在此介绍 sass 的处理方法。</p>
<p>安装 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/loaders/sass-loader/">sass-loader</a>：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i sass sass-loader --save-dev</span><br></pre></td></tr></tbody></table></figure>
<p>配置 webpack：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">module</span>: {</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      {</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.s[ac]ss$/i</span>,</span><br><span class="line">        <span class="attr">use</span>: [</span><br><span class="line">          <span class="comment">// 将 JS 字符串生成为 style 节点</span></span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          <span class="comment">// 将 CSS 转化成 CommonJS 模块</span></span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          <span class="comment">// 将 Sass 编译成 CSS</span></span><br><span class="line">          <span class="string">'sass-loader'</span>,</span><br><span class="line">        ],</span><br><span class="line">      },</span><br><span class="line">    ],</span><br><span class="line">  },</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>那么，我们在 css 目录下删除 index.css（别忘记移除入口文件中对它的引入），然后创建一个 <code>index.sass</code> 和 <code>index.scss</code> 文件来检验：</p>
<p><code>index.sass</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.container ul li:first-child</span><br><span class="line">  background: blue</span><br><span class="line">  color: #ff8a6a</span><br></pre></td></tr></tbody></table></figure>
<p><code>index.scss</code></p>
<figure class="highlight scss"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:not</span>(:first-child) {</span><br><span class="line">  <span class="attribute">background</span>: lightpink;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>当然，这两个文件也需要到入口文件 <code>index.ts</code> 中进行引入。之后执行编译命令之后应该就能看到效果了。</p>
<h2 id="处理图片资源"><a class="markdownIt-Anchor" href="#处理图片资源"></a> 处理图片资源</h2>
<p>在 webpack4 时，处理图片资源通过的是 <code>file-loader</code>（将资源原封不动地输出）和 <code>url-loader</code>（将图片转换为 Base64 格式，可指定大小阈值）。现在 webpack5 已经将这两个 loader 功能内置了，我们只需要简单配置一下即可。</p>
<p>要处理图片，首先要有图片资源，我将下面这张《浪客剑心：追忆篇》的海报和《风骚律师》的海报放入到 <code>src/img</code> 中（如果你没有图片资源，可以下载下面这两张图片测试）：</p>
<img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509200418857.webp" alt="final" style="zoom:50%;">
<img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509200421239.webp" alt="风骚律师" style="zoom:50%;">
<p>按照文档进行配置 webpack（可以通过搜索 asset 找到，文档详见<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/guides/asset-modules/#inlining-assets">资源模块</a>）：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">module</span>: {</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      {</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg|webp)$/i</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">'asset'</span>, <span class="comment">// 打包成静态资源</span></span><br><span class="line">        <span class="attr">parser</span>: {</span><br><span class="line">          <span class="attr">dataUrlCondition</span>: {</span><br><span class="line">            <span class="attr">maxSize</span>: <span class="number">40</span> * <span class="number">1024</span> <span class="comment">// 图片大小小于40kb的会被转为base64格式</span></span><br><span class="line">          }</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    ]</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>配置好了，但是我们还没指定图片放在哪，于是在 index.ts 中给页面增加两个 div 用来放图：</p>
<figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> img1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">"div"</span>)</span><br><span class="line">img1.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">"img1"</span>)</span><br><span class="line"><span class="keyword">const</span> img2 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">"div"</span>)</span><br><span class="line">img2.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">"img2"</span>)</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">".container"</span>).<span class="title function_">appendChild</span>(img1)</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">".container"</span>).<span class="title function_">appendChild</span>(img2)</span><br></pre></td></tr></tbody></table></figure>
<p>接着在 <code>index.sass</code> 和 <code>index.scss</code> 中写样式：</p>
<p><code>index.sass</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.container</span><br><span class="line">  display: flex</span><br><span class="line">  flex-direction: column</span><br><span class="line">  .img1</span><br><span class="line">    height: 320px</span><br><span class="line">    background-size: contain !important</span><br><span class="line">    background: url("../img/追忆.webp") no-repeat</span><br><span class="line">  ul li:first-child</span><br><span class="line">    background: blue</span><br><span class="line">    color: #ff8a6a</span><br></pre></td></tr></tbody></table></figure>
<p><code>index.scss</code></p>
<figure class="highlight scss"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> {</span><br><span class="line">  <span class="selector-class">.img2</span> {</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">320px</span>;</span><br><span class="line">    <span class="attribute">background-size</span>: contain <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"../img/风骚律师.webp"</span>) no-repeat;</span><br><span class="line">  }</span><br><span class="line">  <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:not</span>(:first-child) {</span><br><span class="line">    <span class="attribute">background</span>: lightpink;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>执行编译命令之后，可以看到<code>追忆.webp</code> 被输出为原数据格式，而<code>风骚律师.webp</code> 则被输出为 Base64 格式。</p>
<h2 id="分类输出资源"><a class="markdownIt-Anchor" href="#分类输出资源"></a> 分类输出资源</h2>
<p>观察打包目录 dist：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509200452507.png" alt="image-20250920045248407"></p>
<p>可以看到输出结果是没有分类的，我们最好对各类资源进行分类，这样方便管理。修改 webpack 配置文件：</p>
<figure class="highlight diff"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">module.exports = {</span><br><span class="line">    output: {</span><br><span class="line"><span class="deletion">-       filename: 'main.js', // 输出文件名</span></span><br><span class="line"><span class="addition">+				filename: 'static/js/main.js', // 输出文件名</span></span><br><span class="line">        path: path.resolve(__dirname, 'dist'), // __dirname是node.js的全局变量，代表当前执行脚本所在的目录</span><br><span class="line">        clean: true // 每次打包前清空dist目录</span><br><span class="line">      },</span><br><span class="line">    // loader配置</span><br><span class="line">    module: {</span><br><span class="line">      rules: [</span><br><span class="line">        {</span><br><span class="line">          test: /\.css$/, // 匹配文件后缀名为.css的文件</span><br><span class="line">          use: ['style-loader', 'css-loader'],</span><br><span class="line"><span class="addition">+          generator: {</span></span><br><span class="line"><span class="addition">+            filename: 'static/css/[name].[contenthash:8].css' // 输出文件名</span></span><br><span class="line"><span class="addition">+          }</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">          test: /\.s[ac]ss$/i, // 匹配文件后缀名为.scss或.sass的文件</span><br><span class="line">          use: ['style-loader', 'css-loader','sass-loader'],</span><br><span class="line"><span class="addition">+          generator: {</span></span><br><span class="line"><span class="addition">+            filename: 'static/css/[name].[contenthash:8].css' // 输出文件名</span></span><br><span class="line"><span class="addition">+          }</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">          test: /\.(png|jpe?g|gif|svg|webp)$/i, // 匹配文件后缀名为.png、.jpg、.jpeg、.gif、.svg的文件</span><br><span class="line">          type: 'asset', // 打包成静态资源</span><br><span class="line">          parser: {</span><br><span class="line">            dataUrlCondition: {</span><br><span class="line">              maxSize: 40 * 1024 // 图片大小小于40kb的会被转为base64格式</span><br><span class="line">            }</span><br><span class="line">          },</span><br><span class="line"><span class="addition">+          generator: {</span></span><br><span class="line"><span class="addition">+            filename: 'static/img/[name].[contenthash:8][ext]' // 输出文件名</span></span><br><span class="line"><span class="addition">+          }</span></span><br><span class="line">        }</span><br><span class="line">      ]</span><br><span class="line">    },</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><code>[name].[contenthash:8][ext]</code> 中：</p>
<ul>
<li>[name]：使用文件原名</li>
<li> [contenthash:8]：使用文件指纹，取生成的 hash 值的前 8 位</li>
<li> [ext]：使用原扩展名</li>
</ul>
<details class="folding-tag"><summary> contenthash 和 hash </summary>
              <div class="content">
              <p>需要说明的是，<strong>contenthash</strong> 和 <strong>hash</strong> 是两个不同的占位符：</p><ol><li><code>[hash]</code></li></ol><ul><li>整个 <strong>项目构建的 hash 值</strong>（一次构建一个值）</li><li>缺点：只要有一个文件改动，所有文件的 <code>[hash]</code> 都会变 （<strong>缓存不友好</strong>）</li></ul><hr><ol start="2"><li><code>[chunkhash]</code></li></ol><ul><li>根据 <strong>chunk 内容</strong> 生成的 hash</li><li> 不同 entry 的 chunk 值不同</li><li>优点：只改动某个入口文件时，其他 chunk 的文件名不变（更适合持久缓存）</li></ul><hr><ol start="3"><li><code>[contenthash]</code></li></ol><ul><li>根据 <strong>文件内容</strong> 生成 hash</li><li> 最精细化的方式：只有内容变化时，才会生成新的 hash</li><li> 适合生产环境：比如 CSS 抽离文件（<code>MiniCssExtractPlugin</code>）常用 <code>[contenthash]</code></li></ul>
              </div>
            </details>
<h2 id="处理字体图标资源"><a class="markdownIt-Anchor" href="#处理字体图标资源"></a> 处理字体图标资源</h2>
<p>要处理字体图标资源，首先得要有这些资源。推荐从阿里巴巴矢量图标库中下载这些资源：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.iconfont.cn/">https://www.iconfont.cn/</a></p>
<p>随便点开一个图标库，将一些图标加入到项目（需要登录）：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509201952630.png" alt="image-20250920195241433"></p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509201953291.png" alt="image-20250920195337094"></p>
<p>如果此前没有项目就需要创建项目，如果已经有项目直接选择一个项目加入到项目即可。加入之后将会跳转到项目详情页，我们将这些图标资源下载到本地（仅作演示，以后图标资源也可能是通过服务器得到的）：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509201955752.png" alt="image-20250920195551617"></p>
<p>下载到本地的图标资源是一个压缩包的形式，我们将其剪切到 <code>src/font</code> 目录下，并将其解压：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509201958624.png" alt="image-20250920195834494"></p>
<p>解压后的目录如下：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509201958543.png" alt="image-20250920195853412"></p>
<p>这之中的 <code>demo_index.html</code> 也可以指导你如何使用图标资源：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202000254.png" alt="image-20250920200019039"></p>
<p>这三种方式主要是兼容性的区别：</p>
<ul>
<li>Unicode 在 IE6 以上可以使用</li>
<li> Font class 在 IE8 以上可以用</li>
<li> Symbol 在 IE9 以上可以用</li>
</ul>
<p>我们一般使用 Font class 的方式进行使用：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202002265.png" alt="image-20250920200226113"></p>
<p>依照指导文档，我们将 <code>iconfont.css</code> 剪切到 <code>src/css</code> 目录中。</p>
<p>需要注意的是，iconfont.css 中引入的路径需要进行修改：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202005167.png" alt="image-20250920200520028"></p>
<p>我们将字体文件从 font 的深层目录移动出来，剪切到 <code>src/font</code> 目录下：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202007796.png" alt="image-20250920200720663"></p>
<p>然后将 <code>iconfont.css</code> 中的路径修改如下：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202011989.png" alt="image-20250920201139842"></p>
<p>别忘了，我们还得导入才能被 webpack 打包。在 <code>index.ts</code> 中引入 <code>iconfont.css</code>：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202013542.png" alt="image-20250920201333398"></p>
<p>此时就可以执行打包命令看看效果了：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202015856.png" alt="image-20250920201528709"></p>
<p>不过默认打包的结构肯定不是我们期望的，我们可以像配置图片资源一样配置它们（webpack.config.js）：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.(ttf|woff2?)$/i</span>,</span><br><span class="line">  <span class="attr">type</span>: <span class="string">'asset/resource'</span>, <span class="comment">// 原味输出静态资源</span></span><br><span class="line">  <span class="attr">generator</span>: {</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">'static/media/[contenthash:8][ext]'</span> <span class="comment">// 输出文件名</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><code>asset/resource</code> 表示将资源原封不动的输出，这里为了输出字体文件名短点，所以 filename 不保留原名了。</p>
<p>为了在页面中能显示这三个图标，我们还需要按照 <code>demo_index.html</code> 的指导加入 span 标签（index.html）：</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"iconfont icon-a-028-medicalapp"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"iconfont icon-a-004-bones"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"iconfont icon-webpack"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--别忘记更新main.js的路径--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./dist/static/js/main.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>icon 名和图标名一致：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202029893.png" alt="image-20250920202957685"></p>
<p>这样执行打包命令就可以在 <code>index.html</code> 看到效果了。</p>
<h2 id="处理其他资源"><a class="markdownIt-Anchor" href="#处理其他资源"></a> 处理其他资源</h2>
<p>其实上述资源已经是我们经常会使用到的资源了，处理其他资源，如视频资源等，我们也只需要原封不动将其输出就可以了，所以就扩大一下 <code>test</code> 的匹配范围就行：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.(ttf|woff2?|mp4|avi|mkv)$/i</span>, <span class="comment">// 扩大匹配范围</span></span><br><span class="line">  <span class="attr">type</span>: <span class="string">'asset/resource'</span>, <span class="comment">// 原味输出静态资源</span></span><br><span class="line">  <span class="attr">generator</span>: {</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">'static/media/[contenthash:8][ext][query]'</span> <span class="comment">// 输出文件名</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="处理html资源"><a class="markdownIt-Anchor" href="#处理html资源"></a> 处理 Html 资源</h2>
<p>安装 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/plugins/html-webpack-plugin/#root">html-webpack-plugin</a></p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i html-webpack-plugin -D</span><br></pre></td></tr></tbody></table></figure>
<p>接着在 webpack 配置文件中进行引入并配置：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>); <span class="comment">// 引入</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">'index.js'</span>,</span><br><span class="line">  <span class="attr">output</span>: {</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">'index_bundle.js'</span>,</span><br><span class="line">  },</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>()], <span class="comment">// 启用插件</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>并且在 <code>index.html</code> 中取消手动引入编译后的 <code>main.js</code>：</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"iconfont icon-a-028-medicalapp"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"iconfont icon-a-004-bones"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"iconfont icon-webpack"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--不再需要手动引入--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;script src="./dist/static/js/main.js"&gt;&lt;/script&gt;--&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>此时执行打包命令，你会发现打包输出的 <code>dist/index.html</code> 中：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202056182.png" alt="image-20250920205559943"></p>
<p>所以我们还需要给这个 html 插件配置 <code>template</code> 字段：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插件配置</span></span><br><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>({</span><br><span class="line">    <span class="comment">// template参数指定生成的html以哪个文件为参考生成结构</span></span><br><span class="line">    <span class="attr">template</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">'./index.html'</span>)</span><br><span class="line">  }),</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">ForkTsCheckerWebpackPlugin</span>(),</span><br><span class="line">],</span><br></pre></td></tr></tbody></table></figure>
<p>template 参数指定生成的 html 以哪个文件为参考<strong>生成一致的元素结构</strong></p>
<h2 id="搭建开发服务器"><a class="markdownIt-Anchor" href="#搭建开发服务器"></a> 搭建开发服务器</h2>
<p>每次写完代码都需要手动执行打包命令才能同步代码，太麻烦了，我们安装 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/api/webpack-dev-server/">webpack-dev-server</a> 来自动化执行：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev webpack-dev-server</span><br></pre></td></tr></tbody></table></figure>
<p>然后在 webpack 的配置文件中进行配置：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插件配置</span></span><br><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>({</span><br><span class="line">    <span class="comment">// template参数指定生成的html以哪个文件为参考生成结构</span></span><br><span class="line">    <span class="attr">template</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">'./index.html'</span>)</span><br><span class="line">  }),</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">ForkTsCheckerWebpackPlugin</span>(),</span><br><span class="line">],</span><br><span class="line"><span class="attr">devServer</span>: {</span><br><span class="line">  <span class="attr">host</span>: <span class="string">'localhost'</span>, <span class="comment">// 主机名</span></span><br><span class="line">  <span class="attr">port</span>: <span class="number">3000</span>, <span class="comment">// 端口号</span></span><br><span class="line">  <span class="attr">static</span>: <span class="string">"./dist"</span>, <span class="comment">// 静态文件目录</span></span><br><span class="line">  <span class="attr">open</span>: <span class="literal">true</span>, <span class="comment">// 自动打开浏览器</span></span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure>
<p>此时，打包命令需要执行的是：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx webpack serve</span><br></pre></td></tr></tbody></table></figure>
<p>需要注意的是，如果使用 serve 开发服务器，那么实际是不会输出文件的，编译打包结果存在内存之中。</p>
<h2 id="eslint"><a class="markdownIt-Anchor" href="#eslint"></a> ESLint</h2>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://eslint.org/docs/latest/">ESLint</a>，可组装的 JavaScript 和 JSX 检查工具。主要被用来检测 js 和 jsx 语法，可以配置各种功能。</p>
<h3 id="安装eslint"><a class="markdownIt-Anchor" href="#安装eslint"></a> 安装 ESLint</h3>
<p>在 webpack4 中，ESLint 是一个 loader；而在 webpack5 中，ESLint 是一个插件。</p>
<p>执行命令安装 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/plugins/eslint-webpack-plugin">EslintWebpackPlugin</a> 和 ESLint 到开发环境：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install eslint-webpack-plugin eslint --save-dev</span><br></pre></td></tr></tbody></table></figure>
<p>在 webpack 配置文件中进行引入：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">ESLintPlugin</span> = <span class="built_in">require</span>(<span class="string">'eslint-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ESLintPlugin</span>({</span><br><span class="line">      <span class="comment">// 指定要约束的文件位置</span></span><br><span class="line">      <span class="attr">context</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">'./src'</span>),</span><br><span class="line">      <span class="comment">// 指定要检查的文件后缀名</span></span><br><span class="line">      <span class="attr">extensions</span>: [<span class="string">'ts'</span>, <span class="string">'tsx'</span>, <span class="string">'js'</span>, <span class="string">'jsx'</span>],</span><br><span class="line">      <span class="comment">// 插件没完全兼容eslint &gt;= 8的版本带来的 Flat Config，需要手动指定路径</span></span><br><span class="line">      <span class="attr">eslintPath</span>: <span class="built_in">require</span>.<span class="title function_">resolve</span>(<span class="string">'eslint/use-at-your-own-risk'</span>),</span><br><span class="line">    }),</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="eslint配置"><a class="markdownIt-Anchor" href="#eslint配置"></a> ESLint 配置</h3>
<p>和 webpack、babel 一样，eslint 也是依照配置文件工作。eslint 配置文件有很多种写法：</p>
<ul>
<li><code>.eslintrc.*</code>：<code>.eslintrc</code>、<code>.eslintrc.js</code>、<code>.eslintrc.json</code></li>
<li><code>eslint.config.js</code></li>
<li>写在 <code>package.json</code> 中：<code>eslintConfig</code> 配置项（适合简单项目）</li>
</ul>
<div class="note no-icon info flat"><p>ESLint 会自动查找读取它们，<strong>配置文件只需要存在一个</strong>。</p>
<p>其中，<code>eslint.config.js</code> 写法是 <strong>ESLint 9 推出的新标准</strong>，叫做 <strong>Flat Config</strong>（平面配置），逐步替代 <code>.eslintrc.*</code>。它必须是一个 <strong>JavaScript/ESM 文件</strong>。</p>
<p>如果你的项目用的工具链都比较新（比如 webpack5、Vite、TS 最新版），建议直接用 <code>eslint.config.js</code>；<br>
如果你需要兼容老工具，暂时用 <code>.eslintrc.js</code> 更省心。</p>
</div>
<p>我们这里使用 <code>eslint.config.js</code> 写法。需要注意的是，我们的项目环境默认在 Node 环境，而 Node 环境下，<code>.js</code> 文件默认是 <strong>CommonJS (CJS)</strong> 模块，我们需要将 ESLint 配置文件后缀改为 <code>mjs</code>，Node 就会自动按 <strong>ESM</strong> 方式解析。</p>
<div class="note no-icon info flat"><p>你也可以在 <code>package.json</code> 中声明 <code>type: "module"</code>。<br>
但是，一旦加了 <code>"type": "module"</code>，项目里的所有 <code>.js</code> 文件都变成 <strong>ESM</strong>，会影响 Webpack 等其他配置。<br>
所以，除非项目的相关生态能统一所有配置文件全为一种语法（要么全是 CJS 要么全是 ESM），否则还是只改个别文件的后缀让 Node 自己识别为好。</p>
</div>
<p>于是，我们在根目录下创建 <code>eslint.config.mjs</code>。由于 ESLint 的配置项十分的多，所以我们一般不会自己手写全部规则，而是使用官方推荐的规则，然后在官方的规则下面写一些自定义的规则覆盖冲突规则即可。例如：</p>
<ul>
<li><strong><code>@eslint/js</code></strong>：官方维护的 <strong>JavaScript 推荐规则集</strong>，代替了过去 <code>.eslintrc</code> 里常用的 <code>"eslint:recommended"</code>。</li>
<li><strong><code>typescript-eslint</code></strong>：官方的 TypeScript 插件 + 解析器（集成了 <code>@typescript-eslint/parser</code> 和 <code>@typescript-eslint/eslint-plugin</code>），Flat Config 推荐用法。</li>
<li><strong><code>globals</code></strong>：提供常见的全局变量集合（比如 <code>window</code>, <code>document</code>, <code>process</code> 等），让 ESLint 知道这些名字是合法的，不会误报 <code>no-undef</code>。</li>
</ul>
<p>上面三个基本够用了，执行安装命令：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @eslint/js typescript-eslint globals</span><br></pre></td></tr></tbody></table></figure>
<p>接着我们配置完整的 <code>config.eslint.mjs</code>：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> globals <span class="keyword">from</span> <span class="string">"globals"</span>;</span><br><span class="line"><span class="keyword">import</span> pluginJs <span class="keyword">from</span> <span class="string">"@eslint/js"</span>;</span><br><span class="line"><span class="keyword">import</span> tseslint <span class="keyword">from</span> <span class="string">"typescript-eslint"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** <span class="doctag">@type</span> {<span class="type">import('eslint').Linter.Config[]</span>} */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</span><br><span class="line">  <span class="comment">// 全局基础规则（JS和TS 推荐规则）</span></span><br><span class="line">  pluginJs.<span class="property">configs</span>.<span class="property">recommended</span>,</span><br><span class="line">  ...tseslint.<span class="property">configs</span>.<span class="property">recommended</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// src 下的前端代码（浏览器环境）</span></span><br><span class="line">  {</span><br><span class="line">    <span class="attr">files</span>: [<span class="string">"src/**/*.{js,mjs,cjs,ts,tsx}"</span>],</span><br><span class="line">    <span class="attr">languageOptions</span>: {</span><br><span class="line">      <span class="attr">globals</span>: globals.<span class="property">browser</span>,</span><br><span class="line">    },</span><br><span class="line">  },</span><br><span class="line"></span><br><span class="line">  <span class="comment">// config 下的 webpack 配置（Node 环境，允许 require）</span></span><br><span class="line">  {</span><br><span class="line">    <span class="attr">files</span>: [<span class="string">"config/**/*.js"</span>],</span><br><span class="line">    <span class="attr">languageOptions</span>: {</span><br><span class="line">      <span class="attr">globals</span>: globals.<span class="property">node</span>,</span><br><span class="line">    },</span><br><span class="line">    <span class="attr">rules</span>: {</span><br><span class="line">      <span class="string">"@typescript-eslint/no-require-imports"</span>: <span class="string">"off"</span>, <span class="comment">// 允许 require</span></span><br><span class="line">    },</span><br><span class="line">  },</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 忽略不需要检查的文件</span></span><br><span class="line">  {</span><br><span class="line">    <span class="attr">ignores</span>: [</span><br><span class="line">      <span class="string">"**/*.d.ts"</span>,</span><br><span class="line">      <span class="string">"**/node_modules/**"</span>,</span><br><span class="line">      <span class="string">"src/font"</span>,</span><br><span class="line">      <span class="string">"**/dist/**"</span>,</span><br><span class="line">      <span class="string">"**/*.config.*"</span>,</span><br><span class="line">    ],</span><br><span class="line">  },</span><br><span class="line">];</span><br></pre></td></tr></tbody></table></figure>
<div class="note no-icon info flat"><p>如果是旧的 ESLint 配置，应当是：<code>.eslintrc.js</code>+<code>.eslintignore</code><br>
其中 <code>eslintrc</code> 中的 <code>rc</code> 指的是 <code>run commands</code> 或者 <code>runtime configuration</code>，前者是历史渊源，后者是通俗解释</p>
</div>
<h2 id="生产模式"><a class="markdownIt-Anchor" href="#生产模式"></a> 生产模式</h2>
<p>在生产模式下，我们主要关注：代码运行速度、代码打包速度。</p>
<p>在根目录下创建 <code>config</code> 目录，将根目录下的 <code>webpack.config.js</code> 移动到 <code>config</code> 目录下，重命名为 <code>webpack.dev.js</code>，并复制一份重命名为 <code>webpack.prod.js</code>。</p>
<h3 id="dev环境"><a class="markdownIt-Anchor" href="#dev环境"></a> dev 环境</h3>
<p>我们对 <code>webapck.dev.js</code> 进行修改：</p>
<figure class="highlight diff"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">const path = require('path'); // 引入node.js的path模块</span><br><span class="line">const ForkTsCheckerWebpackPlugin = require('fork-ts-checker-webpack-plugin');</span><br><span class="line">const HtmlWebpackPlugin = require('html-webpack-plugin');</span><br><span class="line">const ESLintPlugin = require('eslint-webpack-plugin');</span><br><span class="line"></span><br><span class="line">module.exports = {</span><br><span class="line">  entry: './src/index.ts', // 入口文件，webpack从入口文件开始解析依赖关系</span><br><span class="line">  output: {</span><br><span class="line">    filename: 'static/js/main.js', // 输出文件名</span><br><span class="line"><span class="deletion">-     path: path.resolve(__dirname, 'dist'), // __dirname是node.js的全局变量，代表当前执行脚本所在的目录</span></span><br><span class="line"><span class="addition">+			path: undefined, // 开发模式无输出</span></span><br><span class="line"><span class="deletion">-     clean: true // 每次打包前清空dist目录</span></span><br><span class="line">  },</span><br><span class="line">  // loader配置</span><br><span class="line">  module: {</span><br><span class="line">    rules: [</span><br><span class="line">    	// ......</span><br><span class="line">    ]</span><br><span class="line">  // 插件配置</span><br><span class="line">  plugins: [</span><br><span class="line">    new ESLintPlugin({</span><br><span class="line">      // 指定要约束的文件位置</span><br><span class="line"><span class="deletion">-       context: path.resolve(__dirname, './src'),</span></span><br><span class="line"><span class="addition">+ 			context: path.resolve(__dirname, '../src')</span></span><br><span class="line">      extensions: ['ts', 'tsx', 'js', 'jsx'], // 指定要检查的文件后缀名</span><br><span class="line">      // 插件没完全兼容eslint &gt;= 8的版本带来的 Flat Config，需要手动指定路径</span><br><span class="line">      eslintPath: require.resolve('eslint/use-at-your-own-risk'),</span><br><span class="line">    }),</span><br><span class="line">    new HtmlWebpackPlugin({</span><br><span class="line">      // template参数指定生成的html以哪个文件为参考生成结构</span><br><span class="line"><span class="deletion">-       template: path.resolve(__dirname, './index.html')</span></span><br><span class="line"><span class="addition">+ 			template: path.resolve(__dirname, '../index.html')</span></span><br><span class="line">    }),</span><br><span class="line">    new ForkTsCheckerWebpackPlugin(),</span><br><span class="line">  ],</span><br><span class="line">  devServer: {</span><br><span class="line">    host: 'localhost', // 主机名</span><br><span class="line">    port: 3000, // 端口号</span><br><span class="line">    static: "./dist", // 静态文件目录</span><br><span class="line">    open: true, // 自动打开浏览器</span><br><span class="line">  },</span><br><span class="line"><span class="addition">+	  devtool: "inline-source-map", // 启用源码地图</span></span><br><span class="line">  // mode表示webpack的运行模式，有development和production两种，默认是production</span><br><span class="line">  mode: "development"</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>在开发模式下，编译打包发生在内存中，没有输出结果不会写入到磁盘变成文件，所以 output 的 path 我写成 undefined（实际开发模式会忽略此项配置）；因为我们改动了 webpack 配置文件所在的路径，需要给使用绝对路径的配置项纠正路径，所以插件部分的 <code>path.resolve</code> 的路径都往上了一级；入口文件为什么不改呢？首先入口文件并非绝对路径，其次因为 webpack 是运行在 Node 环境中的，Node 的运行环境又是相对于执行命令时的路径（也就是根目录），所以入口文件不需要改动也能找到正确的文件。</p>
<div class="note no-icon info flat"><p><strong><code>eslintPath: require.resolve("eslint/use-at-your-own-risk")</code></strong><br>
它直接走 Node 的模块查找机制，最终解析到 <code>node_modules/eslint</code> 中的绝对路径，和配置文件在哪个目录没关系。</p>
</div>
<h3 id="prod环境"><a class="markdownIt-Anchor" href="#prod环境"></a> prod 环境</h3>
<p>生产环境也需要修改配置文件：</p>
<figure class="highlight diff"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">const path = require('path'); // 引入node.js的path模块</span><br><span class="line">const ForkTsCheckerWebpackPlugin = require('fork-ts-checker-webpack-plugin');</span><br><span class="line">const HtmlWebpackPlugin = require('html-webpack-plugin');</span><br><span class="line">const ESLintPlugin = require('eslint-webpack-plugin');</span><br><span class="line"></span><br><span class="line">module.exports = {</span><br><span class="line">  entry: './src/index.ts', // 入口文件，webpack从入口文件开始解析依赖关系</span><br><span class="line">  output: {</span><br><span class="line">    filename: 'static/js/main.js', // 输出文件名</span><br><span class="line"><span class="deletion">-     path: path.resolve(__dirname, 'dist'), // __dirname是node.js的全局变量，代表当前执行脚本所在的目录</span></span><br><span class="line"><span class="addition">+ 		path: path.resolve(__dirname, '../dist'), // __dirname是node.js的全局变量，代表当前执行脚本所在的目录</span></span><br><span class="line">    clean: true // 每次打包前清空dist目录</span><br><span class="line">  },</span><br><span class="line">  // loader配置</span><br><span class="line">  module: {</span><br><span class="line">    rules: [</span><br><span class="line">    	// ......</span><br><span class="line">    ]</span><br><span class="line">  },</span><br><span class="line">  // 插件配置</span><br><span class="line">  plugins: [</span><br><span class="line">    new ESLintPlugin({</span><br><span class="line">      // 指定要约束的文件位置</span><br><span class="line"><span class="deletion">-       context: path.resolve(__dirname, './src'),</span></span><br><span class="line"><span class="addition">+				context: path.resolve(__dirname, '../src'),</span></span><br><span class="line">      extensions: ['ts', 'tsx', 'js', 'jsx'], // 指定要检查的文件后缀名</span><br><span class="line">      // 插件没完全兼容eslint &gt;= 8的版本带来的 Flat Config，需要手动指定路径</span><br><span class="line">      eslintPath: require.resolve('eslint/use-at-your-own-risk'),</span><br><span class="line">    }),</span><br><span class="line">    new HtmlWebpackPlugin({</span><br><span class="line">      // template参数指定生成的html以哪个文件为参考生成结构</span><br><span class="line"><span class="deletion">-       template: path.resolve(__dirname, './index.html')</span></span><br><span class="line"><span class="addition">+ 			template: path.resolve(__dirname, '../index.html')</span></span><br><span class="line">    }),</span><br><span class="line">    new ForkTsCheckerWebpackPlugin(),</span><br><span class="line">  ],</span><br><span class="line"><span class="deletion">-  devServer: {</span></span><br><span class="line"><span class="deletion">-    host: 'localhost', // 主机名</span></span><br><span class="line"><span class="deletion">-    port: 3000, // 端口号</span></span><br><span class="line"><span class="deletion">-    static: "./dist", // 静态文件目录</span></span><br><span class="line"><span class="deletion">-    open: true, // 自动打开浏览器</span></span><br><span class="line"><span class="deletion">-   },</span></span><br><span class="line">  // mode表示webpack的运行模式，有development和production两种，默认是production</span><br><span class="line"><span class="deletion">-   mode: "development"</span></span><br><span class="line"><span class="addition">+ 	mode: "production"</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="改写命令脚本"><a class="markdownIt-Anchor" href="#改写命令脚本"></a> 改写命令脚本</h3>
<p>前面我们配置了 ESLint，现在又分离了开发和生产环境，此时执行命令急需改造。修改 <code>package.json</code>，将原来的 scripts 项：</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">"scripts"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"test"</span><span class="punctuation">:</span> <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line"><span class="punctuation">}</span><span class="punctuation">,</span></span><br></pre></td></tr></tbody></table></figure>
<p>改成下面：</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">"scripts"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"lint"</span><span class="punctuation">:</span> <span class="string">"eslint \"src/**/*.{ts,tsx,js}\""</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"dev"</span><span class="punctuation">:</span> <span class="string">"npm run lint &amp;&amp; webpack serve --config ./config/webpack.dev.js"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"start"</span><span class="punctuation">:</span> <span class="string">"npm run dev"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"build"</span><span class="punctuation">:</span> <span class="string">"webpack --config ./config/webpack.prod.js"</span></span><br><span class="line"><span class="punctuation">}</span><span class="punctuation">,</span></span><br></pre></td></tr></tbody></table></figure>
<p>scripts 配置的是一个对象，所以其中的命令顺序没有关系。配置了上述命令脚本，以后我们使用开发模式进行查看，就只需要运行简单的命令：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></tbody></table></figure>
<p>这将先触发 ESLint 的检查然后再启动开发服务器，一旦 ESLint 检测到语法问题触发报错，打包将停止。</p>
<p>生产模式同理，执行简单命令：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></tbody></table></figure>
<p>即可打包生成静态结果。</p>
<h2 id="css提取优化"><a class="markdownIt-Anchor" href="#css提取优化"></a> CSS 提取优化</h2>
<p>目前我们打包 css 有个问题：css 被打包到 js 文件中，css 样式只能等待到 js 被执行完毕才能被应用，而在 js 执行的过程中，浏览器可能已经渲染出了<strong>原始的 DOM 结构</strong>，页面表现为裸 HTML 结构，等待到 JS 执行完毕，<strong>style 标签</strong>终于被插入完毕，样式被应用，浏览器又重新渲染，这在用户看来就是 "闪屏" 现象。</p>
<p>针对这个现象，我们要做的就是把 css 单独提取出来变成 <code>&lt;link&gt;</code> 标签，让 CSS 可以和 JS 并行下载，并且在 <strong>首次渲染之前</strong> 就能应用样式，避免闪屏。</p>
<details class="folding-tag"><summary> 为什么单独抽取 css 为 link 标签可以避免闪屏？ </summary>
              <div class="content">
              <p>要知道为什么，需要你对浏览器渲染原理有一定了解。可以看看我之前写的《<a href="https://4rozen.github.io/posts/1303">浏览器渲染原理</a>》</p><p>简单来说，当浏览器解析 HTML 遇到 <code>&lt;link&gt;</code>，会下载 CSS，启动 CSS 的预解析线程，使得 CSSOM 在较早阶段可用。</p><p>浏览器会<strong>等待关键 CSSOM 就绪再做首次完全渲染</strong>（即使主解析线程继续解析 HTML，渲染会等 CSSOM）。</p><p>因此当 CSS 是通过 <code>&lt;link&gt;</code> 提前可用时，首次绘制就包含正确样式，从而避免闪屏出现（代价是阻塞渲染的时间，但通常能改善一点视觉稳定性）。</p><p>如果你想验证，可以按照下面的思路进行：</p><ol><li>在本地启动 dev server 并使用 <code>style-loader</code>，在 Chrome DevTools （一般浏览器叫开发者工具）的 Network 设置为 Slow 3G 并禁用 cache，刷新页面：你会看到先是裸 HTML / 文本再有样式。</li><li>在 Performance 面板录制加载过程，查看首次绘制（FP）和后面的 repaint/reflow，能明显看到样式注入引起的重排。</li><li>临时把 JS 放到头部或把 CSS 直接注入 <code>&lt;style&gt;</code>，观察差异。</li></ol>
              </div>
            </details>
<h3 id="minicssextractplugin"><a class="markdownIt-Anchor" href="#minicssextractplugin"></a> MiniCssExtractPlugin</h3>
<p>安装 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/plugins/mini-css-extract-plugin">MiniCssExtractPlugin</a> 插件：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev mini-css-extract-plugin</span><br></pre></td></tr></tbody></table></figure>
<p>安装之后我们就不再需要 <code>style-loader</code> 了，顾名思义，它就是用来动态插入生成 style 标签的，我们将其改为 MiniCssExtractPlugin（<code>webpack.prod.js</code>）：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">"mini-css-extract-plugin"</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>()],</span><br><span class="line">  <span class="attr">module</span>: {</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      {</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="comment">// 匹配文件后缀名为.css的文件</span></span><br><span class="line">        <span class="attr">use</span>: [ <span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">'css-loader'</span>],</span><br><span class="line">        <span class="attr">generator</span>: {</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">'static/css/[name].[contenthash:8].css'</span> <span class="comment">// 输出文件名</span></span><br><span class="line">        }</span><br><span class="line">      },</span><br><span class="line">      {</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.s[ac]ss$/i</span>, <span class="comment">// 匹配文件后缀名为.scss或.sass的文件</span></span><br><span class="line">        <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>],</span><br><span class="line">        <span class="attr">generator</span>: {</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">'static/css/[name].[contenthash:8].css'</span> <span class="comment">// 输出文件名</span></span><br><span class="line">        }</span><br><span class="line">      },</span><br><span class="line">    ],</span><br><span class="line">  },</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>注意改动的是生产环境的 webpack 配置文件，别搞错了。</p>
<p>这之后可以使用打包命令看看效果了：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202315285.png" alt="image-20250920231526029"></p>
<p>可以看到默认是打包到了 <code>dist</code> 目录下，我们自然希望它在 <code>static</code> 目录下，所以继续配置插件：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>({</span><br><span class="line">  <span class="attr">filename</span>: <span class="string">"static/css/[name].[contenthash:8].css"</span> <span class="comment">// 输出文件名</span></span><br><span class="line">}),</span><br></pre></td></tr></tbody></table></figure>
<p>这样就好了。</p>
<h2 id="css兼容性"><a class="markdownIt-Anchor" href="#css兼容性"></a> CSS 兼容性</h2>
<p>css 兼容性是老生常谈的问题了，我们一般使用 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://postcss.org/">postcss</a> 来解决。postcss 在 webpack 中是一个 loader：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/loaders/postcss-loader/#root">postcss-loader</a></p>
<p>安装命令：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev postcss-loader postcss postcss-preset-env</span><br></pre></td></tr></tbody></table></figure>
<p>接着修改 webpack 的开发配置文件：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="comment">// 匹配文件后缀名为.css的文件</span></span><br><span class="line">  <span class="attr">use</span>: [ <span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">'css-loader'</span>, {</span><br><span class="line">    <span class="attr">loader</span>: <span class="string">'postcss-loader'</span>,</span><br><span class="line">    <span class="attr">options</span>: {</span><br><span class="line">      <span class="attr">postcssOptions</span>: {</span><br><span class="line">        <span class="attr">plugins</span>: [</span><br><span class="line">          <span class="string">"postcss-preset-env"</span>, <span class="comment">// 预设</span></span><br><span class="line">        ]</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }],</span><br><span class="line">  <span class="attr">generator</span>: {</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">'static/css/[name].[contenthash:8].css'</span> <span class="comment">// 输出文件名</span></span><br><span class="line">  }</span><br><span class="line">},</span><br><span class="line">{</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.s[ac]ss$/i</span>, <span class="comment">// 匹配文件后缀名为.scss或.sass的文件</span></span><br><span class="line">  <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">'css-loader'</span>, {</span><br><span class="line">    <span class="attr">loader</span>: <span class="string">'postcss-loader'</span>,</span><br><span class="line">    <span class="attr">options</span>: {</span><br><span class="line">      <span class="attr">postcssOptions</span>: {</span><br><span class="line">        <span class="attr">plugins</span>: [</span><br><span class="line">          <span class="string">"postcss-preset-env"</span>, <span class="comment">// 能解决大部分的兼容性问题</span></span><br><span class="line">        ]</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }, <span class="string">'sass-loader'</span>],</span><br><span class="line">  <span class="attr">generator</span>: {</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">'static/css/[name].[contenthash:8].css'</span> <span class="comment">// 输出文件名</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<div class="note no-icon warning flat"><p>请注意，use 中 loader 的执行顺序是从右到左。所以对于普通的 css 应当是将 postcss 配置写在最右，让其第一个被执行，先处理兼容性问题，然后让 css-loader 处理 css 内容，最后让 MiniCssExtractPlugin 提取 css 文件为 link 标签；对于 sass、less、stylus 等，应当是将 postcss 配置写在预编译之后，让 posttcss 处理预编译得到的 css 代码而非 sass、lesss 和 stylus 代码。</p>
</div>
<p>除了预设，我们还可以让 postcss 知道兼容性要做到什么程度。在 <code>package.json</code> 中增加配置：</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">"browserslist"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="string">"ie &gt;= 8"</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note no-icon info flat"><p>实际上兼容性不需要做到如此好，此处仅作演示。兼容的浏览器版本越久远，就越需要更多的兼容性代码，文件体积也会一定程度的增加。<br>
一般我们会配置为（注释仅供参考，实际不需要）：</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">"browserslist"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="comment">// 每个主流浏览器的最近两个版本</span></span><br><span class="line">  <span class="string">"last 2 versions"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 全球市场份额大于 1% 的浏览器，太旧的不考虑</span></span><br><span class="line">  <span class="string">"&gt; 1%"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 排除掉已经废弃的浏览器</span></span><br><span class="line">  <span class="string">"not dead"</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></tbody></table></figure>
</div>
<p>因为我们此前的 css 中使用到了 <code>display: flex</code>，而 flex 布局是存在一定兼容性问题的，所以我们可以直接执行生产打包看看效果：</p>
<p><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509202347203.png" alt="image-20250920234739011"></p>
<p><code>display: flex;</code> 变成了 <code>-ms-flexbox</code>，这就说明 postcss 正确配置了。</p>
<h2 id="优化css的loader结构"><a class="markdownIt-Anchor" href="#优化css的loader结构"></a> 优化 css 的 loader 结构</h2>
<p>目前我们的 webpack 配置中，关于 css 的相关 loader 是存在一定重复代码的（因为我没有处理每一种 css 所以较少，如果你们写了 css、sass、less、stylus，那就很多重复代码了），我们可以将它们抽离为函数，精简代码结构：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>); <span class="comment">// 引入node.js的path模块</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ForkTsCheckerWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">'fork-ts-checker-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ESLintPlugin</span> = <span class="built_in">require</span>(<span class="string">'eslint-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">"mini-css-extract-plugin"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getStyleLoaders</span> = (<span class="params">...loaders</span>) =&gt; {</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>,</span><br><span class="line">    <span class="string">'css-loader'</span>,</span><br><span class="line">    {</span><br><span class="line">      <span class="attr">loader</span>: <span class="string">'postcss-loader'</span>,</span><br><span class="line">      <span class="attr">options</span>: {</span><br><span class="line">        <span class="attr">postcssOptions</span>: {</span><br><span class="line">          <span class="attr">plugins</span>: [</span><br><span class="line">            <span class="string">"postcss-preset-env"</span>,</span><br><span class="line">          ]</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    },</span><br><span class="line">    ...loaders</span><br><span class="line">  ].<span class="title function_">filter</span>(<span class="title class_">Boolean</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="comment">// loader配置</span></span><br><span class="line">  <span class="attr">module</span>: {</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      {</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="comment">// 匹配文件后缀名为.css的文件</span></span><br><span class="line">        <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(),</span><br><span class="line">        <span class="attr">generator</span>: {</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">'static/css/[name].[contenthash:8].css'</span> <span class="comment">// 输出文件名</span></span><br><span class="line">        }</span><br><span class="line">      },</span><br><span class="line">      {</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.s[ac]ss$/i</span>, <span class="comment">// 匹配文件后缀名为.scss或.sass的文件</span></span><br><span class="line">        <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(<span class="string">'sass-loader'</span>),</span><br><span class="line">        <span class="attr">generator</span>: {</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">'static/css/[name].[contenthash:8].css'</span> <span class="comment">// 输出文件名</span></span><br><span class="line">        }</span><br><span class="line">      },</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>这里函数的参数是剩余参数，所以传入多个参数时，需要理解 use 的处理顺序（从右到左）传入合适的参数。</p>
<p>例如：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getStyleLoaders</span> = (<span class="params">...loaders</span>) =&gt; [</span><br><span class="line">  <span class="string">'css-loader'</span>,</span><br><span class="line">  ...loaders</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getStyleLoaders</span>(<span class="string">'postcss-loader'</span>, <span class="string">'sass-loader'</span>));</span><br><span class="line"><span class="comment">// 输出: ['css-loader', 'postcss-loader', 'sass-loader']</span></span><br></pre></td></tr></tbody></table></figure>
<p>此时 use 也能正确处理。</p>
<h2 id="css压缩"><a class="markdownIt-Anchor" href="#css压缩"></a> CSS 压缩</h2>
<p>CSS 压缩需要使用到插件：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpackjs.com/plugins/css-minimizer-webpack-plugin/">CssMinimizerWebpackPlugin</a></p>
<p>安装命令：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install css-minimizer-webpack-plugin --save-dev</span><br></pre></td></tr></tbody></table></figure>
<p>引入插件（<code>webpack.prod.js</code>）：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">CssMinimizerPlugin</span> = <span class="built_in">require</span>(<span class="string">'css-minimizer-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="comment">// optimization与output等配置项平级</span></span><br><span class="line">  <span class="attr">optimization</span>: {</span><br><span class="line">    <span class="attr">minimizer</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">CssMinimizerPlugin</span>(), <span class="comment">// 压缩css文件</span></span><br><span class="line">    ]</span><br><span class="line">  },</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>执行生产打包命令之后如果看到 <code>dist/static/css/</code> 目录下的 css 文件如果是一行，那就说明压缩生效了。</p>
<h2 id="html和js压缩"><a class="markdownIt-Anchor" href="#html和js压缩"></a> html 和 js 压缩</h2>
<p>目前，html 打包后会自动压缩，但是 js 并不会（说实话这很奇怪，按理来说是都会被压缩的）。翻看了官方文档：</p>
<blockquote>
<p>Webpack v5 comes with the latest <code>terser-webpack-plugin</code> out of the box. If you are using Webpack v5 or above and wish to customize the options, you will still need to install <code>terser-webpack-plugin</code>.</p>
<p>译：Webpack v5 自带最新的 <code>terser-webpack-plugin</code> 。如果你使用的是 Webpack v5 或更高版本，并且希望自定义选项，你仍然需要安装 <code>terser-webpack-plugin</code> 。</p>
</blockquote>
<p><s>说实话，我没看懂这左右脑互搏的说明，自带！= 安装过了？</s></p>
<p>安装 <code>terser-webpack-plugin</code>：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install terser-webpack-plugin --save-dev</span><br></pre></td></tr></tbody></table></figure>
<p>引入并应用（<code>webpack.prod.js</code>）：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">TerserPlugin</span> = <span class="built_in">require</span>(<span class="string">'terser-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  <span class="attr">optimization</span>: {</span><br><span class="line">    <span class="attr">minimize</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">minimizer</span>: [<span class="keyword">new</span> <span class="title class_">TerserPlugin</span>()],</span><br><span class="line">  },</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>这样执行生产打包就能看到效果了。</p>
<blockquote>
<p>我后来想了想，文档的意思应该是：如果你覆盖了默认的 minimizer（比如加了 <code>CssMinimizerPlugin</code>），就必须自己安装并手动添加 TerserPlugin，否则 JS 不会压缩。</p>
</blockquote>
<p>至此，webpack 基础篇完结撒花。</p>
<p>最终代码地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/4rozeN/webpack5-tutorial-basics">webpack5-tutorial-basics</a></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/avatar/avatar.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/avatar/avatar.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">4rozeN</div><div class="post-copyright__author_desc">历历浮生，无非败而后成。</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://4rozen.github.io/posts/37010">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://4rozen.github.io/posts/37010')">Webpack 基础入门</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/loveU/wx_zanshang.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/loveU/wx_zanshang.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/loveU/alipay_zanshang.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/loveU/alipay_zanshang.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://4rozeN.github.io" target="_blank">林之介4rozeN</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/webpack/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>webpack<span class="tagsPageCount">1</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/10729"><img class="prev-cover" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E9%9A%8F%E6%83%B3%E9%9A%8F%E8%AE%B0/win-ssh.webp" onerror="onerror=null;src='/img/avatar/emo.webp'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Hexo 通过 git 的 ssh 链接 github 超时 (time out)</div></div></a></div><div class="next-post pull-right"><a href="/posts/8736"><img class="next-cover" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/Hexo/Hexo%E9%AD%94%E6%94%B9.webp" onerror="onerror=null;src='/img/avatar/emo.webp'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">fluid 创建自定义导航页</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" rel="external nofollow noreferrer">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/avatar/avatar.jpg" onerror="this.onerror=null;this.src='/img/avatar/emo.webp'" alt="avatar"/></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">设计、开发</b>相关的问题和看法，还有<b style="color:#fff">其他文章</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">4rozeN</h1><div class="author-info__desc">历历浮生，无非败而后成。</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/4rozeN" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="mailto:mail4chen@foxmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text"> 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">2.</span> <span class="toc-text"> 概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD"><span class="toc-number">3.</span> <span class="toc-text"> 功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%AE%80%E5%8D%95%E5%B7%A5%E7%A8%8B"><span class="toc-number">4.</span> <span class="toc-text"> 创建简单工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">5.</span> <span class="toc-text"> 核心概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">6.</span> <span class="toc-text"> 基础配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F%E4%B8%8E%E7%94%9F%E4%BA%A7%E6%A8%A1%E5%BC%8F%E6%A6%82%E5%BF%B5"><span class="toc-number">7.</span> <span class="toc-text"> 开发模式与生产模式概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86ts"><span class="toc-number">8.</span> <span class="toc-text"> 处理 TS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ts-loader"><span class="toc-number">8.1.</span> <span class="toc-text"> ts-loader</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js%E5%85%BC%E5%AE%B9%E6%80%A7%E9%97%AE%E9%A2%98"><span class="toc-number">9.</span> <span class="toc-text"> js 兼容性问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babel"><span class="toc-number">10.</span> <span class="toc-text"> Babel</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="toc-number">10.1.</span> <span class="toc-text"> 核心功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">10.2.</span> <span class="toc-text"> 常见应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8babel"><span class="toc-number">10.3.</span> <span class="toc-text"> 应用 Babel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88ts-loader%E9%9C%80%E8%A6%81%E8%B7%B3%E8%BF%87%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5"><span class="toc-number">10.4.</span> <span class="toc-text"> 为什么 ts-loader 需要跳过类型检查</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fork-ts-checker-webpack-plugin"><span class="toc-number">11.</span> <span class="toc-text"> fork-ts-checker-webpack-plugin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86css"><span class="toc-number">12.</span> <span class="toc-text"> 处理 CSS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86sass"><span class="toc-number">13.</span> <span class="toc-text"> 处理 sass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90"><span class="toc-number">14.</span> <span class="toc-text"> 处理图片资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E8%BE%93%E5%87%BA%E8%B5%84%E6%BA%90"><span class="toc-number">15.</span> <span class="toc-text"> 分类输出资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87%E8%B5%84%E6%BA%90"><span class="toc-number">16.</span> <span class="toc-text"> 处理字体图标资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%85%B6%E4%BB%96%E8%B5%84%E6%BA%90"><span class="toc-number">17.</span> <span class="toc-text"> 处理其他资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86html%E8%B5%84%E6%BA%90"><span class="toc-number">18.</span> <span class="toc-text"> 处理 Html 资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">19.</span> <span class="toc-text"> 搭建开发服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eslint"><span class="toc-number">20.</span> <span class="toc-text"> ESLint</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85eslint"><span class="toc-number">20.1.</span> <span class="toc-text"> 安装 ESLint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eslint%E9%85%8D%E7%BD%AE"><span class="toc-number">20.2.</span> <span class="toc-text"> ESLint 配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E6%A8%A1%E5%BC%8F"><span class="toc-number">21.</span> <span class="toc-text"> 生产模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dev%E7%8E%AF%E5%A2%83"><span class="toc-number">21.1.</span> <span class="toc-text"> dev 环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prod%E7%8E%AF%E5%A2%83"><span class="toc-number">21.2.</span> <span class="toc-text"> prod 环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E5%86%99%E5%91%BD%E4%BB%A4%E8%84%9A%E6%9C%AC"><span class="toc-number">21.3.</span> <span class="toc-text"> 改写命令脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#css%E6%8F%90%E5%8F%96%E4%BC%98%E5%8C%96"><span class="toc-number">22.</span> <span class="toc-text"> CSS 提取优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#minicssextractplugin"><span class="toc-number">22.1.</span> <span class="toc-text"> MiniCssExtractPlugin</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#css%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-number">23.</span> <span class="toc-text"> CSS 兼容性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96css%E7%9A%84loader%E7%BB%93%E6%9E%84"><span class="toc-number">24.</span> <span class="toc-text"> 优化 css 的 loader 结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#css%E5%8E%8B%E7%BC%A9"><span class="toc-number">25.</span> <span class="toc-text"> CSS 压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#html%E5%92%8Cjs%E5%8E%8B%E7%BC%A9"><span class="toc-number">26.</span> <span class="toc-text"> html 和 js 压缩</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/24974" title="从 JS 属性描述符再看 Vue 数据响应式原理"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E5%89%8D%E7%AB%AF/Vue%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86v2.webp" onerror="this.onerror=null;this.src='/img/avatar/emo.webp'" alt="从 JS 属性描述符再看 Vue 数据响应式原理"/></a><div class="content"><a class="title" href="/posts/24974" title="从 JS 属性描述符再看 Vue 数据响应式原理">从 JS 属性描述符再看 Vue 数据响应式原理</a><time datetime="2025-09-04T03:46:56.828Z" title="发表于 2025-09-04 11:46:56">2025-09-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1303" title="浏览器渲染原理"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E5%89%8D%E7%AB%AF/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86.webp" onerror="this.onerror=null;this.src='/img/avatar/emo.webp'" alt="浏览器渲染原理"/></a><div class="content"><a class="title" href="/posts/1303" title="浏览器渲染原理">浏览器渲染原理</a><time datetime="2025-09-01T12:09:13.000Z" title="发表于 2025-09-01 20:09:13">2025-09-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/13214" title="事件循环"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E5%89%8D%E7%AB%AF/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF.webp" onerror="this.onerror=null;this.src='/img/avatar/emo.webp'" alt="事件循环"/></a><div class="content"><a class="title" href="/posts/13214" title="事件循环">事件循环</a><time datetime="2025-09-01T04:50:13.000Z" title="发表于 2025-09-01 12:50:13">2025-09-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1" title="JS 属性描述符"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E5%89%8D%E7%AB%AF/%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6.webp" onerror="this.onerror=null;this.src='/img/avatar/emo.webp'" alt="JS 属性描述符"/></a><div class="content"><a class="title" href="/posts/1" title="JS 属性描述符">JS 属性描述符</a><time datetime="2025-09-01T03:50:13.000Z" title="发表于 2025-09-01 11:50:13">2025-09-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9104" title="js+css 实现 Hexo 博客 ripple 水波切换主题效果"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/Hexo/Hexo%E7%BE%8E%E5%8C%96.webp" onerror="this.onerror=null;this.src='/img/avatar/emo.webp'" alt="js+css 实现 Hexo 博客 ripple 水波切换主题效果"/></a><div class="content"><a class="title" href="/posts/9104" title="js+css 实现 Hexo 博客 ripple 水波切换主题效果">js+css 实现 Hexo 博客 ripple 水波切换主题效果</a><time datetime="2025-07-22T02:50:13.000Z" title="发表于 2025-07-22 10:50:13">2025-07-22</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:mail4chen@foxmail.com" rel="external nofollow noreferrer" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" href="/rss2.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/avatar/avatar.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/4rozeN" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" href="/copyright" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="十年之约" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">主题</div><div class="footer-links"><a class="footer-item" title="文档" target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.anheyu.com/global/base.html">文档</a><a class="footer-item" title="源码" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu/tree/main">源码</a><a class="footer-item" title="更新日志" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu/releases">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="Static Badge" target="_blank" rel="noopener external nofollow noreferrer" href="https://shields.io/badges">Static Badge</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" rel="external nofollow noreferrer" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" rel="external nofollow noreferrer" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" rel="external nofollow noreferrer" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://www.zstatic.net/" rel="external nofollow noreferrer" style="margin-inline:5px" data-title="本站使用Zstatic为静态资源提供CDN加速" title="本站使用Zstatic为静态资源提供CDN加速"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://gitee.com/CSJ021005/new-pic-bed/raw/main/img/202509151905840.svg" alt="本站使用Zstatic为静态资源提供CDN加速"/></a><a class="github-badge" target="_blank" href="https://github.com/" rel="external nofollow noreferrer" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="4rozeN" target="_blank">4rozeN</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://icp.gov.moe/?keyword=20254070" title="萌ICP备-20254070号">萌ICP备-20254070号</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">35</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">58</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">7</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" rel="external nofollow noreferrer" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://4rozen.github.com/" title="我的博客"><img class="back-menu-item-icon" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/ico/favicon.ico" alt="我的博客"/><span class="back-menu-item-text">我的博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="https://4rozen.github.io/sliph-scope-view/" title="个体值修改"><img class="back-menu-item-icon" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/icon/%E5%B0%8F%E7%81%AB%E9%BE%99.png" alt="个体值修改"/><span class="back-menu-item-text">个体值修改</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/4rozeN/Simple-Animated-Guns-Fixed" title="MC枪械模组"><img class="back-menu-item-icon" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E6%88%91%E7%9A%84%E9%A1%B9%E7%9B%AE/SAG.jpg" alt="MC枪械模组"/><span class="back-menu-item-text">MC枪械模组</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/4rozeN/Datapack_S.A.G" title="SAG数据包"><img class="back-menu-item-icon" src= "/img/loading/loading.gif" onerror="this.onerror=null,this.src=&quot;/img/avatar/emo.webp&quot;" data-lazy-src="https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/cover/%E6%88%91%E7%9A%84%E9%A1%B9%E7%9B%AE/SAG.jpg" alt="SAG数据包"/><span class="back-menu-item-text">SAG数据包</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 文章分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 文章标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Bootstrap/" style="font-size: 0.88rem;">Bootstrap<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 0.88rem;">CSS<sup>2</sup></a><a href="/tags/CTF-WP/" style="font-size: 0.88rem;">CTF-WP<sup>1</sup></a><a href="/tags/DOH/" style="font-size: 0.88rem;">DOH<sup>1</sup></a><a href="/tags/Fabric/" style="font-size: 0.88rem;">Fabric<sup>3</sup></a><a href="/tags/Fluid/" style="font-size: 0.88rem;">Fluid<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>1</sup></a><a href="/tags/GitHubActions/" style="font-size: 0.88rem;">GitHubActions<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>6</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>5</sup></a><a href="/tags/Minecraft/" style="font-size: 0.88rem;">Minecraft<sup>5</sup></a><a href="/tags/Modding/" style="font-size: 0.88rem;">Modding<sup>1</sup></a><a href="/tags/PHP/" style="font-size: 0.88rem;">PHP<sup>1</sup></a><a href="/tags/Strapi/" style="font-size: 0.88rem;">Strapi<sup>1</sup></a><a href="/tags/Vue/" style="font-size: 0.88rem;">Vue<sup>2</sup></a><a href="/tags/ejs/" style="font-size: 0.88rem;">ejs<sup>1</sup></a><a href="/tags/fluid/" style="font-size: 0.88rem;">fluid<sup>2</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/github/" style="font-size: 0.88rem;">github<sup>1</sup></a><a href="/tags/http/" style="font-size: 0.88rem;">http<sup>1</sup></a><a href="/tags/indexnow/" style="font-size: 0.88rem;">indexnow<sup>1</sup></a><a href="/tags/python/" style="font-size: 0.88rem;">python<sup>1</sup></a><a href="/tags/ssh/" style="font-size: 0.88rem;">ssh<sup>1</sup></a><a href="/tags/styl/" style="font-size: 0.88rem;">styl<sup>1</sup></a><a href="/tags/%E5%85%A8%E6%88%90%E5%B0%B1%E5%B8%AE%E6%89%8B/" style="font-size: 0.88rem;">全成就帮手<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 0.88rem;">反序列化<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%A4%9C%E5%88%87%E6%8D%A2%E8%83%8C%E6%99%AF/" style="font-size: 0.88rem;">日夜切换背景<sup>1</sup></a><a href="/tags/%E6%A8%A1%E7%BB%84%E5%BC%80%E5%8F%91/" style="font-size: 0.88rem;">模组开发<sup>1</sup></a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 0.88rem;">笔记<sup>4</sup></a><a href="/tags/%E7%BE%8E%E5%8C%96/" style="font-size: 0.88rem;">美化<sup>3</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="438394768" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.2"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/playlist&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://s4.zstatic.net/ajax/libs/fancyapps-ui/6.0.30/fancybox/fancybox.umd.js"></script><script src="https://s4.zstatic.net/ajax/libs/instant.page/5.2.0/instantpage.min.js" type="module"></script><script src="https://s4.zstatic.net/ajax/libs/vanilla-lazyload/19.1.3/lazyload.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/node-snackbar/0.1.16/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://4rozen-blog.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://s4.zstatic.net/ajax/libs/twikoo/1.6.44/twikoo.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://4rozen-blog.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.0.0/waterfall/waterfall.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.min.css"><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://s4.zstatic.net/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/meting/2.0.1/Meting.min.js"></script><script charset="UTF-8" src="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.1.5/accesskey/accesskey.min.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>