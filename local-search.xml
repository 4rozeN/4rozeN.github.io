<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Hexo 通过 git 的 ssh 链接 github 超时 (time out)</title>
    <link href="/archives/notes/10729.html"/>
    <url>/archives/notes/10729.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="最近在提交hexo文章时，遇到了git通过ssh链接github超时time out的问题，终端上的黄字非常具有迷惑性：Error: Spawn failed!实际上还是git配置端口的问题。"><h1 id="hexo通过git的ssh链接github超时time-out"><a class="markdownIt-Anchor" href="#hexo通过git的ssh链接github超时time-out"></a> Hexo 通过 git 的 ssh 链接 github 超时 (time out)</h1><p>最近在提交 hexo 文章时，遇到了 git 通过 ssh 链接 github 超时 time out 的问题，终端上的黄字非常具有迷惑性：<mark>Error: Spawn failed!</mark></p><p>使用 <code>ssh -T git@github.com</code> 进行测试也是如此。</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">$</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">ssh</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-T</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">git@github.com</span></span><span class="line"><span style="color: #DCDCAA">ssh:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">connect</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">to</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">host</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">github.com</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">port</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">22</span><span style="color: #CE9178">:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Connection</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">timed</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">out</span></span></code></pre></div></div></figure><p>实际上是 git 在尝试使用端口 22 链接超时而已，我们可以将其改为 443 再链接。</p><h2 id="解决办法"><a class="markdownIt-Anchor" href="#解决办法"></a> 解决办法</h2><ol><li><p>找到你生成 rsa 的地方，它可能是 <code>C:\Users\Name\.ssh</code><br>还记得吗？你曾通过 <code>ssh-keygen -t rsa -C "你的git绑定的邮箱名字"</code> 这样一个命令生成了一个 rsa 文件（<a href="https://zhuanlan.zhihu.com/p/193140870">我不记得了 (≧﹏ ≦)</a>）</p></li><li><p>修改或创建一个 <code>config</code> 文件写入以下代码：</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">Host github.com</span></span><span class="line"><span style="color: #D4D4D4">HostName ssh.github.com</span></span><span class="line"><span style="color: #D4D4D4">User git</span></span><span class="line"><span style="color: #D4D4D4">Port 443</span></span><span class="line"><span style="color: #D4D4D4">PreferredAuthentications publickey</span></span><span class="line"><span style="color: #D4D4D4">IdentityFile ~/.ssh/id_rsa</span></span></code></pre></div></div></figure><p>这样就能将访问的 <code>github.com</code> 转换为 <code>ssh.github.com</code></p></li></ol><p>请注意，<code>~/</code> 是你要进行填充的地方，<code>~</code> 取决于你的 rsa 的保存位置。例如：<code>C:/Users/Administrator/.ssh/id_rsa</code></p><p>完成上述操作之后你就可以通过以下命令进行尝试：</p><figure class="shiki shell"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">$</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">ssh</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-T</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">git@github.com</span></span><span class="line"><span style="color: #DCDCAA">Hi</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">4</span><span style="color: #CE9178">rozeN!</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">You've successfully authenticated, but GitHub does not provide shell access.</span></span></code></pre></div></div></figure><p>成功的话，它会提示你已成功通过身份验证，但 GitHub 不提供 shell 访问权限，这是正常的。</p><blockquote><p>参考文章：<a href="https://blog.csdn.net/the__future/article/details/130038818">关于本地 git 通过 ssh 链接 github 时 time out 问题的解决方法</a></p></blockquote><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>随记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>git</tag>
      
      <tag>github</tag>
      
      <tag>ssh</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Steam 游戏全成就查漏补缺脚本</title>
    <link href="/archives/notes/39978.html"/>
    <url>/archives/notes/39978.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="由于 Steam 会根据你的游戏进度或者说成就进度，将一些成就隐藏起来，这导致你无法查看全部成就详情，哪怕能查看，如果游戏成就项足够多，玩家想要知道自己还剩具体的哪些成就没完成将是一个工作负担较大的事。该脚本可以帮你省去查找已解锁成就和比对环节。"><h1 id="diffachievements"><a class="markdownIt-Anchor" href="#diffachievements"></a> diffAchievements</h1><p>项目地址 Github：<a href="https://github.com/4rozeN/diffAchievements">diffAchievements</a></p><h2 id="关于"><a class="markdownIt-Anchor" href="#关于"></a> 关于</h2><p>diffAchievements 是一个获取 Steam 某一个特定的游戏的已解锁成就与全成就列表进行比对得到未解锁成就列表的工具脚本。</p><p>旨在帮助玩家更好的达成某游戏的全成就，或是进行查漏补缺。</p><h2 id="我为什么需要它"><a class="markdownIt-Anchor" href="#我为什么需要它"></a> 我为什么需要它</h2><p>由于 Steam 会根据你的游戏进度或者说成就进度，将一些成就隐藏起来，这导致你无法查看全部成就详情，哪怕能查看，<strong>如果游戏成就项足够多，玩家想要知道自己还剩具体的哪些成就没完成将是一个工作负担较大的事。</strong></p><p>该脚本可以帮你省去查找已解锁成就和比对环节，你只需为脚本提供你的某个游戏的当前成就进度页面地址。</p><p>该地址应当是：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">https://steamcommunity.com/id/430426/stats/2358720/?tab</span><span style="color: #D4D4D4">=achievements</span></span></code></pre></div></div></figure><p>示例图如下：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501181826412.png" alt="image-20250118182611298" style="zoom:50%;"></p><p>该页面可以在<code>个人资料-&gt;所有最近玩过的-&gt;我的游戏统计数据-&gt;我的成就</code>中找到：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501181841996.png" alt="image-20250118184103953" style="zoom:50%;"><br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501181841155.png" alt="image-20250118184157100" style="zoom:50%;"><br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501181843856.png" alt="image-20250118184303810" style="zoom:50%;"></p><h2 id="设置成就可见性"><a class="markdownIt-Anchor" href="#设置成就可见性"></a> 设置成就可见性</h2><p>为了可以通过网络请求访问到你的游戏成就详情，请在 Steam 的隐私设置中将游戏详情一项设置为公开。</p><p>这将使得你的某个游戏成就进度可以通过以下链接进行访问：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">https://steamcommunity.com/id/yourId/edit/settings</span></span></code></pre></div></div></figure><p>该设置示例图为：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501181828813.png" alt="image-20250118182813774" style="zoom:50%;"></p><h2 id="准备全成就文档"><a class="markdownIt-Anchor" href="#准备全成就文档"></a> 准备全成就文档</h2><p>此项废弃，现在并不需要你准备一份全成就的列表，脚本将自动通过全球玩家成就表进行解析。</p><p><strong>请注意！</strong><mark>某些游戏在全球成就表下部分成就的说明<strong>会被隐藏</strong>，故脚本保存的部分也会隐藏。若有需要，只得自行进行搜索成就详情说明。</mark></p><h2 id="使用"><a class="markdownIt-Anchor" href="#使用"></a> 使用</h2><p>将仓库 clone 或下载到本地目录中，例如：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">clone</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">https://github.com/4rozeN/diffAchievements.git</span></span></code></pre></div></div></figure><p>若无法下载，可以<a href="https://wwte.lanzouu.com/i1Xyv2la600f">点这里</a>使用蓝奏云进行下载。</p><p>进入项目目录，使用 python 命令运行：</p><figure class="shiki shell"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">python</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">diffAchievements.py</span></span></code></pre></div></div></figure><p><strong>该命令要求 python 拥有环境变量。</strong></p><p>根据提示输入必要信息即可。</p><h2 id="一份使用示例"><a class="markdownIt-Anchor" href="#一份使用示例"></a> 一份使用示例</h2><figure class="shiki shell"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">PS</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">E:</span><span style="color: #D7BA7D">\C</span><span style="color: #CE9178">oding</span><span style="color: #D7BA7D">\p</span><span style="color: #CE9178">y</span><span style="color: #D7BA7D">\d</span><span style="color: #CE9178">iffAchievement</span><span style="color: #D4D4D4">s&gt; </span><span style="color: #CE9178">python</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span><span style="color: #D7BA7D">\d</span><span style="color: #CE9178">iffAchievements.py</span></span><span class="line"><span style="color: #DCDCAA">请选择steam响应语言（Chinese/English）：c</span></span><span class="line"><span style="color: #DCDCAA">已选择中文作为Steam响应语言。</span></span><span class="line"><span style="color: #DCDCAA">请输入游戏的个人成就进度页面地址URL（例如：https://steamcommunity.com/id/43xxx123/stats/2358720/achievements/）：https://steamcommunity.com/id/430426/stats/578080/?tab</span><span style="color: #D4D4D4">=achievements</span></span><span class="line"><span style="color: #DCDCAA">是否开启代理？(y/n</span><span style="color: #D4D4D4">): y</span></span><span class="line"><span style="color: #DCDCAA">请输入代理地址（例如：http://127.0.0.1:7897）：http://127.0.0.1:7897</span></span><span class="line"><span style="color: #DCDCAA">已开启代理：http://127.0.0.1:7897</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">请求成功，正在解析页面...</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">正在将</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">unlocked_achievements</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">保存到当前目录下的</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">unlocked_achievements.txt</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">文件中...</span></span><span class="line"><span style="color: #DCDCAA">unlocked_achievements.txt</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">文件已保存。</span></span><span class="line"><span style="color: #DCDCAA">将保存的成就总数为:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">19</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">项。</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">请求成功，正在解析页面...</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">正在将</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">all_achievements</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">保存到当前目录下的</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">all_achievements.txt</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">文件中...</span></span><span class="line"><span style="color: #DCDCAA">all_achievements.txt</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">文件已保存。</span></span><span class="line"><span style="color: #DCDCAA">将保存的成就总数为:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">36</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">项。</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">找到的差异成就总数为:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">17</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">项。</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">正在将</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">diff_achievements</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">保存到当前目录下的</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">diff_achievements.txt</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">文件中...</span></span><span class="line"><span style="color: #DCDCAA">diff_achievements.txt</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">文件已保存。</span></span><span class="line"><span style="color: #DCDCAA">将保存的成就总数为:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">17</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">项。</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">程序终了。</span></span><span class="line"><span style="color: #DCDCAA">PS</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">E:</span><span style="color: #D7BA7D">\C</span><span style="color: #CE9178">oding</span><span style="color: #D7BA7D">\p</span><span style="color: #CE9178">y</span><span style="color: #D7BA7D">\d</span><span style="color: #CE9178">iffAchievement</span><span style="color: #D4D4D4">s&gt;</span></span></code></pre></div></div></figure><p>最终将生成三份 txt 文件于脚本同目录下：</p><ol><li><code>all_achievements.txt</code></li><li><code>diff_achievements.txt</code></li><li><code>unlocked_achievements.txt</code></li></ol><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>随记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>全成就帮手</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo 博客 Fluid 主题实现代码折叠和文字遮盖效果</title>
    <link href="/archives/Hexo/41513.html"/>
    <url>/archives/Hexo/41513.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="安装 hexo-sliding-spoiler 库实现 Fluid 主题下的代码折叠功能。"><h1 id="hexofluid代码折叠功能"><a class="markdownIt-Anchor" href="#hexofluid代码折叠功能"></a> Hexo&amp;Fluid 代码折叠功能</h1><p>hexo 博客默认是没有代码折叠功能的，如果需要实现代码折叠功能，需要安装 hexo-sliding-spoiler 库或者借助 Hexo 过滤器功能。</p><ul><li><a href="https://github.com/fletchto99/hexo-sliding-spoiler">hexo-sliding-spoiler</a></li><li><a href="https://kiyanyang.github.io/posts/c4dd4019/">使用 Hexo 过滤器实现代码折叠 By Kiyan</a></li></ul><h2 id="hexo-sliding-spoiler实现代码折叠"><a class="markdownIt-Anchor" href="#hexo-sliding-spoiler实现代码折叠"></a> hexo-sliding-spoiler 实现代码折叠</h2><blockquote><p>hexo-sliding-spoiler 提供 demo 演示：<a href="https://github.com/fletchto99/hexo-sliding-spoiler/blob/master/img/example.gif">https://github.com/fletchto99/hexo-sliding-spoiler/blob/master/img/example.gif</a></p></blockquote><p>安装命令</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">hexo-sliding-spoiler</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--save</span></span><span class="line"><span style="color: #6A9955"># or using yarn</span></span><span class="line"><span style="color: #DCDCAA">yarn</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">add</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">hexo-sliding-spoiler</span></span></code></pre></div></div></figure><p>使用示例</p><figure class="shiki markdown"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{% spoiler title %}</span></span><span class="line"><span style="color: #D4D4D4">content</span></span><span class="line"><span style="color: #D4D4D4">{% endspoiler %}</span></span></code></pre></div></div></figure><p>带空格的需要使用双引号</p><figure class="shiki markdown"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{% spoiler "Several spaces in the title" %}</span></span><span class="line"><span style="color: #D4D4D4">content</span></span><span class="line"><span style="color: #D4D4D4">{% endspoiler %}</span></span></code></pre></div></div></figure><p>如果没起作用，可能是 hexo 没有检测到插件，可以到<code>_config.yml</code> 中加上</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">plugins</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4"> - </span><span style="color: #CE9178">hexo-sliding-spoiler</span></span></code></pre></div></div></figure><p>使用示例</p><div class="spoiler collapsed">    <div class="spoiler-title">        title    </div>    <div class="spoiler-content">        <figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello, world!"</span><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure>    </div></div><p>直接使用的话，会发现代码块和 spoiler 区域有间距，而且标题也是默认白色，如果想要修改的话，可以找到 <code>node_modules\hexo-sliding-spoiler\assets\spoiler.css</code> 进行修改。我的修改如下：</p><figure class="shiki css"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D7BA7D">.spoiler</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#353535</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">3px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">relative</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">clear</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">both</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.spoiler</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#303030</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">15px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#d6d6d6</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-weight</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">bold</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">13px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">cursor</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">pointer</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.spoiler</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-title:before</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-weight</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">bold</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.spoiler.collapsed</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-title:before</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"Show "</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.spoiler.expanded</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-title:before</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"Hide "</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.spoiler</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-content</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-moz-transition-duration</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0.3s</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-webkit-transition-duration</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0.3s</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-o-transition-duration</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0.3s</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">transition-duration</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0.3s</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-moz-transition-timing-function</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">ease-in-out</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-webkit-transition-timing-function</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">ease-in-out</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-o-transition-timing-function</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">ease-in-out</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">transition-timing-function</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">ease-in-out</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.spoiler</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-content</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">figure</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.spoiler.collapsed</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-content</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">max-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.spoiler.expanded</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-content</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">max-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">3000px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.spoiler</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.spoiler-content</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">p:first-child</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">!important</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>但还是不太完美，自由度不是很够，也可能是我不太会修改吧。</p><h2 id="更换代码渲染器目前使用的方案"><a class="markdownIt-Anchor" href="#更换代码渲染器目前使用的方案"></a> 更换代码渲染器（目前使用的方案）</h2><p>将渲染器更换为 Hexo Shiki Plugin</p><p>该项目地址为：<a href="https://github.com/nova1751/hexo-shiki-plugin">https://github.com/nova1751/hexo-shiki-plugin</a></p><h2 id="hexo-spoiler实现文字遮盖"><a class="markdownIt-Anchor" href="#hexo-spoiler实现文字遮盖"></a> hexo-spoiler 实现文字遮盖</h2><p>hexo-sliding-spoiler 是受 hexo-spoiler 插件的启发而成的。hexo-spoiler 同样可以帮助你做到文字遮挡效果：</p><p>在线演示：<a href="http://htmlpreview.github.io/?https://github.com/unnamed42/hexo-spoiler/blob/master/example/index.html">http://htmlpreview.github.io/?https://github.com/unnamed42/hexo-spoiler/blob/master/example/index.html</a></p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411022016966.gif" alt="recording"></p><p>安装命令</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">hexo-spoiler</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--save</span></span></code></pre></div></div></figure><p>和上面的插件一样，如果没有起作用可能是配置文件得配置一下</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">plugins</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4"> - </span><span style="color: #CE9178">hexo-spoiler</span></span></code></pre></div></div></figure><p>语法</p><figure class="shiki markdown"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{% spoiler option:value text... %}</span></span></code></pre></div></div></figure><p>option:value 中的 value 为可配置选项：</p><table><thead><tr><th>Optionname 选项名</th><th> Type 类型</th><th> value 值</th><th> Effect 效果</th></tr></thead><tbody><tr><td>style</td><td> string</td><td>blur or box</td><td> 文本将被模糊处理或是被方框覆盖</td></tr><tr><td> color</td><td>string</td><td>All valid css color<br><strong>NO</strong> spaces allowed for inline option!</td><td> 仅在 style:box 时起作用；更改框的颜色。默认颜色为<code>黑色</code>。（不允许内联选项中存在空格）</td></tr><tr><td>p</td><td><code>boolean</code>(in <code>_config.yml</code> or front-matter)<br><code>string</code>(in inline options)</td><td>empty or any string</td><td> 遮盖文字将因 &lt;p&gt; 标签换行而非 &lt; span &gt; 标签。如果你想在剧透文本前后加一个新行，可以添加这个。<br>对于内联选项，分配任何值（除了 <code>“false”</code>），甚至忽略它会打开它；<code>“false”</code> 意味着关闭。默认状态为关闭。</td></tr></tbody></table><p>这表的配置项都在<code>_config.yml</code> 中进行配置，例如：</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955"># ... other configs</span></span><span class="line"><span style="color: #6A9955"># be top-level</span></span><span class="line"><span style="color: #569CD6">spoiler</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">style</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">blur</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">p</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">true</span></span></code></pre></div></div></figure><p>对于单独的一篇文章，你可以在文章的 front-matter 中设置，例如：</p><figure class="shiki markdown"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">---</span></span><span class="line"><span style="color: #569CD6">title</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">blah blah</span></span><span class="line"><span style="color: #569CD6">spoiler</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">style</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">box</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">yellow</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">p</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">false</span></span><span class="line"><span style="color: #D4D4D4">---</span></span></code></pre></div></div></figure><p>优先级：inline option 内联选项 &gt; front-matter &gt; _config.yml &gt; default</p><div class="note note-warning">            <p>warning</p><p>如果你改变了<code>_config.yml</code>，请运行 <code>hexo clean</code> 清除缓存。</p>          </div><h2 id="hexo过滤器实现代码折叠推荐"><a class="markdownIt-Anchor" href="#hexo过滤器实现代码折叠推荐"></a> Hexo 过滤器实现代码折叠（推荐）</h2><div class="note note-info">            <p>Kiyan 佬的文章启发了我，于是我自行钻研了一下。</p><ul><li><a href="https://kiyanyang.github.io/posts/c4dd4019/">使用 Hexo 过滤器实现代码折叠 By Kiyan</a></li></ul>          </div><h3 id="编写js"><a class="markdownIt-Anchor" href="#编写js"></a> 编写 js</h3><p>由于 fluid 主题已经引入了 Bootstrap，所以我们可以编写一个 js 文件来满足我们的要求。</p><p>在 <code>scripts</code> 目录下创建 <code>codeFloding.js</code>：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 获取唯一 ID</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getUuid</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 生成一个随机的唯一标识符，由当前时间戳和随机数拼接而成</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Math</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">random</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">toString</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">36</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">substring</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">8</span><span style="color: #D4D4D4">) + </span><span style="color: #9CDCFE">Date</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">now</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">toString</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">36</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 注册 Hexo 的过滤器，在文章渲染后处理代码块</span></span><span class="line"><span style="color: #9CDCFE">hexo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">extend</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">filter</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">register</span><span style="color: #D4D4D4">(</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #CE9178">"after_post_render"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  (</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取代码高亮设置</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">line_number</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">lib</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">hexo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">theme</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">highlight</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 根据使用的高亮库设置正则表达式</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">lib</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">"highlightjs"</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">line_number</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4"> = </span><span style="color: #D16969">/</span><span style="color: #CE9178">(</span><span style="color: #D16969">&lt;figure class="highlight.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">&gt;</span><span style="color: #CE9178">)(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">hljs </span><span style="color: #CE9178">(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">*?</span><span style="color: #CE9178">)</span><span style="color: #D16969">".</span><span style="color: #D7BA7D">+?</span><span style="color: #CE9178">)(</span><span style="color: #D16969">&lt;</span><span style="color: #D7BA7D">\/</span><span style="color: #D16969">figure&gt;</span><span style="color: #CE9178">)</span><span style="color: #D16969">/</span><span style="color: #569CD6">gims</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 处理包含行号的 figure</span></span><span class="line"><span style="color: #D4D4D4">      } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4"> = </span><span style="color: #D16969">/</span><span style="color: #CE9178">(</span><span style="color: #D16969">&lt;div class="code-wrapper.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">&gt;</span><span style="color: #CE9178">)(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">hljs </span><span style="color: #CE9178">(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">*?</span><span style="color: #CE9178">)</span><span style="color: #D16969">".</span><span style="color: #D7BA7D">+?</span><span style="color: #CE9178">)(</span><span style="color: #D16969">&lt;</span><span style="color: #D7BA7D">\/</span><span style="color: #D16969">div&gt;</span><span style="color: #CE9178">)</span><span style="color: #D16969">/</span><span style="color: #569CD6">gims</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 处理不包含行号的 div</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">lib</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">"prismjs"</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4"> = </span><span style="color: #D16969">/</span><span style="color: #CE9178">(</span><span style="color: #D16969">&lt;div class="code-wrapper.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">&gt;</span><span style="color: #CE9178">)(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">data-language="</span><span style="color: #CE9178">(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">*?</span><span style="color: #CE9178">)</span><span style="color: #D16969">".</span><span style="color: #D7BA7D">+?</span><span style="color: #CE9178">)(</span><span style="color: #D16969">&lt;</span><span style="color: #D7BA7D">\/</span><span style="color: #D16969">div&gt;</span><span style="color: #CE9178">)</span><span style="color: #D16969">/</span><span style="color: #569CD6">gims</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 处理 PrismJS 的代码块</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// match begin inner lang end offset string 分别表示的意思是：匹配到的内容的开始、内容、语言、结束、偏移量、原始字符串</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">replace</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4">, (</span><span style="color: #9CDCFE">match</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">begin</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">inner</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">end</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">offset</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">string</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseId</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`collapse-</span><span style="color: #569CD6">${</span><span style="color: #DCDCAA">getUuid</span><span style="color: #D4D4D4">()</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 生成唯一的折叠 ID</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 创建一个容器，用于包裹按钮和语言提示</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseContainer</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`</span></span><span class="line"><span style="color: #CE9178">        &lt;div class="collapse-header"&gt;</span></span><span class="line"><span style="color: #CE9178">          &lt;button class="collapse-btn collapsed" type="button" data-toggle="collapse" data-target="#</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">collapseId</span><span style="color: #569CD6">}</span><span style="color: #CE9178">"&gt;</span></span><span class="line"><span style="color: #CE9178">            &lt;svg t="1730562455310" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9905"&gt;</span></span><span class="line"><span style="color: #CE9178">              &lt;path d="M857.766234 511.488511L345.623017 0 297.174825 49.348412 759.846873 511.488511 297.174825 974.651588 345.623017 1022.977023z" fill="#ffffff" p-id="9906"&gt;</span></span><span class="line"><span style="color: #CE9178">              &lt;/path&gt;</span></span><span class="line"><span style="color: #CE9178">            &lt;/svg&gt;</span></span><span class="line"><span style="color: #CE9178">          &lt;/button&gt;</span></span><span class="line"><span style="color: #CE9178">          &lt;span&gt;</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">lang</span><span style="color: #569CD6">}</span><span style="color: #CE9178">&lt;/span&gt; &lt;!-- 显示代码语言 --&gt;</span></span><span class="line"><span style="color: #CE9178">        &lt;/div&gt;</span></span><span class="line"><span style="color: #CE9178">      `</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// collapse表示默认收起，collapse show表示默认展开</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseDiv</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`&lt;div class="collapse" id="</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">collapseId</span><span style="color: #569CD6">}</span><span style="color: #CE9178">"&gt;</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">inner</span><span style="color: #569CD6">}</span><span style="color: #CE9178">&lt;/div&gt;`</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">begin</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">collapseContainer</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">collapseDiv</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">end</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 返回修改后的内容</span></span><span class="line"><span style="color: #D4D4D4">    });</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 返回处理后的数据</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #B5CEA8">10000</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 设置优先级，使得在其他渲染后执行</span></span><span class="line"><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><p>这份代码的核心在于 <code>&lt;button class="collapse-btn collapsed"&gt;</code> 中的属性：</p><figure class="shiki javascript"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">-</span><span style="color: #9CDCFE">toggle</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"collapse"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">-</span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#${collapseId}"</span></span></code></pre></div></div></figure><p>为什么这么说呢？</p><p>当使用 <code>data-toggle="collapse"</code> 和 <code>data-target</code> 属性时，Bootstrap 的 JavaScript 会自动识别这些属性并处理折叠效果。这意味着我们<strong>不需要手动编写</strong>任何其他 JavaScript 代码来控制折叠内容的显示和隐藏。</p><p>处理过程是：</p><ol><li>当收起或展开按钮被点击时，Bootstrap 先查找与 <code>data-target</code> 属性对应的元素（这里是被加上了 <code>id="${collapseId}"</code> 的 <code>collapseDiv</code>）。</li><li>根据当前状态，Bootstrap 会往查找到的带 <code>data-target</code> 值（这里是 <code>collapseId</code>）的标签中添加或移除 <code>show</code> 类，从而控制折叠内容的显示或隐藏。<br>人话是：Bootstrap 会自动给 <code>const collapseDiv</code> 加上 <code>show</code> 类或移除来控制展开还是收起。<code>collapseDiv</code> 这里是代码块。</li><li>同时给按钮更新 <code>aria-expanded</code> 属性，以反映当前状态（值为 true 即展开反之则收起）。</li><li>同时给按钮增加 <code>collapsed</code> 类来标识收起状态，若无此类则表示展开。</li></ol><p>所以，这里有两个值的设定需要注意：</p><ol><li><code>const collapseDiv</code> 的 <code>class="collapse"</code>：<br>若类名为 <code>class="collapse"</code> 表示默认将代码块收起，<code>collapse show</code> 表示默认展开。</li><li><code>const collapseDiv</code> 的类名若为不带 show 的类名表示默认收起，则 <code>&lt;button class="collapse-btn collapsed"</code> 中的类名 <code>class="collapse-btn"</code> 需要加上 <code>collapsed</code>。<br>即：<code>class="collapse-btn collapsed"</code> 与 <code>collapseDiv</code> 收起或展开的状态保持一致。</li></ol><p>例如，我的代码默认行为是将代码块收起，所以要设置 <code>const collapseDiv</code> 为：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseDiv</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`&lt;div class="collapse" id="</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">collapseId</span><span style="color: #569CD6">}</span><span style="color: #CE9178">"&gt;</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">inner</span><span style="color: #569CD6">}</span><span style="color: #CE9178">&lt;/div&gt;`</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p><strong>且</strong>按钮 button 应设置为：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"collapse-btn collapsed"</span><span style="color: #D4D4D4"> </span><span style="color: #F44747">...略...</span></span></code></pre></div></div></figure><p>另外，你也可以找一个你喜欢的 svg 图用于设置按钮的图标。</p><blockquote><p>相关推荐：<a href="https://www.iconfont.cn/">阿里巴巴矢量图库</a></p></blockquote><h3 id="编写css"><a class="markdownIt-Anchor" href="#编写css"></a> 编写 css</h3><p>在 <code>source\css\</code> 目录下创建 <code>codeFloding.css</code>：</p><figure class="shiki css"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D7BA7D">.collapse-header</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 设置圆角，使背景更柔和 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">relative</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 使按钮可以定位 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">z-index</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#303030</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 设置背景颜色为深灰色 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 添加上下左右各5px的内边距 */</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.collapse-header</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">span</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">white</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.collapse-header</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">button</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 去掉按钮的边框 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 按钮与语言文本之间的间隔 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#303030</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 按钮背景与容器背景相同 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">cursor</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">pointer</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 鼠标悬停时显示为手指光标，表示可点击 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">transition</span><span style="color: #D4D4D4">: transform </span><span style="color: #B5CEA8">0.3s</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">ease</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 添加平滑的旋转过渡效果 */</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.collapse-header</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">button:focus</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">outline</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 去掉按钮的聚焦样式，保持界面简洁 */</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.collapse-header</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">button</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">svg</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">fill</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">white</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">transition</span><span style="color: #D4D4D4">: transform </span><span style="color: #B5CEA8">0.3s</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">ease</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 添加过渡效果 */</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">/* 初始状态：箭头向右，为收起状态 */</span></span><span class="line"><span style="color: #D7BA7D">.collapse-header</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.collapse-btn.collapsed</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">rotate</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0deg</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #6A9955">/* 点击按钮后，箭头向下，为展开状态 */</span></span><span class="line"><span style="color: #D7BA7D">.collapse-header</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.collapse-btn</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">rotate</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">90deg</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">/* 为展开的内容区域添加底部连接效果 */</span></span><span class="line"><span style="color: #D7BA7D">.collapse.show</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#303030</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.category-collapse.collapse.show</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">/* 将背景色设置为透明，使内容区域背景透明 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">transparent</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>有兴趣可以自行修改 css 样式使其符合你的审美。</p><div class="note note-warning">            <p>warning</p><p>请注意在<code>_config.fluid.yml</code> 中进行引入</p>          </div><h3 id="一个可选的配置"><a class="markdownIt-Anchor" href="#一个可选的配置"></a> 一个可选的配置</h3><p>因为我默认开启了代码块的语言类型显示，所以在代码的右上角会自动显示代码语言，如果点击按钮将代码展开，则会在 header 上出现两个代码语言文字，一左一右不是很美观。</p><p>于是我创建了 <code>source\js\watch.js</code></p><div class="note note-info">            <p><s>前情提要</s></p><p><code>watch.js</code> 是以前写的，你也可以找一个已经写过的 js 文件，在底部写，或是单独创建一个 js 文件用于编写。</p>          </div><p>为了解决上面的重复问题，编写 js 代码如下：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 给代码收起按钮添加监听事件</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseBtns</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelectorAll</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'.collapse-header button'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">collapseBtns</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">button</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">button</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'click'</span><span style="color: #D4D4D4">, () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取当前按钮的类名</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">btnClassName</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">button</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 使用 button 变量，而不是 collapseBtns</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">codeTypeSpan</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">button</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">nextElementSibling</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 获取当前按钮后面的 span 标签</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log('当前获取到的按钮类名为：', btnClassName);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log('当前获取到的 span 标签为：', codeTypeSpan);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log('当前检测展开状态：', btnClassName.includes('collapsed'));</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">btnClassName</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">includes</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'collapsed'</span><span style="color: #D4D4D4">)) { </span><span style="color: #6A9955">// 判断按钮是否在展开状态</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 展开之后将 span 标签设为隐藏</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">codeTypeSpan</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'none'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 收起之后将 span 标签设为显示</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">codeTypeSpan</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'inline-block'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  });</span></span><span class="line"><span style="color: #D4D4D4">});</span></span></code></pre></div></div></figure><p>这样一来，点击按钮展开之后，header 的代码语言提示问题将会被设为隐藏（并非卸载）。</p><h3 id="一个可选配置的优化"><a class="markdownIt-Anchor" href="#一个可选配置的优化"></a> 一个可选配置的优化</h3><p>为什么说是优化呢？因为实际使用下来，我发现每次都要手动使用鼠标点击那么小的一个按钮实在过于折磨，不如直接点击 header 实现折叠或展开。修改就不多说了，如果你能看懂上面的配置，那么下面的配置也能，因为我只做了小小的修改。</p><p><code>codeFloding.js</code>：将 <code>data-toggle</code> 和 <code>data-target</code> 换到 header 上，并在 watch.js 中手动切换 button 的 class 类名</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 获取唯一 ID</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getUuid</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Math</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">random</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">toString</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">36</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">substring</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">8</span><span style="color: #D4D4D4">) + </span><span style="color: #9CDCFE">Date</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">now</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">toString</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">36</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 注册 Hexo 的过滤器，在文章渲染后处理代码块</span></span><span class="line"><span style="color: #9CDCFE">hexo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">extend</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">filter</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">register</span><span style="color: #D4D4D4">(</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #CE9178">"after_post_render"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  (</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">line_number</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">lib</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">hexo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">theme</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">highlight</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">lib</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">"highlightjs"</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">line_number</span><span style="color: #D4D4D4"> </span></span><span class="line"><span style="color: #D4D4D4">        ? </span><span style="color: #D16969">/</span><span style="color: #CE9178">(</span><span style="color: #D16969">&lt;figure class="highlight.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">&gt;</span><span style="color: #CE9178">)(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">hljs </span><span style="color: #CE9178">(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">*?</span><span style="color: #CE9178">)</span><span style="color: #D16969">".</span><span style="color: #D7BA7D">+?</span><span style="color: #CE9178">)(</span><span style="color: #D16969">&lt;</span><span style="color: #D7BA7D">\/</span><span style="color: #D16969">figure&gt;</span><span style="color: #CE9178">)</span><span style="color: #D16969">/</span><span style="color: #569CD6">gims</span><span style="color: #D4D4D4"> </span></span><span class="line"><span style="color: #D4D4D4">        : </span><span style="color: #D16969">/</span><span style="color: #CE9178">(</span><span style="color: #D16969">&lt;div class="code-wrapper.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">&gt;</span><span style="color: #CE9178">)(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">hljs </span><span style="color: #CE9178">(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">*?</span><span style="color: #CE9178">)</span><span style="color: #D16969">".</span><span style="color: #D7BA7D">+?</span><span style="color: #CE9178">)(</span><span style="color: #D16969">&lt;</span><span style="color: #D7BA7D">\/</span><span style="color: #D16969">div&gt;</span><span style="color: #CE9178">)</span><span style="color: #D16969">/</span><span style="color: #569CD6">gims</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">lib</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">"prismjs"</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4"> = </span><span style="color: #D16969">/</span><span style="color: #CE9178">(</span><span style="color: #D16969">&lt;div class="code-wrapper.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">&gt;</span><span style="color: #CE9178">)(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">+?</span><span style="color: #D16969">data-language="</span><span style="color: #CE9178">(</span><span style="color: #D16969">.</span><span style="color: #D7BA7D">*?</span><span style="color: #CE9178">)</span><span style="color: #D16969">".</span><span style="color: #D7BA7D">+?</span><span style="color: #CE9178">)(</span><span style="color: #D16969">&lt;</span><span style="color: #D7BA7D">\/</span><span style="color: #D16969">div&gt;</span><span style="color: #CE9178">)</span><span style="color: #D16969">/</span><span style="color: #569CD6">gims</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">replace</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">reg</span><span style="color: #D4D4D4">, (</span><span style="color: #9CDCFE">match</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">begin</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">inner</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">end</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseId</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`collapse-</span><span style="color: #569CD6">${</span><span style="color: #DCDCAA">getUuid</span><span style="color: #D4D4D4">()</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseContainer</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`</span></span><span class="line"><span style="color: #CE9178">        &lt;div class="collapse-header" data-toggle="collapse" data-target="#</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">collapseId</span><span style="color: #569CD6">}</span><span style="color: #CE9178">"&gt;</span></span><span class="line"><span style="color: #CE9178">          &lt;button class="collapse-btn collapsed" type="button"&gt;</span></span><span class="line"><span style="color: #CE9178">            &lt;svg t="1730562455310" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9905"&gt;</span></span><span class="line"><span style="color: #CE9178">              &lt;path d="M857.766234 511.488511L345.623017 0 297.174825 49.348412 759.846873 511.488511 297.174825 974.651588 345.623017 1022.977023z" fill="#ffffff" p-id="9906"&gt;&lt;/path&gt;</span></span><span class="line"><span style="color: #CE9178">            &lt;/svg&gt;</span></span><span class="line"><span style="color: #CE9178">          &lt;/button&gt;</span></span><span class="line"><span style="color: #CE9178">          &lt;span&gt;</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">lang</span><span style="color: #569CD6">}</span><span style="color: #CE9178">&lt;/span&gt;</span></span><span class="line"><span style="color: #CE9178">        &lt;/div&gt;</span></span><span class="line"><span style="color: #CE9178">      `</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseDiv</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`&lt;div class="collapse" id="</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">collapseId</span><span style="color: #569CD6">}</span><span style="color: #CE9178">"&gt;</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">inner</span><span style="color: #569CD6">}</span><span style="color: #CE9178">&lt;/div&gt;`</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">begin</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">collapseContainer</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">collapseDiv</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">end</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    });</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #B5CEA8">10000</span></span><span class="line"><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><p><code>codeFloding.css</code>：增加了鼠标悬停在 header 时，将鼠标样式改为 pointer 提示用户</p><figure class="shiki css"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D7BA7D">.collapse-header</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 设置圆角，使背景更柔和 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">relative</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 使按钮可以定位 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">z-index</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#303030</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 设置背景颜色为深灰色 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 添加上下左右各5px的内边距 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">cursor</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">pointer</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 鼠标悬停时显示为手指光标 */</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D4D4D4">..</span><span style="color: #D7BA7D">.略</span><span style="color: #D4D4D4">...</span></span></code></pre></div></div></figure><p><code>watch.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">/**</span></span><span class="line"><span style="color: #6A9955"> * 给代码收起按钮和整个 header 添加监听事件</span></span><span class="line"><span style="color: #6A9955"> */</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">collapseHeaders</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelectorAll</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'.collapse-header'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">collapseHeaders</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">header</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">button</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">header</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'button'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">codeTypeSpan</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">header</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'span'</span><span style="color: #D4D4D4">);</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">header</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'click'</span><span style="color: #D4D4D4">, () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'header clicked'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 手动切换按钮的类名</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">button</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">classList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">toggle</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'collapsed'</span><span style="color: #D4D4D4">);</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 根据按钮状态显示或隐藏 span</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">button</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">classList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">contains</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'collapsed'</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log('收起代码块');</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">codeTypeSpan</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'inline-block'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log('展开代码块');</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">codeTypeSpan</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'none'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  });</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">button</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'click'</span><span style="color: #D4D4D4">, (</span><span style="color: #9CDCFE">event</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 阻止事件冒泡，避免触发 header 的点击事件</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">event</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">stopPropagation</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">  });</span></span><span class="line"><span style="color: #D4D4D4">});</span></span></code></pre></div></div></figure><div class="note note-info">            <p>以上内容若有侵权，可联系删除</p>          </div><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>美化</tag>
      
      <tag>Hexo</tag>
      
      <tag>Fluid</tag>
      
      <tag>Bootstrap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用 CSS 和 JS 实现博客导航栏线条动画效果</title>
    <link href="/archives/Hexo/38001.html"/>
    <url>/archives/Hexo/38001.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="使用CSS和JS给博客导航栏加上线条动画/路径动画效果。"><h1 id="使用css和js实现博客导航栏线条动画效果"><a class="markdownIt-Anchor" href="#使用css和js实现博客导航栏线条动画效果"></a> 使用 CSS 和 JS 实现博客导航栏线条动画效果</h1><h2 id="制作svg"><a class="markdownIt-Anchor" href="#制作svg"></a> 制作 SVG</h2><p>说白了线条动画 / 路径动画就是通过 SVG 的 path 属性（<a href="https://www.runoob.com/svg/svg-intro.html">什么是 SVG？</a>）来实现的。所以首先我们得准备好一个能用的 SVG 图。</p><h3 id="方法一"><a class="markdownIt-Anchor" href="#方法一"></a> 方法一</h3><p>你可以使用 Adobe 的 adobe illustrator 来徒手绘制 svg 图。</p><p>怎么操作呢，就是创建好画布之后直接使用铅笔 / 钢笔 / 画笔等工具进行一个手画。</p><p>例如使用铅笔工具：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411020452346.png" alt="image-20241102045227167"></p><p>左边能看到路径锚点，右边能看到各个图层。</p><p>紧接着将其导出为 svg：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411020454590.png" alt="image-20241102045454543"></p><p>你可以在这提前查看。</p><p>导出后的 svg 大致是：</p><figure class="shiki xml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">svg</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">xmlns</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"http://www.w3.org/2000/svg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">viewBox</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"0 0 232.798 65.792"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">defs</span><span style="color: #808080">&gt;&lt;</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">.a{fill:none;stroke:#000;stroke-miterlimit:10;}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">defs</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">title</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">未标题-1</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">title</span><span style="color: #808080">&gt;&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"a"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M166.57,148.587c-7.072.465-13.436,4.25-19.491,7.933-3.19,1.941-6.427,3.92-8.947,6.676-2.646,2.9-4.364,6.5-6.044,10.041-2.088,4.406-4.207,9.467-2.374,13.985a16.6,16.6,0,0,0,3.792,5.134,131.478,131.478,0,0,0,11.071,10.113,10.374,10.374,0,0,0,4.293,2.435,10.787,10.787,0,0,0,4.654-.435l18.454-4.506a.6.6,0,0,0-.954-.537"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-128.515 -144.528)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"a"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M185.9,171.121a4.907,4.907,0,0,1,3.356,3.268"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-128.515 -144.528)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"a"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M184.46,189.411a72.961,72.961,0,0,1,2.635,20.9"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-128.515 -144.528)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"a"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M224.639,195.225a13.226,13.226,0,0,0-2.332-4.606,4.5,4.5,0,0,0-4.659-1.511,6.49,6.49,0,0,0-1.927,1.276q-3.384,2.889-6.612,5.953c-1.78,1.689-3.616,4.431-2.06,6.329a5.055,5.055,0,0,0,3.076,1.384,15.353,15.353,0,0,0,5.2.412,5.2,5.2,0,0,0,4.119-2.853c.621-1.5.234-3.2.241-4.829a9.808,9.808,0,0,1,1.229-4.7c.318,2.958.662,6,2.08,8.618s4.193,4.726,7.154,4.442"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-128.515 -144.528)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"a"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M264.978,149.682q-5.542,20.928-9.175,42.3a5.173,5.173,0,0,0,.306,3.722,4.7,4.7,0,0,0,2.181,1.548,25.766,25.766,0,0,0,8.293,2.02"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-128.515 -144.528)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"a"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M301.091,144.6c-1.35,8.821-2.7,17.644-3.829,26.5-.958,7.52-1.743,15.268.208,22.594.763,2.864,2.659,6.114,5.619,5.968"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-128.515 -144.528)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"a"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M355.807,194.125c2.7-2.028,4.855-5.064,5-8.441.477-11.264-19.128-16.029-23.575-5.714-1.68,3.9-.743,11.83,1.3,15.42C342.345,202.118,350.785,197.892,355.807,194.125Z"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-128.515 -144.528)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">svg</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>其中 <code>&lt;defs&gt;&lt;style&gt;.a{fill:none;stroke:#000;stroke-miterlimit:10;}&lt;/style&gt;&lt;/defs&gt;</code> 是非必须的，<code>viewBox</code>、<code>xmlns</code> 和 <code>path</code> 等节点是必须的。</p><p>我们这种效果最关心的是 <code>path</code> 节点。</p><h3 id="方法二"><a class="markdownIt-Anchor" href="#方法二"></a> 方法二</h3><p>你也可以使用 adobe illustrator 的文字工具指定字体，来生成好看的字体效果，例如：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411020501894.png" alt="image-20241102050103841"></p><p>这个时候你只需要用选择工具，框选文字转换轮廓就可以得到复杂路径图层：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411020502168.png" alt="image-20241102050239120"></p><p>创建之后，按住 ctrl 键，你会发现文字上就出现了许多路径锚点：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411020503277.png" alt="image-20241102050353227"></p><p>图层中也自动有了每个字母的复合路径：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411020504918.png" alt="image-20241102050435882"></p><p>可以和方法一一样直接导出了。</p><figure class="shiki xml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">svg</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">xmlns</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"http://www.w3.org/2000/svg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">viewBox</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"0 0 203 74.13"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">title</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">未标题-1</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">title</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M259.914,163.879c1.1-.439,16.567-6.8,17-16.9,0-.109,1.537-6.144-12.835-6.693-26.661-.987-52,20.956-52.662,41.362,0,1.536-2.634,24.027,22.82,24.905S281.2,189.881,281.2,189.881s.987-.878,1.536.219c0,.11.22,2.085-3.511,5.266-1.206,1.1-21.722,15.909-43.556,15.031-16.456-.658-29.4-9-28.635-28.855.769-22.491,28.526-46.3,56.832-45.2,1.1,0,17.225.22,17.334,10.422.11,10.094-15.8,18.981-17.225,19.749-1.426.878-5.375,2.413-6.472.109C256.513,164.647,257.72,164.647,259.914,163.879Z"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-207 -136.305)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M294.358,202.717c-8.557.11-9.435-10.094-9.216-12.069.22-2.413,1.1-7.35,1.1-7.35.768-1.975,4.168-1.756,4.168.219,0,.549-4.168,16.018,4.389,15.579,5.815-.22,11.3-10.093,13.824-14.7.987-1.865,2.523.658.329,5.046C308.182,190.978,302.147,202.717,294.358,202.717Zm-3.291-27.537a2.882,2.882,0,0,1-3.292,2.413,2.787,2.787,0,0,1-2.413-3.182c0-.987,1.1-3.73,3.4-3.4C291.177,171.339,291.286,173.643,291.067,175.18Z"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-207 -136.305)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M327.82,202.278c-6.584.109-7.571-6.582-7.571-6.582s-3.95,7.24-7.79,7.131c-2.084,0-7.35-1.865-6.033-12.179s8.228-14.921,11.739-14.81c6.363.218,5.815,5.7,5.7,6.253-.877,2.853-1.974,2.084-2.742,1.755,0,0,.658-4.608-3.072-4.717-3.181-.11-6.363,4.717-7.46,9.654-1.207,5.047-.439,10.2,2.193,10.2,4.06,0,7.461-10.972,7.9-13.714.218-1.1,4.278-.22,4.058,1.535-.109,0-4.058,11.739,3.292,11.739,3.292,0,7.57-3.4,13.383-14.043.989-1.755,2.526.769.221,5.048C339.779,193.063,334.292,202.169,327.82,202.278Z"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-207 -136.305)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M361.938,184.615c1.1-1.756,2.523.767.218,5.046-.768,1.536-6.582,13.6-17.223,13.056-12.947-.659-13.275-15.031-13.166-27.1.108-10.642,6.472-32.365,14.92-31.817,5.376.329,7.352,6.912,5.7,17.664-2.084,14.591-10.642,28.964-14.153,33.024,1.976,3.071,4.718,4.936,7.9,4.936C354.148,199.425,359.414,189.223,361.938,184.615Zm-15.36-36.754c-4.17-.329-10.093,13.165-11.519,27.977-.331,4.5.327,12.068,1.754,16.017,5.7-8.228,7.462-12.507,11.411-28.086C348.992,160.917,350.747,148.08,346.578,147.861Z"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-207 -136.305)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M382.561,184.615c1.1-1.756,2.524.767.219,5.046-.768,1.536-6.582,13.6-17.223,13.056-12.948-.659-13.275-15.031-13.166-27.1.108-10.642,6.472-32.365,14.92-31.817,5.376.329,7.352,6.912,5.705,17.664-2.084,14.591-10.643,28.964-14.153,33.024,1.976,3.071,4.718,4.936,7.9,4.936C374.771,199.425,380.038,189.223,382.561,184.615ZM367.2,147.861c-4.171-.329-10.093,13.165-11.519,27.977-.331,4.5.327,12.068,1.753,16.017,5.706-8.228,7.463-12.507,11.411-28.086C369.616,160.917,371.371,148.08,367.2,147.861Z"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-207 -136.305)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M408.451,184.615c.769-1.427,2.085,0,1.316,2.742-1.206,3.621-5.7,8.557-13.933,6.693-1.536,4.937-4.826,9.435-10.311,9.106-5.268-.329-6.7-6.473-6.364-10.423s2.522-12.4,6.143-12.946a5.006,5.006,0,0,1,4.937-4.169c2.853-.22,7.459,3.291,6.693,12.836a12.294,12.294,0,0,1-.219,1.975c3.619,1.426,8.117.988,10.641-3.95Zm-21.943,15.359c2.744.219,5.158-3.62,6.145-7.022a14.8,14.8,0,0,1-6.583-7.789c-1.207.878-3.073,5.7-3.181,7.9C382.778,195.476,382.889,199.755,386.508,199.974Zm4.06-20.626c-1.865.11-2.084,2.743-1.426,4.609a9.361,9.361,0,0,0,4.169,4.936C393.421,184.944,393.2,179.129,390.568,179.348Z"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"translate(-207 -136.305)"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">svg</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h3 id="方法三"><a class="markdownIt-Anchor" href="#方法三"></a> 方法三</h3><p>借助在线网站：<a href="https://danmarshall.github.io/google-font-to-svg-path/">Google Font to Svg Path</a> 完成 Svg 的生成。</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411020507918.png" alt="image-20241102050728816"></p><p>该网站提供<a href="https://fonts.google.com/">谷歌字体</a>供选择，也支持自己上传字体，使用起来是很方便的。</p><p>其中：</p><ul><li>variant：表示你选择的字体的风格 —— 正常还是斜体</li><li> text：输入你要生成 svg 的语句或单词</li><li> union：这个影响 svg 路径，是否要将字母看作整体</li><li> kerning：字距</li><li> separate characters：字符是否分离</li><li> bezier accuracy：跟字体像素有关</li><li> Dxf Units：尺寸单位</li><li> Fill：填充颜色</li><li> Stroke：线条颜色</li><li> Stroke Width：线条宽度</li><li> Non-scaling stroke：是否可缩放</li><li> Fill rule：填充的规则</li></ul><p>参数的变动会实时的更新在下方的 svg 元数据框中。</p><h2 id="编写js"><a class="markdownIt-Anchor" href="#编写js"></a> 编写 js</h2><p>有了上述方法，可以得到 svg 图。这里简单说说我的方案：</p><ul><li>字体：Signerica_Medium</li><li>Google Font to Svg Path：仅 Union 勾选，Size 为 100。其余默认</li><li>待生成文字为：CiaoHello</li></ul><p>svg 数据如下：</p><figure class="shiki xml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">svg</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"svg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">viewBox</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"0 0 682.2 98.507"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">xmlns</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"http://www.w3.org/2000/svg"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"p"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">d</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"M 330.25 81.307 L 330.25 81.257 A 141.437 141.437 0 0 1 326.031 83.57 A 164.324 164.324 0 0 1 324.275 84.482 A 1838.902 1838.902 0 0 1 321.006 86.151 A 2167.951 2167.951 0 0 1 317.55 87.907 Q 316.25 88.607 314.8 89.357 Q 313.35 90.107 311.9 90.807 A 9.955 9.955 0 0 1 311.856 90.937 Q 311.8 91.097 311.764 91.177 A 0.786 0.786 0 0 1 311.75 91.207 A 52.636 52.636 0 0 0 311.505 91.756 Q 311.378 92.044 311.24 92.365 A 86.334 86.334 0 0 0 311.2 92.457 Q 310.9 93.157 310.65 93.757 Q 310.55 93.907 310.5 94.082 Q 310.452 94.249 310.405 94.348 A 0.778 0.778 0 0 1 310.4 94.357 L 310.35 94.407 A 458.367 458.367 0 0 0 309.631 95.67 A 508.259 508.259 0 0 0 309.525 95.857 A 6.305 6.305 0 0 1 308.886 96.775 A 7.807 7.807 0 0 1 308.4 97.307 A 3.173 3.173 0 0 1 307.994 97.652 A 2.827 2.827 0 0 1 307.875 97.732 Q 307.69 97.85 307.404 97.956 A 5.022 5.022 0 0 1 307.1 98.057 L 307.15 98.057 Q 306.85 98.157 306.475 98.107 A 3.624 3.624 0 0 1 306.211 98.063 Q 306.083 98.036 305.974 98.001 A 1.773 1.773 0 0 1 305.85 97.957 L 305.45 97.807 Q 305.05 97.707 304.6 97.457 Q 304.15 97.207 303.75 96.957 L 303.8 97.007 Q 303.5 96.807 303.225 96.582 Q 302.95 96.357 302.75 95.957 L 302.75 96.007 Q 302.218 95.137 302.481 94.22 A 2.459 2.459 0 0 1 302.5 94.157 A 5.384 5.384 0 0 1 302.794 93.516 A 4.192 4.192 0 0 1 303.1 93.032 Q 303.45 92.557 303.9 92.157 Q 305.1 91.157 306.45 90.357 Q 307.8 89.557 309.15 88.857 Q 309.188 88.781 309.227 88.675 A 2.84 2.84 0 0 0 309.25 88.607 Q 309.288 88.492 309.327 88.407 A 1.283 1.283 0 0 1 309.35 88.357 L 309.35 88.407 A 194.51 194.51 0 0 0 311.194 82.583 A 163.701 163.701 0 0 0 312.15 79.257 A 330.428 330.428 0 0 0 313.838 72.901 A 293.46 293.46 0 0 0 314.35 70.857 Q 316.25 63.257 317.65 56.657 A 25993.087 25993.087 0 0 1 318.644 51.974 Q 319.034 50.134 319.386 48.48 A 13317.859 13317.859 0 0 1 320.05 45.357 A 10677.833 10677.833 0 0 0 320.72 42.051 Q 321.681 37.307 322.375 33.857 A 16568.827 16568.827 0 0 0 322.805 31.72 Q 323.337 29.07 323.633 27.59 A 1955.876 1955.876 0 0 0 323.7 27.257 A 27.474 27.474 0 0 0 323.802 26.76 Q 323.85 26.516 323.886 26.303 A 13.234 13.234 0 0 0 323.925 26.057 A 6.697 6.697 0 0 1 323.969 25.796 Q 324.028 25.487 324.1 25.307 L 324.05 25.357 A 11.651 11.651 0 0 1 324.529 23.543 A 10.594 10.594 0 0 1 324.625 23.282 A 9.302 9.302 0 0 1 324.972 22.486 Q 325.208 22.012 325.475 21.632 A 5.485 5.485 0 0 1 325.85 21.154 Q 326.053 20.925 326.261 20.752 A 2.875 2.875 0 0 1 326.45 20.607 A 1.792 1.792 0 0 1 326.725 20.447 Q 327.075 20.285 327.4 20.357 A 1.375 1.375 0 0 1 328.117 20.773 Q 328.288 20.952 328.431 21.203 A 3.073 3.073 0 0 1 328.525 21.382 A 3.938 3.938 0 0 1 328.83 22.296 Q 328.95 22.867 328.95 23.557 A 12.397 12.397 0 0 1 328.901 24.646 A 13.989 13.989 0 0 1 328.875 24.907 A 11.409 11.409 0 0 1 328.652 26.247 A 10.071 10.071 0 0 1 328.65 26.257 Q 328.55 26.807 328.375 27.457 A 20.539 20.539 0 0 0 328.283 27.813 Q 328.138 28.395 327.95 29.257 A 293.439 293.439 0 0 1 327.756 30.109 Q 327.438 31.501 326.95 33.582 Q 326.452 35.707 325.691 38.989 A 5698.106 5698.106 0 0 0 325.2 41.107 A 18.926 18.926 0 0 0 324.989 41.96 A 21.093 21.093 0 0 0 324.925 42.257 A 58.009 58.009 0 0 1 324.723 43.185 A 65.811 65.811 0 0 1 324.65 43.507 Q 324.263 45.183 323.766 47.283 A 986.243 986.243 0 0 1 323.6 47.982 Q 323 50.507 322.3 53.432 A 1349.276 1349.276 0 0 1 321.208 57.96 A 1526.635 1526.635 0 0 1 320.825 59.532 Q 320.05 62.707 319.25 65.957 A 703.289 703.289 0 0 1 318.094 70.363 A 867.991 867.991 0 0 1 316.825 75.082 A 244.707 244.707 0 0 1 315.394 80.126 A 302.493 302.493 0 0 1 313.75 85.507 L 313.55 86.107 L 313.35 86.707 Q 313.95 86.457 314.525 86.157 A 23.722 23.722 0 0 1 315.373 85.735 A 21.319 21.319 0 0 1 315.65 85.607 Q 317.25 84.857 318.775 84.057 Q 320.3 83.257 321.75 82.507 Q 324.45 81.157 326.8 79.907 Q 329.15 78.657 331.4 77.357 Q 335.8 74.857 339.4 72.482 Q 343 70.107 346 67.857 A 105.499 105.499 0 0 0 349.555 65.111 Q 351.198 63.781 352.603 62.517 A 62.908 62.908 0 0 0 353 62.157 Q 355.95 59.457 358.3 56.907 Q 358.5 56.407 358.65 55.932 Q 358.8 55.457 359 54.907 Q 359.25 54.057 359.525 53.232 Q 359.8 52.407 360.1 51.557 Q 361.55 47.457 363.2 42.782 Q 364.85 38.107 366.6 33.507 A 123.169 123.169 0 0 1 367.863 30.238 A 144.882 144.882 0 0 1 368.5 28.682 Q 369.55 26.157 370.65 23.757 Q 370.95 23.107 371.25 22.482 A 30.489 30.489 0 0 1 371.813 21.369 A 33.498 33.498 0 0 1 371.9 21.207 A 6.365 6.365 0 0 1 372.16 20.736 A 5.289 5.289 0 0 1 372.325 20.482 Q 372.55 20.157 372.9 19.657 Q 373 19.507 373.075 19.382 Q 373.15 19.257 373.4 19.007 A 1.868 1.868 0 0 1 373.767 18.627 A 2.488 2.488 0 0 1 374.1 18.407 L 374.2 18.407 A 1.759 1.759 0 0 0 374.24 18.386 Q 374.295 18.358 374.317 18.339 A 0.103 0.103 0 0 0 374.325 18.332 Q 374.347 18.31 374.425 18.27 A 1.941 1.941 0 0 1 374.45 18.257 A 1.904 1.904 0 0 1 375.121 18.068 A 2.337 2.337 0 0 1 375.35 18.057 L 375.65 18.057 A 1.034 1.034 0 0 1 375.799 18.069 Q 375.953 18.092 376.15 18.157 Q 376.414 18.233 376.564 18.294 A 1.24 1.24 0 0 1 376.65 18.332 A 2.752 2.752 0 0 1 376.908 18.48 A 3.075 3.075 0 0 1 376.95 18.507 A 13.829 13.829 0 0 1 377.14 18.701 Q 377.434 19.007 377.549 19.173 A 0.72 0.72 0 0 1 377.6 19.257 Q 377.75 19.507 377.85 19.807 A 3.406 3.406 0 0 0 377.911 19.976 Q 377.973 20.133 378.035 20.233 A 0.845 0.845 0 0 0 378.05 20.257 L 378.05 20.357 Q 378.15 20.607 378.15 20.757 L 378.15 21.007 L 378.15 21.857 A 16.799 16.799 0 0 1 378.147 22.211 Q 378.141 22.488 378.125 22.707 A 12.842 12.842 0 0 1 378.094 23.07 A 15.81 15.81 0 0 1 378.05 23.457 A 20.806 20.806 0 0 0 377.976 24.417 A 19.487 19.487 0 0 0 377.975 24.432 A 6.702 6.702 0 0 1 377.874 25.283 A 7.467 7.467 0 0 1 377.85 25.407 A 2.603 2.603 0 0 0 377.807 25.71 A 2.16 2.16 0 0 0 377.8 25.882 A 2.273 2.273 0 0 1 377.779 26.188 A 2.751 2.751 0 0 1 377.75 26.357 A 53.751 53.751 0 0 1 376.537 32.183 A 48.31 48.31 0 0 1 376.25 33.207 Q 375.3 36.457 374.25 39.057 L 374.3 39.057 A 48.831 48.831 0 0 1 372.948 42.113 A 39.862 39.862 0 0 1 372.075 43.807 A 110.267 110.267 0 0 1 370.363 46.83 A 95.053 95.053 0 0 1 369.75 47.857 Q 367.6 51.107 365.45 53.757 A 93.331 93.331 0 0 1 361.42 58.395 A 102.985 102.985 0 0 1 360.8 59.057 L 360.55 59.807 A 24.305 24.305 0 0 0 360.428 60.182 Q 360.374 60.353 360.329 60.507 A 13.696 13.696 0 0 0 360.3 60.607 A 1558.928 1558.928 0 0 1 358.767 64.967 A 1369.637 1369.637 0 0 1 358.275 66.357 Q 357.3 69.107 356.35 71.832 Q 355.4 74.557 354.425 77.407 A 3990.118 3990.118 0 0 1 353.419 80.345 A 4751.008 4751.008 0 0 1 352.35 83.457 Q 351.9 84.757 351.475 86.007 Q 351.05 87.257 350.65 88.457 L 350.65 88.407 A 139.097 139.097 0 0 1 349.875 90.759 A 127.899 127.899 0 0 1 349.85 90.832 Q 349.45 92.007 349.05 93.107 A 17.052 17.052 0 0 0 351.258 92.643 A 21.649 21.649 0 0 0 352.85 92.132 Q 354.85 91.407 356.75 90.607 Q 358.65 89.807 360.35 89.107 Q 362.05 88.407 363.2 88.157 L 363.15 88.157 Q 368.712 85.474 372.346 83.433 A 88.98 88.98 0 0 0 372.525 83.332 A 313.017 313.017 0 0 0 375.123 81.85 Q 377.156 80.676 378.75 79.707 L 378.7 79.707 A 225.998 225.998 0 0 0 379.941 78.938 Q 381.595 77.906 382.783 77.118 A 73.826 73.826 0 0 0 382.95 77.007 A 482.835 482.835 0 0 0 384.317 76.093 Q 384.939 75.675 385.491 75.301 A 268.223 268.223 0 0 0 385.85 75.057 Q 386.55 74.607 387.1 74.207 L 388.2 73.407 A 100.499 100.499 0 0 1 388.978 72.868 A 114.297 114.297 0 0 1 389.25 72.682 A 129.354 129.354 0 0 1 390.103 72.106 A 145.638 145.638 0 0 1 390.4 71.907 A 14.772 14.772 0 0 1 391.511 71.215 A 11.872 11.872 0 0 1 392.25 70.832 Q 393.136 70.414 393.9 70.214 A 6.903 6.903 0 0 1 393.925 70.207 Q 394.674 70.014 395.259 70.077 A 2.512 2.512 0 0 1 395.3 70.082 A 1.638 1.638 0 0 1 395.693 70.178 A 1.134 1.134 0 0 1 396.2 70.557 Q 396.5 70.957 396.4 71.557 A 3.17 3.17 0 0 1 396.244 72.132 Q 396.116 72.48 395.9 72.857 A 5.711 5.711 0 0 1 395.436 73.541 Q 395.149 73.908 394.775 74.282 A 13.022 13.022 0 0 1 393.481 75.411 A 14.731 14.731 0 0 1 393.15 75.657 A 12.889 12.889 0 0 0 392.617 75.97 A 10.549 10.549 0 0 0 392.325 76.157 Q 391.95 76.407 391.4 76.707 A 42.937 42.937 0 0 0 391.006 76.935 Q 390.354 77.317 389.312 77.95 A 226.09 226.09 0 0 0 389.3 77.957 Q 387.913 78.8 385.101 80.526 A 3360.581 3360.581 0 0 0 385.05 80.557 Q 384.8 80.707 384.55 80.832 Q 384.3 80.957 384.05 81.107 A 489.388 489.388 0 0 1 382.684 81.881 Q 380.807 82.94 378.328 84.321 A 1434.384 1434.384 0 0 1 377.5 84.782 Q 374.063 86.694 369.628 88.846 A 232.741 232.741 0 0 1 368.15 89.557 A 163.719 163.719 0 0 1 364.813 91.126 A 201.723 201.723 0 0 1 361.2 92.732 A 165.652 165.652 0 0 1 357.263 94.376 A 211.477 211.477 0 0 1 352.95 96.057 Q 352.421 96.25 351.335 96.767 A 55.4 55.4 0 0 0 351.25 96.807 A 195.767 195.767 0 0 1 350.144 97.332 A 151.416 151.416 0 0 1 349.125 97.807 Q 348.15 98.257 347.75 98.332 A 0.504 0.504 0 0 1 347.718 98.337 Q 347.388 98.378 348.25 97.707 Q 347.15 98.007 345.975 98.207 Q 344.8 98.407 344.2 98.032 Q 343.651 97.689 343.856 96.654 A 4.09 4.09 0 0 1 343.9 96.457 Q 344.19 95.298 345.879 92.88 A 42.217 42.217 0 0 1 346 92.707 Q 346.8 90.457 347.625 88.082 Q 348.45 85.707 349.3 83.257 A 45.086 45.086 0 0 0 349.599 82.434 L 349.6 82.432 Q 349.75 82.007 349.9 81.557 A 1252.904 1252.904 0 0 0 351.892 75.763 A 1400.43 1400.43 0 0 0 352.575 73.757 A 6889.558 6889.558 0 0 1 354.708 67.485 A 7798.551 7798.551 0 0 1 355.45 65.307 Q 355.65 64.757 355.675 64.682 A 1.244 1.244 0 0 0 355.685 64.652 Q 355.7 64.602 355.7 64.582 Q 355.7 64.561 355.737 64.448 A 5.217 5.217 0 0 1 355.75 64.407 A 7.6 7.6 0 0 1 355.776 64.332 Q 355.841 64.142 356.019 63.645 A 303.406 303.406 0 0 1 356.05 63.557 A 104.481 104.481 0 0 1 353.356 65.851 A 131.047 131.047 0 0 1 350.375 68.232 A 139.525 139.525 0 0 1 346.244 71.312 A 168.757 168.757 0 0 1 343.55 73.207 Q 340.75 75.107 337.375 77.157 A 226.2 226.2 0 0 1 332.102 80.26 A 256.615 256.615 0 0 1 330.25 81.307 Z M 80.3 70.557 L 80.25 70.557 A 7.442 7.442 0 0 1 81.591 69.96 Q 82.445 69.681 83.269 69.681 A 4.87 4.87 0 0 1 83.35 69.682 A 4.119 4.119 0 0 1 84.03 69.745 Q 84.962 69.918 85.3 70.557 A 1.361 1.361 0 0 1 85.459 71.204 Q 85.459 71.666 85.176 72.212 A 4.276 4.276 0 0 1 84.925 72.632 Q 84.1 73.857 82.45 74.707 Q 82.16 74.852 81.916 74.951 A 5.259 5.259 0 0 1 81.9 74.957 Q 81.728 75.026 81.509 75.118 A 38.354 38.354 0 0 0 81.3 75.207 A 7.577 7.577 0 0 0 81.167 75.262 Q 80.956 75.351 80.675 75.482 Q 80.34 75.639 79.824 75.875 A 289.297 289.297 0 0 1 79.7 75.932 A 115.557 115.557 0 0 0 79.215 76.156 Q 78.998 76.257 78.757 76.369 A 229.921 229.921 0 0 0 78.25 76.607 Q 77.4 77.007 76.15 77.607 A 200.194 200.194 0 0 1 75.045 78.142 Q 73.519 78.875 71.462 79.836 A 630.013 630.013 0 0 1 70.775 80.157 Q 67.918 81.489 64.266 83.19 A 58539.78 58539.78 0 0 1 63.05 83.757 Q 60.65 84.807 57.825 86.057 A 288.262 288.262 0 0 1 54.869 87.345 A 367.181 367.181 0 0 1 51.65 88.707 A 382.866 382.866 0 0 1 48.188 90.051 A 496.067 496.067 0 0 1 44.4 91.482 Q 40.45 92.957 35.8 94.357 A 111.432 111.432 0 0 1 31.848 95.515 A 123.836 123.836 0 0 1 30.475 95.882 Q 27.7 96.607 24.8 97.157 Q 22.85 97.507 20.775 97.782 A 31.592 31.592 0 0 1 18.074 98.018 A 37.606 37.606 0 0 1 16.35 98.057 Q 15.1 98.057 13.9 97.957 Q 12.7 97.857 11.5 97.657 Q 9.65 97.307 7.775 96.507 A 12.371 12.371 0 0 1 4.407 94.353 A 13.917 13.917 0 0 1 4.3 94.257 L 4.35 94.257 Q 2.7 92.757 1.7 90.757 Q 0.7 88.757 0.3 86.557 Q 0 84.757 0 82.857 Q 0 81.607 0.1 80.382 Q 0.2 79.157 0.4 78.007 Q 1.1 73.757 2.65 69.507 Q 4.105 65.488 5.559 62.406 A 51.642 51.642 0 0 1 6.45 60.607 Q 8.35 56.957 10 54.057 Q 11.6 51.257 13.125 48.932 A 259.46 259.46 0 0 1 14.706 46.551 A 304.345 304.345 0 0 1 16.4 44.057 A 200.077 200.077 0 0 1 18.256 41.401 A 260.148 260.148 0 0 1 20.325 38.532 Q 21.82 36.487 23.777 34.004 A 249.559 249.559 0 0 1 25.65 31.657 Q 27.1 29.907 29 27.732 A 136.247 136.247 0 0 1 30.797 25.719 Q 31.727 24.695 32.783 23.569 A 239.67 239.67 0 0 1 33.5 22.807 L 33.45 22.807 A 74.472 74.472 0 0 1 34.606 21.626 A 92.483 92.483 0 0 1 35.875 20.382 A 78.482 78.482 0 0 1 37.281 19.063 A 102.432 102.432 0 0 1 38.85 17.657 A 32.757 32.757 0 0 1 40.031 16.682 A 36.661 36.661 0 0 1 40.45 16.357 L 42.15 15.057 Q 43.15 14.407 44.15 13.832 Q 45.15 13.257 46.2 12.857 A 16.554 16.554 0 0 1 46.933 12.675 A 13.99 13.99 0 0 1 47.25 12.607 L 48 12.457 L 49.3 12.457 Q 50.6 12.457 51.75 12.607 A 16.513 16.513 0 0 1 54.022 13.158 A 18.1 18.1 0 0 1 54.175 13.207 Q 55.4 13.607 56.45 14.257 Q 57.6 14.907 58.475 15.907 A 10.197 10.197 0 0 1 59.644 17.531 A 9.168 9.168 0 0 1 59.9 18.007 Q 60.4 19.057 60.7 20.207 Q 61 21.357 61.1 22.407 A 11.787 11.787 0 0 1 61.157 22.981 A 13.921 13.921 0 0 1 61.175 23.257 Q 61.2 23.707 61.2 24.207 Q 61.2 25.807 60.975 27.307 Q 60.75 28.807 60.45 30.207 Q 60.05 31.857 59.575 33.557 A 44.449 44.449 0 0 1 58.853 35.898 A 38.253 38.253 0 0 1 58.55 36.757 A 107.031 107.031 0 0 1 57.165 40.341 A 88.184 88.184 0 0 1 56.325 42.332 A 92.713 92.713 0 0 1 54.766 45.719 A 78.988 78.988 0 0 1 54.05 47.157 Q 52.95 49.407 51.9 51.357 Q 50.85 53.307 49.9 54.957 Q 47.603 59.092 45.922 61.878 A 100.545 100.545 0 0 1 44.95 63.457 A 3102.131 3102.131 0 0 1 44.105 64.8 Q 43.133 66.343 42.592 67.198 A 277.066 277.066 0 0 1 42.3 67.657 L 42.3 67.607 A 8.055 8.055 0 0 1 42.163 67.87 A 6.887 6.887 0 0 1 42.1 67.982 A 1.813 1.813 0 0 1 42.025 68.103 Q 41.963 68.195 41.9 68.257 Q 41.4 68.957 40.775 69.532 Q 40.15 70.107 39.525 70.432 Q 38.944 70.734 38.428 70.82 A 2.648 2.648 0 0 1 38.35 70.832 Q 37.8 70.907 37.4 70.607 Q 36.6 70.007 36.8 68.582 A 5.9 5.9 0 0 1 37.278 66.971 A 8.122 8.122 0 0 1 38 65.707 A 3.006 3.006 0 0 1 38.217 65.395 A 3.733 3.733 0 0 1 38.375 65.207 A 3.411 3.411 0 0 0 38.547 64.999 Q 38.639 64.879 38.734 64.736 A 6.862 6.862 0 0 0 38.85 64.557 A 26.486 26.486 0 0 1 39.096 64.195 Q 39.207 64.034 39.333 63.856 A 52.749 52.749 0 0 1 39.6 63.482 Q 40.05 62.857 40.7 61.882 A 246.025 246.025 0 0 0 41.223 61.095 Q 41.455 60.743 41.712 60.352 A 475.736 475.736 0 0 0 42.25 59.532 Q 43.15 58.157 44.4 56.257 L 44.4 56.307 A 1.963 1.963 0 0 1 44.528 56.087 A 1.603 1.603 0 0 1 44.625 55.957 A 1.672 1.672 0 0 0 44.772 55.75 A 2.058 2.058 0 0 0 44.85 55.607 A 124.195 124.195 0 0 0 46.195 53.417 Q 47.375 51.454 48.75 49.032 A 92.682 92.682 0 0 0 50.449 45.89 Q 51.906 43.076 53.5 39.607 Q 54.15 38.207 54.8 36.607 Q 55.45 35.007 56.05 33.157 Q 56.6 31.507 57.1 29.557 Q 57.6 27.607 57.8 25.507 A 10.852 10.852 0 0 0 57.844 25.088 A 13.908 13.908 0 0 0 57.875 24.632 A 21.096 21.096 0 0 0 57.89 24.293 Q 57.896 24.126 57.899 23.978 A 11.08 11.08 0 0 0 57.9 23.807 Q 57.9 23.257 57.85 22.682 A 8.168 8.168 0 0 0 57.752 21.954 A 10.153 10.153 0 0 0 57.65 21.457 Q 57.45 20.457 57.075 19.507 Q 56.7 18.557 56 17.857 A 5.89 5.89 0 0 0 54.826 16.895 A 7.127 7.127 0 0 0 54.275 16.582 Q 53.25 16.057 52.1 15.807 A 11.615 11.615 0 0 0 51.382 15.681 Q 50.634 15.573 49.65 15.507 Q 49.3 15.457 49 15.457 L 48.4 15.457 A 1.334 1.334 0 0 0 48.304 15.461 Q 48.166 15.471 47.95 15.507 Q 47.65 15.557 47.3 15.657 L 47.4 15.607 A 12.631 12.631 0 0 0 45.281 16.564 A 11.845 11.845 0 0 0 45.25 16.582 Q 44.25 17.157 43.35 17.807 Q 42.5 18.357 41.575 19.132 A 92.6 92.6 0 0 0 40.014 20.469 A 84.252 84.252 0 0 0 39.8 20.657 Q 38.4 21.957 36.85 23.482 A 97.557 97.557 0 0 0 35.01 25.34 A 80.26 80.26 0 0 0 34 26.407 Q 31.45 29.257 29.325 31.807 A 128.927 128.927 0 0 0 27.335 34.253 A 93.594 93.594 0 0 0 25.6 36.507 A 180.978 180.978 0 0 0 23.219 39.765 Q 22.066 41.381 21.097 42.83 A 90.893 90.893 0 0 0 20 44.507 Q 17.8 47.957 16.1 50.857 Q 14.45 53.757 13 56.582 Q 11.55 59.407 9.85 62.907 L 9.85 62.857 A 1612.063 1612.063 0 0 1 9.119 64.526 A 2047.219 2047.219 0 0 1 8.325 66.332 A 61.967 61.967 0 0 0 7.535 68.216 Q 7.135 69.213 6.719 70.334 A 104.282 104.282 0 0 0 6.6 70.657 A 50.875 50.875 0 0 0 5.586 73.626 A 62.072 62.072 0 0 0 5.025 75.557 A 38.693 38.693 0 0 0 4.262 78.973 A 48.092 48.092 0 0 0 3.9 81.357 Q 3.85 81.907 3.825 82.432 Q 3.8 82.957 3.8 83.457 A 15.334 15.334 0 0 0 4.225 87.118 A 13.593 13.593 0 0 0 4.7 88.657 A 7.878 7.878 0 0 0 5.461 90.243 A 6.53 6.53 0 0 0 6.25 91.257 A 10.766 10.766 0 0 0 7.957 92.72 A 9.742 9.742 0 0 0 8.4 93.007 Q 9.6 93.707 10.875 94.082 Q 12.15 94.457 13.4 94.657 A 24.109 24.109 0 0 0 14.976 94.849 A 20.379 20.379 0 0 0 15.875 94.907 A 27.199 27.199 0 0 0 17.031 94.932 A 24.639 24.639 0 0 0 18.15 94.907 Q 20.4 94.807 22.575 94.482 Q 24.75 94.157 26.85 93.707 Q 29 93.257 31.2 92.657 Q 33.4 92.057 35.65 91.307 Q 39.55 90.057 42.85 88.807 Q 46.15 87.557 49.05 86.357 Q 54.8 83.907 58.95 81.857 A 276.801 276.801 0 0 0 61.944 80.427 Q 63.111 79.861 64.144 79.343 A 133.505 133.505 0 0 0 66.075 78.357 Q 68.95 76.857 71 75.757 L 70.95 75.807 A 1747.357 1747.357 0 0 0 71.883 75.281 Q 73.219 74.526 74.175 73.982 A 228.713 228.713 0 0 1 75.238 73.381 Q 75.725 73.108 76.163 72.865 A 132.893 132.893 0 0 1 76.45 72.707 A 169.26 169.26 0 0 0 77.908 71.896 A 152.149 152.149 0 0 0 78.375 71.632 A 160.548 160.548 0 0 1 79.805 70.831 A 178.29 178.29 0 0 1 80.3 70.557 Z M 540.05 70.557 L 540 70.457 Q 540.455 71.16 539.953 72.153 A 4.164 4.164 0 0 1 539.7 72.582 A 6.093 6.093 0 0 1 538.665 73.753 Q 538.002 74.342 537.1 74.857 Q 536.75 75.057 536.35 75.257 L 535.35 75.757 A 4.479 4.479 0 0 0 535.044 75.894 A 5.618 5.618 0 0 0 534.825 76.007 Q 534.55 76.157 534.2 76.357 Q 533.281 76.778 531.894 77.405 A 913.451 913.451 0 0 1 531 77.807 A 210.377 210.377 0 0 1 529.922 78.288 Q 528.188 79.057 525.75 80.107 A 214.93 214.93 0 0 1 523.105 81.224 Q 520.728 82.21 517.775 83.382 A 199.482 199.482 0 0 1 513.939 84.855 Q 512.22 85.497 510.297 86.185 A 392.667 392.667 0 0 1 506.25 87.607 A 235.741 235.741 0 0 1 502.769 88.788 A 312.9 312.9 0 0 1 498.925 90.032 A 379.982 379.982 0 0 1 492.648 91.959 A 436.619 436.619 0 0 1 490.45 92.607 Q 488.2 93.257 485.775 93.907 A 303.522 303.522 0 0 1 481.397 95.045 A 334.44 334.44 0 0 1 480.75 95.207 A 218.191 218.191 0 0 1 476.573 96.168 A 243.695 243.695 0 0 1 475.125 96.482 A 130.707 130.707 0 0 1 470.864 97.321 A 114.326 114.326 0 0 1 469.5 97.557 Q 468.8 97.657 468.075 97.732 Q 467.35 97.807 466.7 97.907 A 3.597 3.597 0 0 0 466.44 97.917 A 4.332 4.332 0 0 0 466.275 97.932 Q 466.05 97.957 465.9 97.957 L 465.25 97.957 Q 465.15 97.957 465.05 97.932 Q 464.95 97.907 464.85 97.907 Q 464.55 97.907 464.25 97.882 A 1.944 1.944 0 0 1 463.992 97.842 Q 463.865 97.814 463.724 97.768 A 3.992 3.992 0 0 1 463.55 97.707 Q 462.55 97.007 462.075 96.382 Q 461.6 95.757 461.3 95.057 Q 461.05 94.407 460.875 93.757 Q 460.7 93.107 460.6 92.457 Q 460.5 91.657 460.45 90.882 Q 460.4 90.107 460.4 89.257 A 34.475 34.475 0 0 1 460.459 87.21 A 28.774 28.774 0 0 1 460.55 86.057 A 70.058 70.058 0 0 1 460.851 83.509 A 63.628 63.628 0 0 1 460.9 83.157 A 122.364 122.364 0 0 1 461.047 82.126 Q 461.166 81.313 461.275 80.657 A 49.818 49.818 0 0 1 461.552 79.138 A 43.347 43.347 0 0 1 461.65 78.657 Q 461.85 77.707 462.05 76.807 A 373.57 373.57 0 0 0 462.235 75.972 Q 462.328 75.546 462.431 75.076 A 622.599 622.599 0 0 0 462.5 74.757 A 4.69 4.69 0 0 1 461.959 74.867 Q 461.398 74.946 460.917 74.857 A 2.623 2.623 0 0 1 460.8 74.832 A 1.956 1.956 0 0 1 460.38 74.686 Q 460.106 74.551 459.938 74.336 A 1.135 1.135 0 0 1 459.8 74.107 Q 459.425 73.399 459.918 72.43 A 4.284 4.284 0 0 1 460.15 72.032 Q 460.944 70.816 462.329 69.674 A 14.836 14.836 0 0 1 462.35 69.657 A 1.353 1.353 0 0 1 462.422 69.59 Q 462.495 69.526 462.555 69.499 A 0.251 0.251 0 0 1 462.6 69.482 Q 462.7 69.457 462.8 69.357 L 462.7 69.407 A 12.157 12.157 0 0 0 463.061 69.182 A 10.855 10.855 0 0 0 463.175 69.107 Q 463.347 68.992 463.622 68.79 A 28.202 28.202 0 0 0 463.8 68.657 Q 463.897 68.56 463.947 68.533 A 0.148 0.148 0 0 1 463.95 68.532 A 0.228 0.228 0 0 0 463.978 68.515 Q 464.023 68.484 464.093 68.414 A 2.199 2.199 0 0 0 464.1 68.407 A 396.682 396.682 0 0 1 465.369 63.814 Q 466.158 61.031 466.875 58.682 Q 468.15 54.507 469.3 51.057 Q 470.45 47.557 471.625 44.232 A 188.485 188.485 0 0 1 472.881 40.788 A 234.971 234.971 0 0 1 474.3 37.107 Q 475.8 33.357 477.9 28.507 A 154.193 154.193 0 0 1 479.637 24.652 Q 481.219 21.257 483.25 17.257 Q 485.5 12.957 487.5 9.457 A 58.349 58.349 0 0 1 490.278 5.047 A 49.267 49.267 0 0 1 491.7 3.107 L 491.95 2.857 Q 492.45 2.257 492.975 1.682 A 6.091 6.091 0 0 1 494.07 0.743 A 6.842 6.842 0 0 1 494.2 0.657 Q 494.55 0.457 494.9 0.282 Q 495.213 0.126 495.486 0.069 A 1.668 1.668 0 0 1 495.55 0.057 A 2.429 2.429 0 0 1 495.858 0.008 Q 496.12 -0.015 496.354 0.028 A 1.578 1.578 0 0 1 496.375 0.032 A 2.817 2.817 0 0 1 496.829 0.165 A 3.579 3.579 0 0 1 497.15 0.307 A 3.419 3.419 0 0 1 497.657 0.657 Q 497.941 0.896 498.125 1.176 A 2.069 2.069 0 0 1 498.175 1.257 A 5.595 5.595 0 0 1 498.453 1.786 A 4.124 4.124 0 0 1 498.65 2.307 A 10.811 10.811 0 0 1 498.876 3.288 A 8.621 8.621 0 0 1 498.975 4.007 Q 499.05 4.807 499 5.557 A 22.373 22.373 0 0 1 498.984 6.418 A 17.398 17.398 0 0 1 498.95 7.032 A 14.827 14.827 0 0 1 498.858 7.925 A 12.626 12.626 0 0 1 498.8 8.307 Q 498.5 10.757 497.95 13.132 Q 497.4 15.507 496.7 17.907 Q 496.05 20.207 495.3 22.582 A 112.829 112.829 0 0 1 494.174 25.954 A 132.056 132.056 0 0 1 493.6 27.557 Q 490.5 35.857 487.475 41.982 A 210.534 210.534 0 0 1 485.266 46.333 Q 483.475 49.757 481.85 52.507 Q 479.215 56.996 477.2 59.866 A 57.043 57.043 0 0 1 477.1 60.007 Q 475.819 61.82 474.752 63.242 A 80.022 80.022 0 0 1 473.55 64.807 A 80.21 80.21 0 0 1 472.501 66.083 Q 471.659 67.085 470.925 67.882 A 90.399 90.399 0 0 1 469.794 69.088 A 66.628 66.628 0 0 1 468.75 70.157 A 62.468 62.468 0 0 1 468.079 70.819 Q 467.769 71.119 467.486 71.384 A 36.675 36.675 0 0 1 467.3 71.557 A 25.325 25.325 0 0 1 466.269 72.457 A 28.647 28.647 0 0 1 465.9 72.757 A 0.258 0.258 0 0 1 465.897 72.794 Q 465.891 72.833 465.875 72.882 A 0.652 0.652 0 0 0 465.862 72.927 Q 465.856 72.949 465.853 72.969 A 0.259 0.259 0 0 0 465.85 73.007 L 465.9 72.957 A 2.534 2.534 0 0 1 465.804 73.26 A 2.256 2.256 0 0 1 465.775 73.332 A 1.688 1.688 0 0 0 465.714 73.499 Q 465.687 73.587 465.665 73.688 A 3.13 3.13 0 0 0 465.65 73.757 Q 465.09 75.998 464.53 78.827 A 148.695 148.695 0 0 0 464.45 79.232 Q 463.85 82.307 463.45 85.857 A 14.602 14.602 0 0 0 463.354 86.834 A 17.397 17.397 0 0 0 463.325 87.457 A 56.81 56.81 0 0 0 463.3 88.906 A 51.779 51.779 0 0 0 463.3 89.107 Q 463.3 90.157 463.375 91.157 Q 463.45 92.157 463.7 93.107 A 3.209 3.209 0 0 0 463.963 93.894 Q 464.165 94.319 464.5 94.757 L 464.7 94.957 A 9.128 9.128 0 0 0 465.609 95.002 Q 466.153 95.002 466.724 94.941 A 11.485 11.485 0 0 0 466.8 94.932 Q 467.9 94.807 469 94.607 A 122.649 122.649 0 0 0 477.692 92.75 A 112.358 112.358 0 0 0 478.25 92.607 Q 482.7 91.457 486.4 90.407 L 486.35 90.407 A 240.961 240.961 0 0 0 491.569 88.826 A 203.945 203.945 0 0 0 493.8 88.107 Q 497.3 86.957 500.45 85.807 Q 505.907 83.874 510.238 82.198 A 245.539 245.539 0 0 0 511.625 81.657 A 286.36 286.36 0 0 0 515.912 79.931 Q 517.921 79.102 519.697 78.327 A 168.84 168.84 0 0 0 520.2 78.107 A 307.406 307.406 0 0 0 523.052 76.818 Q 526.127 75.408 528.288 74.319 A 77.698 77.698 0 0 0 529.525 73.682 Q 532.8 71.957 534.1 71.257 L 534.05 71.257 Q 534.288 71.114 534.345 71.107 A 0.044 0.044 0 0 1 534.35 71.107 A 0.078 0.078 0 0 0 534.38 71.1 Q 534.422 71.083 534.486 71.021 A 1.045 1.045 0 0 0 534.5 71.007 A 11.406 11.406 0 0 1 535.935 70.313 Q 536.988 69.897 537.95 69.807 A 4.969 4.969 0 0 1 538.22 69.789 Q 539.076 69.756 539.575 70.062 A 1.328 1.328 0 0 1 540.05 70.557 Z M 614.5 70.557 L 614.45 70.457 Q 614.905 71.16 614.403 72.153 A 4.164 4.164 0 0 1 614.15 72.582 A 6.093 6.093 0 0 1 613.115 73.753 Q 612.452 74.342 611.55 74.857 Q 611.2 75.057 610.8 75.257 L 609.8 75.757 A 4.479 4.479 0 0 0 609.494 75.894 A 5.618 5.618 0 0 0 609.275 76.007 Q 609 76.157 608.65 76.357 Q 607.731 76.778 606.344 77.405 A 913.451 913.451 0 0 1 605.45 77.807 A 210.377 210.377 0 0 1 604.372 78.288 Q 602.638 79.057 600.2 80.107 A 214.93 214.93 0 0 1 597.555 81.224 Q 595.178 82.21 592.225 83.382 A 199.482 199.482 0 0 1 588.389 84.855 Q 586.67 85.497 584.747 86.185 A 392.667 392.667 0 0 1 580.7 87.607 A 235.741 235.741 0 0 1 577.219 88.788 A 312.9 312.9 0 0 1 573.375 90.032 A 379.982 379.982 0 0 1 567.098 91.959 A 436.619 436.619 0 0 1 564.9 92.607 Q 562.65 93.257 560.225 93.907 A 303.522 303.522 0 0 1 555.847 95.045 A 334.44 334.44 0 0 1 555.2 95.207 A 218.191 218.191 0 0 1 551.023 96.168 A 243.695 243.695 0 0 1 549.575 96.482 A 130.707 130.707 0 0 1 545.314 97.321 A 114.326 114.326 0 0 1 543.95 97.557 Q 543.25 97.657 542.525 97.732 Q 541.8 97.807 541.15 97.907 A 3.597 3.597 0 0 0 540.89 97.917 A 4.332 4.332 0 0 0 540.725 97.932 Q 540.5 97.957 540.35 97.957 L 539.7 97.957 Q 539.6 97.957 539.5 97.932 Q 539.4 97.907 539.3 97.907 Q 539 97.907 538.7 97.882 A 1.944 1.944 0 0 1 538.442 97.842 Q 538.315 97.814 538.174 97.768 A 3.992 3.992 0 0 1 538 97.707 Q 537 97.007 536.525 96.382 Q 536.05 95.757 535.75 95.057 Q 535.5 94.407 535.325 93.757 Q 535.15 93.107 535.05 92.457 Q 534.95 91.657 534.9 90.882 Q 534.85 90.107 534.85 89.257 A 34.475 34.475 0 0 1 534.909 87.21 A 28.774 28.774 0 0 1 535 86.057 A 70.058 70.058 0 0 1 535.301 83.509 A 63.628 63.628 0 0 1 535.35 83.157 A 122.364 122.364 0 0 1 535.497 82.126 Q 535.616 81.313 535.725 80.657 A 49.818 49.818 0 0 1 536.002 79.138 A 43.347 43.347 0 0 1 536.1 78.657 Q 536.3 77.707 536.5 76.807 A 373.57 373.57 0 0 0 536.685 75.972 Q 536.778 75.546 536.881 75.076 A 622.599 622.599 0 0 0 536.95 74.757 A 4.69 4.69 0 0 1 536.409 74.867 Q 535.848 74.946 535.367 74.857 A 2.623 2.623 0 0 1 535.25 74.832 A 1.956 1.956 0 0 1 534.83 74.686 Q 534.556 74.551 534.388 74.336 A 1.135 1.135 0 0 1 534.25 74.107 Q 533.875 73.399 534.368 72.43 A 4.284 4.284 0 0 1 534.6 72.032 Q 535.394 70.816 536.779 69.674 A 14.836 14.836 0 0 1 536.8 69.657 A 1.353 1.353 0 0 1 536.872 69.59 Q 536.945 69.526 537.005 69.499 A 0.251 0.251 0 0 1 537.05 69.482 Q 537.15 69.457 537.25 69.357 L 537.15 69.407 A 12.157 12.157 0 0 0 537.511 69.182 A 10.855 10.855 0 0 0 537.625 69.107 Q 537.797 68.992 538.072 68.79 A 28.202 28.202 0 0 0 538.25 68.657 Q 538.347 68.56 538.397 68.533 A 0.148 0.148 0 0 1 538.4 68.532 A 0.228 0.228 0 0 0 538.428 68.515 Q 538.473 68.484 538.543 68.414 A 2.199 2.199 0 0 0 538.55 68.407 A 396.682 396.682 0 0 1 539.819 63.814 Q 540.608 61.031 541.325 58.682 Q 542.6 54.507 543.75 51.057 Q 544.9 47.557 546.075 44.232 A 188.485 188.485 0 0 1 547.331 40.788 A 234.971 234.971 0 0 1 548.75 37.107 Q 550.25 33.357 552.35 28.507 A 154.193 154.193 0 0 1 554.087 24.652 Q 555.669 21.257 557.7 17.257 Q 559.95 12.957 561.95 9.457 A 58.349 58.349 0 0 1 564.728 5.047 A 49.267 49.267 0 0 1 566.15 3.107 L 566.4 2.857 Q 566.9 2.257 567.425 1.682 A 6.091 6.091 0 0 1 568.52 0.743 A 6.842 6.842 0 0 1 568.65 0.657 Q 569 0.457 569.35 0.282 Q 569.663 0.126 569.936 0.069 A 1.668 1.668 0 0 1 570 0.057 A 2.429 2.429 0 0 1 570.308 0.008 Q 570.57 -0.015 570.804 0.028 A 1.578 1.578 0 0 1 570.825 0.032 A 2.817 2.817 0 0 1 571.279 0.165 A 3.579 3.579 0 0 1 571.6 0.307 A 3.419 3.419 0 0 1 572.107 0.657 Q 572.391 0.896 572.575 1.176 A 2.069 2.069 0 0 1 572.625 1.257 A 5.595 5.595 0 0 1 572.903 1.786 A 4.124 4.124 0 0 1 573.1 2.307 A 10.811 10.811 0 0 1 573.326 3.288 A 8.621 8.621 0 0 1 573.425 4.007 Q 573.5 4.807 573.45 5.557 A 22.373 22.373 0 0 1 573.434 6.418 A 17.398 17.398 0 0 1 573.4 7.032 A 14.827 14.827 0 0 1 573.308 7.925 A 12.626 12.626 0 0 1 573.25 8.307 Q 572.95 10.757 572.4 13.132 Q 571.85 15.507 571.15 17.907 Q 570.5 20.207 569.75 22.582 A 112.829 112.829 0 0 1 568.624 25.954 A 132.056 132.056 0 0 1 568.05 27.557 Q 564.95 35.857 561.925 41.982 A 210.534 210.534 0 0 1 559.716 46.333 Q 557.925 49.757 556.3 52.507 Q 553.665 56.996 551.65 59.866 A 57.043 57.043 0 0 1 551.55 60.007 Q 550.269 61.82 549.202 63.242 A 80.022 80.022 0 0 1 548 64.807 A 80.21 80.21 0 0 1 546.951 66.083 Q 546.109 67.085 545.375 67.882 A 90.399 90.399 0 0 1 544.244 69.088 A 66.628 66.628 0 0 1 543.2 70.157 A 62.468 62.468 0 0 1 542.529 70.819 Q 542.219 71.119 541.936 71.384 A 36.675 36.675 0 0 1 541.75 71.557 A 25.325 25.325 0 0 1 540.719 72.457 A 28.647 28.647 0 0 1 540.35 72.757 A 0.258 0.258 0 0 1 540.347 72.794 Q 540.341 72.833 540.325 72.882 A 0.652 0.652 0 0 0 540.312 72.927 Q 540.306 72.949 540.303 72.969 A 0.259 0.259 0 0 0 540.3 73.007 L 540.35 72.957 A 2.534 2.534 0 0 1 540.254 73.26 A 2.256 2.256 0 0 1 540.225 73.332 A 1.688 1.688 0 0 0 540.164 73.499 Q 540.137 73.587 540.115 73.688 A 3.13 3.13 0 0 0 540.1 73.757 Q 539.54 75.998 538.98 78.827 A 148.695 148.695 0 0 0 538.9 79.232 Q 538.3 82.307 537.9 85.857 A 14.602 14.602 0 0 0 537.804 86.834 A 17.397 17.397 0 0 0 537.775 87.457 A 56.81 56.81 0 0 0 537.75 88.906 A 51.779 51.779 0 0 0 537.75 89.107 Q 537.75 90.157 537.825 91.157 Q 537.9 92.157 538.15 93.107 A 3.209 3.209 0 0 0 538.413 93.894 Q 538.615 94.319 538.95 94.757 L 539.15 94.957 A 9.128 9.128 0 0 0 540.059 95.002 Q 540.603 95.002 541.174 94.941 A 11.485 11.485 0 0 0 541.25 94.932 Q 542.35 94.807 543.45 94.607 A 122.649 122.649 0 0 0 552.142 92.75 A 112.358 112.358 0 0 0 552.7 92.607 Q 557.15 91.457 560.85 90.407 L 560.8 90.407 A 240.961 240.961 0 0 0 566.019 88.826 A 203.945 203.945 0 0 0 568.25 88.107 Q 571.75 86.957 574.9 85.807 Q 580.357 83.874 584.688 82.198 A 245.539 245.539 0 0 0 586.075 81.657 A 286.36 286.36 0 0 0 590.362 79.931 Q 592.371 79.102 594.147 78.327 A 168.84 168.84 0 0 0 594.65 78.107 A 307.406 307.406 0 0 0 597.502 76.818 Q 600.577 75.408 602.738 74.319 A 77.698 77.698 0 0 0 603.975 73.682 Q 607.25 71.957 608.55 71.257 L 608.5 71.257 Q 608.738 71.114 608.795 71.107 A 0.044 0.044 0 0 1 608.8 71.107 A 0.078 0.078 0 0 0 608.83 71.1 Q 608.872 71.083 608.936 71.021 A 1.045 1.045 0 0 0 608.95 71.007 A 11.406 11.406 0 0 1 610.385 70.313 Q 611.438 69.897 612.4 69.807 A 4.969 4.969 0 0 1 612.67 69.789 Q 613.526 69.756 614.025 70.062 A 1.328 1.328 0 0 1 614.5 70.557 Z M 176.3 73.857 L 176.35 73.807 Q 176.25 73.857 176.1 73.957 A 2.013 2.013 0 0 1 175.975 74.072 A 1.673 1.673 0 0 1 175.9 74.132 A 1.388 1.388 0 0 1 175.766 74.222 A 1.176 1.176 0 0 1 175.7 74.257 Q 175.512 74.37 175.167 74.625 A 21.806 21.806 0 0 0 174.925 74.807 Q 174.4 75.207 173.3 76.057 A 50.74 50.74 0 0 0 172.797 76.487 Q 172.053 77.13 171.088 78.006 A 145.009 145.009 0 0 0 170.95 78.132 A 55.819 55.819 0 0 0 169.83 79.183 Q 169.334 79.661 168.789 80.204 A 113.27 113.27 0 0 0 167.65 81.357 L 167.45 81.557 A 76.126 76.126 0 0 0 166.668 82.446 Q 166.141 83.054 165.55 83.757 Q 164.5 85.007 163.5 86.407 Q 162.45 87.907 161.3 89.857 Q 160.15 91.807 159.4 94.207 A 0.607 0.607 0 0 0 159.372 94.272 Q 159.35 94.332 159.35 94.382 Q 159.35 94.437 159.323 94.506 A 0.634 0.634 0 0 1 159.3 94.557 A 5.271 5.271 0 0 0 159.163 94.775 A 6.226 6.226 0 0 0 159.1 94.882 A 0.406 0.406 0 0 1 159.058 94.943 Q 158.978 95.038 158.871 95.013 A 0.234 0.234 0 0 1 158.85 95.007 Q 158.85 95.107 159.45 94.857 Q 159.75 94.757 160.05 94.682 A 4.634 4.634 0 0 0 160.397 94.581 A 3.764 3.764 0 0 0 160.6 94.507 Q 161.9 93.957 163.375 93.082 Q 164.85 92.207 166.45 91.207 Q 168.05 90.207 169.65 89.132 A 398.238 398.238 0 0 0 171.288 88.026 A 459.901 459.901 0 0 0 173 86.857 L 172.95 86.857 A 54.228 54.228 0 0 1 173.363 86.551 A 63.428 63.428 0 0 1 173.8 86.232 Q 174.25 85.907 174.7 85.607 L 175.6 84.957 A 2.013 2.013 0 0 1 175.725 84.842 A 1.673 1.673 0 0 1 175.8 84.782 A 2.635 2.635 0 0 0 175.847 84.746 Q 175.913 84.695 175.95 84.657 L 176.5 84.557 L 178.4 84.607 L 179 85.057 Q 179.4 85.307 179.85 85.607 Q 180.3 85.907 180.8 86.157 L 181.15 86.157 A 0.48 0.48 0 0 1 181.106 86.196 Q 181.082 86.215 181.057 86.229 A 0.286 0.286 0 0 1 181.05 86.232 Q 181 86.257 180.95 86.307 Q 181.85 86.857 182.8 87.307 L 182.8 87.257 Q 185.349 88.688 187.099 89.52 A 34.475 34.475 0 0 0 187.5 89.707 A 117.954 117.954 0 0 0 189.042 90.403 Q 189.984 90.82 190.8 91.157 A 33.065 33.065 0 0 0 193.211 92.129 A 29.695 29.695 0 0 0 193.65 92.282 A 718.572 718.572 0 0 1 195.1 92.776 A 879.67 879.67 0 0 1 196.65 93.307 A 57.007 57.007 0 0 0 198.005 93.662 Q 198.7 93.835 199.475 94.013 A 97.811 97.811 0 0 0 200 94.132 A 29.478 29.478 0 0 0 201.787 94.471 Q 203.016 94.667 204.45 94.807 A 7.273 7.273 0 0 0 204.812 94.838 Q 205.014 94.85 205.242 94.854 A 14.134 14.134 0 0 0 205.525 94.857 L 206.7 94.857 Q 207.5 94.857 208.475 94.807 Q 209.45 94.757 210.45 94.607 A 23.918 23.918 0 0 0 212.442 94.223 A 30.783 30.783 0 0 0 214.1 93.782 A 25.621 25.621 0 0 0 216.596 92.897 A 31.386 31.386 0 0 0 218.15 92.207 Q 222.65 90.057 226.075 87.857 A 158.625 158.625 0 0 0 229.319 85.72 A 117.449 117.449 0 0 0 232.2 83.707 A 88.37 88.37 0 0 0 234.624 81.928 Q 235.75 81.071 236.725 80.262 A 52.865 52.865 0 0 0 237 80.032 A 427.13 427.13 0 0 0 238.46 78.798 Q 239.036 78.309 239.559 77.861 A 236.594 236.594 0 0 0 240.55 77.007 A 244.303 244.303 0 0 0 241.641 76.006 Q 242.97 74.777 243.905 73.87 A 70.406 70.406 0 0 0 244.2 73.582 Q 245.5 72.307 246.104 71.657 A 17.894 17.894 0 0 0 246.15 71.607 L 246.5 71.257 A 3.388 3.388 0 0 1 247.509 70.549 A 3.12 3.12 0 0 1 248.35 70.307 A 2.759 2.759 0 0 1 248.656 70.28 Q 249.505 70.254 250.1 70.807 Q 250.837 71.495 250.729 72.568 A 2.937 2.937 0 0 1 250.725 72.607 A 3.139 3.139 0 0 1 250.102 74.145 A 4.194 4.194 0 0 1 249.7 74.607 A 5.015 5.015 0 0 0 249.543 74.73 Q 249.458 74.8 249.364 74.881 A 9.247 9.247 0 0 0 249.25 74.982 Q 249 75.207 248.475 75.657 Q 247.95 76.107 247.1 76.807 Q 246.34 77.433 245.139 78.42 A 4460.846 4460.846 0 0 1 244.85 78.657 A 36.931 36.931 0 0 1 243.812 79.539 Q 243.304 79.956 242.713 80.417 A 83.12 83.12 0 0 1 241.45 81.382 A 248.404 248.404 0 0 1 239.741 82.651 Q 238.974 83.217 238.114 83.843 A 500.431 500.431 0 0 1 236.3 85.157 A 71.585 71.585 0 0 1 234.989 86.07 Q 234.315 86.529 233.561 87.024 A 120.357 120.357 0 0 1 233.05 87.357 A 97.235 97.235 0 0 1 230.611 88.886 A 118.711 118.711 0 0 1 229.025 89.832 A 120.689 120.689 0 0 1 225.617 91.754 A 139.104 139.104 0 0 1 224.4 92.407 Q 221.95 93.707 219.4 94.907 Q 216.85 96.057 214.275 96.732 Q 211.7 97.407 209.6 97.607 Q 208.1 97.757 206.55 97.757 Q 205.4 97.757 204.25 97.682 Q 203.1 97.607 202.15 97.507 Q 199.349 97.227 197.137 96.751 A 31.66 31.66 0 0 1 196.825 96.682 Q 194.5 96.157 192.6 95.657 Q 190.7 95.107 189 94.532 Q 187.3 93.957 185.3 93.107 A 70.662 70.662 0 0 1 183.758 92.39 A 80.434 80.434 0 0 1 183.225 92.132 A 32.095 32.095 0 0 1 181.904 91.447 A 40.12 40.12 0 0 1 180.95 90.907 A 292.998 292.998 0 0 0 180.022 90.368 A 328.423 328.423 0 0 0 179.7 90.182 A 367.037 367.037 0 0 0 178.697 89.606 A 408.05 408.05 0 0 0 178.35 89.407 L 177.15 88.657 A 325.262 325.262 0 0 1 174.369 90.386 Q 173.271 91.06 172.272 91.66 A 171.469 171.469 0 0 1 170.375 92.782 A 109.629 109.629 0 0 1 167.594 94.351 A 84.426 84.426 0 0 1 165 95.707 A 49.003 49.003 0 0 1 162.998 96.651 A 53.837 53.837 0 0 1 162.7 96.782 Q 161.5 97.307 160.2 97.707 Q 159.45 97.907 158.4 97.907 Q 158.15 97.857 157.925 97.807 A 0.879 0.879 0 0 1 157.774 97.757 Q 157.625 97.694 157.436 97.566 A 3.728 3.728 0 0 1 157.35 97.507 L 157.4 97.557 A 1.988 1.988 0 0 1 156.741 97.071 Q 156.431 96.715 156.326 96.206 A 2.446 2.446 0 0 1 156.3 96.057 Q 156.233 95.757 156.233 95.468 A 2.447 2.447 0 0 1 156.25 95.182 Q 156.3 94.757 156.4 94.357 L 156.4 94.207 Q 156.45 93.957 156.55 93.557 Q 156.65 93.157 156.8 92.757 A 23.927 23.927 0 0 1 157.655 90.344 A 18.691 18.691 0 0 1 158.5 88.582 Q 159.5 86.757 160.45 85.257 A 43.744 43.744 0 0 1 161.306 83.938 Q 161.709 83.342 162.095 82.821 A 25.887 25.887 0 0 1 162.35 82.482 Q 163.25 81.307 164.05 80.307 L 164.05 80.357 A 89.135 89.135 0 0 1 165.099 79.043 Q 165.678 78.333 166.206 77.72 A 48.307 48.307 0 0 1 166.675 77.182 A 135.592 135.592 0 0 1 167.511 76.248 Q 167.84 75.884 168.137 75.561 A 67.012 67.012 0 0 1 168.7 74.957 L 169.05 74.607 Q 169.318 74.339 169.513 74.115 A 5.855 5.855 0 0 0 169.625 73.982 Q 169.85 73.707 170.1 73.457 Q 170.65 72.857 171.075 72.432 L 171.85 71.657 A 12.641 12.641 0 0 1 172.452 71.093 A 11.363 11.363 0 0 1 172.55 71.007 Q 172.9 70.707 173.3 70.307 A 3.195 3.195 0 0 1 174.145 69.757 Q 174.692 69.518 175.3 69.532 A 2.832 2.832 0 0 1 176.019 69.635 A 1.982 1.982 0 0 1 177 70.257 Q 177.521 70.968 177.391 71.925 A 3.141 3.141 0 0 1 177.375 72.032 A 2.929 2.929 0 0 1 176.727 73.416 A 3.945 3.945 0 0 1 176.3 73.857 Z M 175.2 74.007 L 175.25 73.957 A 2.945 2.945 0 0 1 175.166 73.984 Q 175.025 74.026 174.8 74.082 A 5.672 5.672 0 0 0 174.631 74.127 Q 174.35 74.207 173.9 74.357 Q 173.3 74.557 172.3 74.907 Q 171.406 75.22 169.991 75.733 A 451.816 451.816 0 0 0 169.65 75.857 A 297.053 297.053 0 0 0 168.477 76.287 Q 166.606 76.976 164.075 77.932 A 737.547 737.547 0 0 1 162.277 78.609 Q 159.603 79.611 156.059 80.919 A 2100.312 2100.312 0 0 1 155.55 81.107 A 1169.47 1169.47 0 0 1 151.424 82.62 Q 149.595 83.287 147.583 84.015 A 2131.303 2131.303 0 0 1 143.375 85.532 Q 138.545 87.268 132.475 89.205 A 497.712 497.712 0 0 1 126.7 91.007 A 258.5 258.5 0 0 1 117.392 93.596 A 187.943 187.943 0 0 1 108.9 95.582 A 94.816 94.816 0 0 1 101.163 96.876 A 71.268 71.268 0 0 1 94.05 97.407 A 43.842 43.842 0 0 1 93.405 97.412 Q 90.357 97.412 87.575 96.982 A 16.476 16.476 0 0 1 82.596 95.404 A 15.535 15.535 0 0 1 81.95 95.057 Q 80.65 94.307 79.6 93.332 A 9.105 9.105 0 0 1 78.25 91.771 A 8.161 8.161 0 0 1 77.9 91.207 Q 77.2 90.057 76.85 88.832 A 15.658 15.658 0 0 1 76.592 87.803 Q 76.477 87.269 76.42 86.785 A 9.219 9.219 0 0 1 76.4 86.607 A 20.249 20.249 0 0 1 76.351 85.408 Q 76.336 83.956 76.55 82.707 Q 76.85 80.957 77.2 79.507 A 81.594 81.594 0 0 1 77.441 78.681 Q 77.706 77.787 77.922 77.149 A 21.54 21.54 0 0 1 78.05 76.782 A 40.121 40.121 0 0 1 78.306 76.09 Q 78.513 75.545 78.7 75.107 A 31.964 31.964 0 0 1 79.069 74.175 Q 79.241 73.762 79.405 73.407 A 13.857 13.857 0 0 1 79.725 72.757 Q 80.182 71.891 80.431 71.488 A 6.397 6.397 0 0 1 80.45 71.457 A 3.163 3.163 0 0 1 81.131 70.647 A 2.757 2.757 0 0 1 82.075 70.132 A 2.644 2.644 0 0 1 82.494 70.035 Q 82.652 70.011 82.805 70.011 A 1.893 1.893 0 0 1 83.9 70.357 A 2.462 2.462 0 0 1 84.784 71.76 A 3.103 3.103 0 0 1 84.8 71.832 A 2.654 2.654 0 0 1 84.862 72.394 Q 84.862 72.98 84.588 73.533 A 2.987 2.987 0 0 1 84.55 73.607 Q 84.361 74.032 84.328 74.1 A 0.503 0.503 0 0 1 84.325 74.107 A 0.228 0.228 0 0 1 84.308 74.135 Q 84.277 74.18 84.207 74.25 A 2.199 2.199 0 0 1 84.2 74.257 A 16.627 16.627 0 0 1 84.077 74.459 Q 83.966 74.638 83.825 74.857 A 141.301 141.301 0 0 0 83.705 75.045 Q 83.513 75.345 83.25 75.757 A 8.394 8.394 0 0 0 82.753 76.563 A 9.694 9.694 0 0 0 82.6 76.857 L 81.9 78.257 A 29.326 29.326 0 0 0 81.5 79.204 Q 81.291 79.723 81.075 80.307 A 20.107 20.107 0 0 0 80.669 81.532 A 26.984 26.984 0 0 0 80.3 82.907 A 16.437 16.437 0 0 0 80.132 83.821 A 19.636 19.636 0 0 0 80.05 84.407 A 13.03 13.03 0 0 0 79.96 85.554 A 15.378 15.378 0 0 0 79.95 86.107 Q 80 87.007 80.175 87.907 Q 80.35 88.807 80.85 89.607 A 6.823 6.823 0 0 0 81.602 90.64 A 8.45 8.45 0 0 0 82.175 91.232 Q 83 92.007 84.15 92.607 Q 85.35 93.207 86.75 93.582 A 21.189 21.189 0 0 0 88.77 94.015 A 24.894 24.894 0 0 0 89.75 94.157 A 31.644 31.644 0 0 0 93.043 94.436 A 36.845 36.845 0 0 0 94.3 94.457 A 50.907 50.907 0 0 0 97.868 94.327 A 59.963 59.963 0 0 0 99.575 94.182 A 94.782 94.782 0 0 0 103.19 93.751 A 115.796 115.796 0 0 0 105.5 93.407 Q 110 92.657 115.2 91.357 A 287.479 287.479 0 0 0 124.53 88.852 A 317.358 317.358 0 0 0 125.9 88.457 A 326.029 326.029 0 0 0 132.864 86.251 A 297.198 297.198 0 0 0 133.825 85.932 A 294.075 294.075 0 0 0 137.55 84.663 A 252.892 252.892 0 0 0 141.075 83.407 A 528.187 528.187 0 0 0 144.381 82.188 A 425.715 425.715 0 0 0 147.45 81.032 A 804.99 804.99 0 0 0 149.907 80.091 Q 151.031 79.658 152.04 79.265 A 473.189 473.189 0 0 0 152.7 79.007 A 388.152 388.152 0 0 0 155.947 77.706 Q 157.231 77.185 158.401 76.698 A 220.633 220.633 0 0 0 160.625 75.757 Q 163.644 74.46 165.643 73.563 A 166.485 166.485 0 0 0 166.1 73.357 L 166.05 73.357 Q 168.55 72.207 169.85 71.532 A 270.386 270.386 0 0 1 170.469 71.212 Q 171.35 70.757 171.95 70.457 A 69.545 69.545 0 0 1 172.451 70.209 Q 172.681 70.096 172.889 69.997 A 41.012 41.012 0 0 1 173.025 69.932 A 21.203 21.203 0 0 1 173.531 69.701 A 29.143 29.143 0 0 1 174.1 69.457 Q 175.15 69.057 176.125 69.357 A 2.431 2.431 0 0 1 176.845 69.708 A 2.045 2.045 0 0 1 177.5 70.507 A 1.911 1.911 0 0 1 177.688 71.329 Q 177.688 71.626 177.595 71.934 A 2.694 2.694 0 0 1 177.45 72.307 Q 177 73.257 176 73.707 A 8.995 8.995 0 0 0 175.881 73.756 Q 175.713 73.826 175.6 73.882 Q 175.497 73.933 175.348 73.973 A 2.466 2.466 0 0 1 175.2 74.007 Z M 257.2 85.257 L 257.2 85.307 L 256.75 85.907 Q 256.65 86.057 256.525 86.182 Q 256.4 86.307 256.3 86.457 A 3.503 3.503 0 0 1 256.093 86.707 A 4.218 4.218 0 0 1 255.95 86.857 Q 255.75 87.057 255.6 87.257 A 91.984 91.984 0 0 1 254.718 88.279 Q 254.217 88.851 253.65 89.482 Q 252.55 90.707 251.1 92.057 Q 250.25 92.907 249.025 93.882 Q 247.8 94.857 246.4 95.707 A 12.192 12.192 0 0 1 245.689 96.129 Q 245.309 96.338 244.875 96.547 A 20.212 20.212 0 0 1 244.75 96.607 Q 243.8 97.057 242.85 97.357 A 7.036 7.036 0 0 1 240.824 97.795 A 7.981 7.981 0 0 1 240.6 97.807 Q 240.4 97.857 240.2 97.857 L 239.9 97.857 Q 239.677 97.857 239.509 97.83 A 1.367 1.367 0 0 1 239.4 97.807 L 239.25 97.807 Q 238.35 97.757 237.6 97.357 L 237.65 97.357 A 5.971 5.971 0 0 1 236.148 96.341 A 5.302 5.302 0 0 1 235.375 95.432 A 9.312 9.312 0 0 1 234.564 93.971 A 7.689 7.689 0 0 1 234.2 92.957 A 12.112 12.112 0 0 1 233.863 91.576 A 9.962 9.962 0 0 1 233.75 90.757 Q 233.65 89.707 233.6 88.707 Q 233.6 87.657 233.675 86.707 Q 233.75 85.757 233.85 84.907 A 20.912 20.912 0 0 1 234.072 83.522 A 23.357 23.357 0 0 1 234.125 83.257 Q 234.3 82.407 234.55 81.557 L 234.55 81.607 A 17.463 17.463 0 0 1 235.2 79.662 A 14.491 14.491 0 0 1 235.675 78.607 A 15.27 15.27 0 0 1 236.837 76.65 A 13.565 13.565 0 0 1 237.2 76.157 A 16.42 16.42 0 0 1 238.282 74.89 A 13.518 13.518 0 0 1 238.95 74.232 Q 239.85 73.407 240.7 72.807 L 240.65 72.857 A 22.532 22.532 0 0 1 241.879 72.045 Q 242.866 71.442 243.725 71.082 A 41.076 41.076 0 0 1 244.658 70.704 Q 245.05 70.552 245.398 70.428 A 18.534 18.534 0 0 1 246.05 70.207 A 58.014 58.014 0 0 1 246.52 70.068 Q 247.181 69.876 247.575 69.782 Q 248.1 69.657 248.35 69.607 A 3.022 3.022 0 0 1 248.817 69.562 Q 249.692 69.547 250.425 70.082 A 2.576 2.576 0 0 1 250.952 70.585 A 1.869 1.869 0 0 1 251.35 71.757 Q 251.35 72.707 250.725 73.382 A 2.897 2.897 0 0 1 249.181 74.25 A 3.53 3.53 0 0 1 249.15 74.257 Q 249.072 74.257 248.935 74.272 A 5.489 5.489 0 0 0 248.85 74.282 A 5.376 5.376 0 0 1 248.756 74.293 Q 248.658 74.304 248.592 74.306 A 1.051 1.051 0 0 1 248.55 74.307 A 0.101 0.101 0 0 1 248.516 74.328 Q 248.441 74.357 248.25 74.357 Q 248 74.357 247.75 74.407 Q 247.661 74.407 247.612 74.427 A 0.155 0.155 0 0 0 247.6 74.432 A 0.187 0.187 0 0 1 247.564 74.445 Q 247.525 74.455 247.469 74.457 A 0.744 0.744 0 0 1 247.45 74.457 A 13.397 13.397 0 0 0 246.632 74.657 Q 245.721 74.908 244.522 75.344 A 44.252 44.252 0 0 0 244.35 75.407 A 8.277 8.277 0 0 0 243.638 75.722 A 10.977 10.977 0 0 0 242.975 76.082 A 9.51 9.51 0 0 0 241.902 76.818 A 10.972 10.972 0 0 0 241.55 77.107 A 9.919 9.919 0 0 0 240.794 77.782 Q 240.413 78.157 240.025 78.607 A 8.263 8.263 0 0 0 239.219 79.729 A 10.984 10.984 0 0 0 238.65 80.807 A 10.773 10.773 0 0 0 237.902 82.569 A 13.3 13.3 0 0 0 237.575 83.757 Q 237.2 85.407 237 87.407 Q 236.85 88.457 236.85 89.357 A 10.918 10.918 0 0 0 236.982 91.079 A 9.806 9.806 0 0 0 237.05 91.457 Q 237.2 92.407 237.625 93.307 Q 238.05 94.207 238.95 94.657 L 238.9 94.657 A 2.203 2.203 0 0 0 239.424 94.837 Q 239.669 94.889 239.954 94.903 A 4.209 4.209 0 0 0 240.15 94.907 A 5.545 5.545 0 0 0 241.417 94.753 A 7.581 7.581 0 0 0 242.5 94.407 A 14.383 14.383 0 0 0 243.562 93.99 A 11.365 11.365 0 0 0 244.3 93.632 A 21.625 21.625 0 0 0 245.444 92.981 A 19.038 19.038 0 0 0 245.8 92.757 Q 247.1 91.907 248.225 90.807 A 86.477 86.477 0 0 0 249.563 89.471 A 70.901 70.901 0 0 0 250.3 88.707 A 52.228 52.228 0 0 0 251.004 87.917 Q 251.347 87.524 251.641 87.169 A 26.983 26.983 0 0 0 251.975 86.757 Q 252.65 85.907 253.2 85.157 Q 253.6 84.657 253.85 84.257 Q 254.1 83.857 254.3 83.507 L 254.5 83.207 L 254.7 82.907 L 254.65 82.957 A 1.923 1.923 0 0 1 254.699 82.865 Q 254.724 82.821 254.749 82.783 A 1.156 1.156 0 0 1 254.75 82.782 Q 254.8 82.707 254.85 82.607 L 254.75 83.057 A 0.077 0.077 0 0 1 254.762 83.015 Q 254.774 82.995 254.8 82.982 Q 254.85 82.957 254.85 82.907 L 256 81.807 L 256.4 81.707 A 26.879 26.879 0 0 1 258.207 81.59 A 29.755 29.755 0 0 1 258.475 81.582 A 91.802 91.802 0 0 1 260.045 81.559 A 82.276 82.276 0 0 1 260.55 81.557 Q 261.15 81.557 261.75 81.582 Q 262.35 81.607 263.05 81.607 L 264.725 81.607 A 34.914 34.914 0 0 1 265.868 81.627 A 42.68 42.68 0 0 1 266.6 81.657 A 82.994 82.994 0 0 0 267.556 81.691 Q 268.4 81.717 269.4 81.732 Q 271 81.757 272.65 81.757 A 98.837 98.837 0 0 0 275.58 81.681 Q 276.975 81.623 278.181 81.524 A 45.767 45.767 0 0 0 279.65 81.382 Q 282.311 81.079 284.449 80.71 A 59.878 59.878 0 0 0 284.75 80.657 Q 287.2 80.207 289.125 79.757 Q 291.05 79.307 293.2 78.757 Q 296.45 77.857 299.525 76.782 Q 302.6 75.707 304.6 74.907 A 107.884 107.884 0 0 0 305.839 74.403 Q 306.324 74.202 306.758 74.016 A 55.335 55.335 0 0 0 307.575 73.657 Q 308.8 73.107 309.75 72.657 Q 309.85 72.607 309.975 72.557 A 2.156 2.156 0 0 0 310.048 72.526 Q 310.175 72.47 310.4 72.357 Q 311.35 71.882 311.984 71.542 A 33.368 33.368 0 0 0 312.05 71.507 A 54.602 54.602 0 0 1 312.59 71.22 Q 312.919 71.048 313.2 70.907 L 313.15 70.957 Q 313.65 70.707 314.05 70.482 Q 314.394 70.289 314.848 70.077 A 17.632 17.632 0 0 1 315 70.007 A 3.175 3.175 0 0 1 315.773 69.802 Q 316.379 69.724 316.975 69.907 A 2.431 2.431 0 0 1 317.695 70.258 A 2.045 2.045 0 0 1 318.35 71.057 Q 318.684 71.768 318.46 72.548 A 2.775 2.775 0 0 1 318.35 72.857 A 2.597 2.597 0 0 1 317.042 74.214 A 3.351 3.351 0 0 1 316.95 74.257 Q 316.821 74.3 316.655 74.343 A 6.667 6.667 0 0 1 316.6 74.357 A 2.852 2.852 0 0 0 316.495 74.385 Q 316.395 74.415 316.328 74.444 A 0.654 0.654 0 0 0 316.3 74.457 A 2.969 2.969 0 0 1 316.14 74.515 Q 315.909 74.592 315.55 74.682 Q 315.05 74.807 313.65 75.307 A 36.74 36.74 0 0 1 313.109 75.518 Q 312.238 75.851 311 76.282 Q 309.866 76.677 308.424 77.179 A 10065.556 10065.556 0 0 1 307.05 77.657 Q 305.4 78.207 303.336 78.863 A 445.228 445.228 0 0 1 301.375 79.482 A 115.588 115.588 0 0 1 298.747 80.268 Q 296.413 80.938 293.6 81.657 A 87.17 87.17 0 0 1 293.019 81.813 A 117.843 117.843 0 0 1 292.375 81.982 A 165.898 165.898 0 0 1 291.719 82.151 A 138.57 138.57 0 0 1 291.1 82.307 Q 289.2 82.807 286.95 83.357 Q 284.7 83.907 282.3 84.357 Q 279.1 84.957 275.3 85.407 Q 272.191 85.775 268.814 85.775 A 63.609 63.609 0 0 1 267.3 85.757 Q 265.444 85.723 263.942 85.665 A 102.644 102.644 0 0 1 262.65 85.607 Q 260.7 85.507 259.2 85.407 Q 258.508 85.358 258.036 85.357 A 8.953 8.953 0 0 0 258.025 85.357 Q 257.605 85.357 257.283 85.279 A 2.123 2.123 0 0 1 257.2 85.257 Z M 620.85 85.257 L 620.85 85.307 L 620.4 85.907 Q 620.3 86.057 620.175 86.182 Q 620.05 86.307 619.95 86.457 A 3.503 3.503 0 0 1 619.743 86.707 A 4.218 4.218 0 0 1 619.6 86.857 Q 619.4 87.057 619.25 87.257 A 91.984 91.984 0 0 1 618.368 88.279 Q 617.867 88.851 617.3 89.482 Q 616.2 90.707 614.75 92.057 Q 613.9 92.907 612.675 93.882 Q 611.45 94.857 610.05 95.707 A 12.192 12.192 0 0 1 609.339 96.129 Q 608.959 96.338 608.525 96.547 A 20.212 20.212 0 0 1 608.4 96.607 Q 607.45 97.057 606.5 97.357 A 7.036 7.036 0 0 1 604.474 97.795 A 7.981 7.981 0 0 1 604.25 97.807 Q 604.05 97.857 603.85 97.857 L 603.55 97.857 Q 603.327 97.857 603.159 97.83 A 1.367 1.367 0 0 1 603.05 97.807 L 602.9 97.807 Q 602 97.757 601.25 97.357 L 601.3 97.357 A 5.971 5.971 0 0 1 599.798 96.341 A 5.302 5.302 0 0 1 599.025 95.432 A 9.312 9.312 0 0 1 598.214 93.971 A 7.689 7.689 0 0 1 597.85 92.957 A 12.112 12.112 0 0 1 597.513 91.576 A 9.962 9.962 0 0 1 597.4 90.757 Q 597.3 89.707 597.25 88.707 Q 597.25 87.657 597.325 86.707 Q 597.4 85.757 597.5 84.907 A 20.912 20.912 0 0 1 597.722 83.522 A 23.357 23.357 0 0 1 597.775 83.257 Q 597.95 82.407 598.2 81.557 L 598.2 81.607 A 17.463 17.463 0 0 1 598.85 79.662 A 14.491 14.491 0 0 1 599.325 78.607 A 15.27 15.27 0 0 1 600.487 76.65 A 13.565 13.565 0 0 1 600.85 76.157 A 16.42 16.42 0 0 1 601.932 74.89 A 13.518 13.518 0 0 1 602.6 74.232 Q 603.5 73.407 604.35 72.807 L 604.3 72.857 A 22.532 22.532 0 0 1 605.529 72.045 Q 606.516 71.442 607.375 71.082 A 41.076 41.076 0 0 1 608.308 70.704 Q 608.7 70.552 609.048 70.428 A 18.534 18.534 0 0 1 609.7 70.207 A 58.014 58.014 0 0 1 610.17 70.068 Q 610.831 69.876 611.225 69.782 Q 611.75 69.657 612 69.607 A 3.022 3.022 0 0 1 612.467 69.562 Q 613.342 69.547 614.075 70.082 A 2.576 2.576 0 0 1 614.602 70.585 A 1.869 1.869 0 0 1 615 71.757 Q 615 72.707 614.375 73.382 A 2.897 2.897 0 0 1 612.831 74.25 A 3.53 3.53 0 0 1 612.8 74.257 Q 612.722 74.257 612.585 74.272 A 5.489 5.489 0 0 0 612.5 74.282 A 5.376 5.376 0 0 1 612.406 74.293 Q 612.308 74.304 612.242 74.306 A 1.051 1.051 0 0 1 612.2 74.307 A 0.101 0.101 0 0 1 612.166 74.328 Q 612.091 74.357 611.9 74.357 Q 611.65 74.357 611.4 74.407 Q 611.311 74.407 611.262 74.427 A 0.155 0.155 0 0 0 611.25 74.432 A 0.187 0.187 0 0 1 611.214 74.445 Q 611.175 74.455 611.119 74.457 A 0.744 0.744 0 0 1 611.1 74.457 A 13.397 13.397 0 0 0 610.282 74.657 Q 609.371 74.908 608.172 75.344 A 44.252 44.252 0 0 0 608 75.407 A 8.277 8.277 0 0 0 607.288 75.722 A 10.977 10.977 0 0 0 606.625 76.082 A 9.51 9.51 0 0 0 605.552 76.818 A 10.972 10.972 0 0 0 605.2 77.107 A 9.919 9.919 0 0 0 604.444 77.782 Q 604.063 78.157 603.675 78.607 A 8.263 8.263 0 0 0 602.869 79.729 A 10.984 10.984 0 0 0 602.3 80.807 A 10.773 10.773 0 0 0 601.552 82.569 A 13.3 13.3 0 0 0 601.225 83.757 Q 600.85 85.407 600.65 87.407 Q 600.5 88.457 600.5 89.357 A 10.918 10.918 0 0 0 600.632 91.079 A 9.806 9.806 0 0 0 600.7 91.457 Q 600.85 92.407 601.275 93.307 Q 601.7 94.207 602.6 94.657 L 602.55 94.657 A 2.203 2.203 0 0 0 603.074 94.837 Q 603.319 94.889 603.604 94.903 A 4.209 4.209 0 0 0 603.8 94.907 A 5.545 5.545 0 0 0 605.067 94.753 A 7.581 7.581 0 0 0 606.15 94.407 A 14.383 14.383 0 0 0 607.212 93.99 A 11.365 11.365 0 0 0 607.95 93.632 A 21.625 21.625 0 0 0 609.094 92.981 A 19.038 19.038 0 0 0 609.45 92.757 Q 610.75 91.907 611.875 90.807 A 86.477 86.477 0 0 0 613.213 89.471 A 70.901 70.901 0 0 0 613.95 88.707 A 52.228 52.228 0 0 0 614.654 87.917 Q 614.997 87.524 615.291 87.169 A 26.983 26.983 0 0 0 615.625 86.757 Q 616.3 85.907 616.85 85.157 Q 617.25 84.657 617.5 84.257 Q 617.75 83.857 617.95 83.507 L 618.15 83.207 L 618.35 82.907 L 618.3 82.957 A 1.923 1.923 0 0 1 618.349 82.865 Q 618.374 82.821 618.399 82.783 A 1.156 1.156 0 0 1 618.4 82.782 Q 618.45 82.707 618.5 82.607 L 618.4 83.057 A 0.077 0.077 0 0 1 618.412 83.015 Q 618.424 82.995 618.45 82.982 Q 618.5 82.957 618.5 82.907 L 619.65 81.807 L 620.05 81.707 A 26.879 26.879 0 0 1 621.857 81.59 A 29.755 29.755 0 0 1 622.125 81.582 A 91.802 91.802 0 0 1 623.695 81.559 A 82.276 82.276 0 0 1 624.2 81.557 Q 624.8 81.557 625.4 81.582 Q 626 81.607 626.7 81.607 L 628.375 81.607 A 34.914 34.914 0 0 1 629.518 81.627 A 42.68 42.68 0 0 1 630.25 81.657 A 82.994 82.994 0 0 0 631.206 81.691 Q 632.05 81.717 633.05 81.732 Q 634.65 81.757 636.3 81.757 A 98.837 98.837 0 0 0 639.23 81.681 Q 640.625 81.623 641.831 81.524 A 45.767 45.767 0 0 0 643.3 81.382 Q 645.961 81.079 648.099 80.71 A 59.878 59.878 0 0 0 648.4 80.657 Q 650.85 80.207 652.775 79.757 Q 654.7 79.307 656.85 78.757 Q 660.1 77.857 663.175 76.782 Q 666.25 75.707 668.25 74.907 A 107.884 107.884 0 0 0 669.489 74.403 Q 669.974 74.202 670.408 74.016 A 55.335 55.335 0 0 0 671.225 73.657 Q 672.45 73.107 673.4 72.657 Q 673.5 72.607 673.625 72.557 A 2.156 2.156 0 0 0 673.698 72.526 Q 673.825 72.47 674.05 72.357 Q 675 71.882 675.634 71.542 A 33.368 33.368 0 0 0 675.7 71.507 A 54.602 54.602 0 0 1 676.24 71.22 Q 676.569 71.048 676.85 70.907 L 676.8 70.957 Q 677.3 70.707 677.7 70.482 Q 678.044 70.289 678.498 70.077 A 17.632 17.632 0 0 1 678.65 70.007 A 3.175 3.175 0 0 1 679.423 69.802 Q 680.029 69.724 680.625 69.907 A 2.431 2.431 0 0 1 681.345 70.258 A 2.045 2.045 0 0 1 682 71.057 Q 682.334 71.768 682.11 72.548 A 2.775 2.775 0 0 1 682 72.857 A 2.597 2.597 0 0 1 680.692 74.214 A 3.351 3.351 0 0 1 680.6 74.257 Q 680.471 74.3 680.305 74.343 A 6.667 6.667 0 0 1 680.25 74.357 A 2.852 2.852 0 0 0 680.145 74.385 Q 680.045 74.415 679.978 74.444 A 0.654 0.654 0 0 0 679.95 74.457 A 2.969 2.969 0 0 1 679.79 74.515 Q 679.559 74.592 679.2 74.682 Q 678.7 74.807 677.3 75.307 A 36.74 36.74 0 0 1 676.759 75.518 Q 675.888 75.851 674.65 76.282 Q 673.516 76.677 672.074 77.179 A 10065.556 10065.556 0 0 1 670.7 77.657 Q 669.05 78.207 666.986 78.863 A 445.228 445.228 0 0 1 665.025 79.482 A 115.588 115.588 0 0 1 662.397 80.268 Q 660.063 80.938 657.25 81.657 A 87.17 87.17 0 0 1 656.669 81.813 A 117.843 117.843 0 0 1 656.025 81.982 A 165.898 165.898 0 0 1 655.369 82.151 A 138.57 138.57 0 0 1 654.75 82.307 Q 652.85 82.807 650.6 83.357 Q 648.35 83.907 645.95 84.357 Q 642.75 84.957 638.95 85.407 Q 635.841 85.775 632.464 85.775 A 63.609 63.609 0 0 1 630.95 85.757 Q 629.094 85.723 627.592 85.665 A 102.644 102.644 0 0 1 626.3 85.607 Q 624.35 85.507 622.85 85.407 Q 622.158 85.358 621.686 85.357 A 8.953 8.953 0 0 0 621.675 85.357 Q 621.255 85.357 620.933 85.279 A 2.123 2.123 0 0 1 620.85 85.257 Z M 393.05 69.457 L 393.1 69.407 Q 394.25 69.157 395.125 69.707 A 2.263 2.263 0 0 1 395.801 70.343 A 2.163 2.163 0 0 1 396.15 71.257 A 2.395 2.395 0 0 1 396.18 71.606 Q 396.187 72.336 395.716 72.937 A 2.585 2.585 0 0 1 395.7 72.957 A 2.846 2.846 0 0 1 394.239 73.92 A 3.555 3.555 0 0 1 394.1 73.957 L 394.15 73.957 A 2.502 2.502 0 0 1 394.033 74.001 Q 393.918 74.04 393.837 74.052 A 0.433 0.433 0 0 1 393.775 74.057 L 393.45 74.057 Q 393.2 74.057 392.65 74.107 Q 392.232 74.145 391.468 74.299 A 33.361 33.361 0 0 0 390.95 74.407 A 0.963 0.963 0 0 1 390.725 74.488 A 0.817 0.817 0 0 1 390.55 74.507 Q 389.7 74.757 388.375 75.207 A 8.766 8.766 0 0 0 387.345 75.639 Q 386.817 75.897 386.236 76.25 A 20.39 20.39 0 0 0 385.3 76.857 Q 384.45 77.407 383.625 78.282 A 5.591 5.591 0 0 0 382.668 79.686 A 7.005 7.005 0 0 0 382.35 80.457 A 5.669 5.669 0 0 0 382.05 82.229 A 5.403 5.403 0 0 0 382.05 82.257 Q 382.05 84.377 383.21 86.728 A 14.895 14.895 0 0 0 383.3 86.907 Q 384.15 88.657 386.3 90.057 Q 387.4 90.757 388.625 91.382 Q 389.85 92.007 391.3 92.407 A 32.961 32.961 0 0 0 395.267 93.449 A 39.927 39.927 0 0 0 397.525 93.832 A 59.41 59.41 0 0 0 401.949 94.279 A 72.742 72.742 0 0 0 404.8 94.407 Q 407.2 94.457 408.95 94.332 A 1514.724 1514.724 0 0 1 410.625 94.213 A 1142.258 1142.258 0 0 1 412.15 94.107 L 412.4 94.107 Q 413.85 94.007 415.075 93.882 Q 416.3 93.757 417.75 93.507 A 76.621 76.621 0 0 0 419.641 93.156 A 93.903 93.903 0 0 0 420.85 92.907 A 66.69 66.69 0 0 0 422.38 92.563 Q 423.419 92.317 424.6 92.007 L 424.55 92.007 A 65.54 65.54 0 0 0 426.295 91.463 Q 427.062 91.213 427.894 90.924 A 115.174 115.174 0 0 0 429.625 90.307 A 67.055 67.055 0 0 0 431.911 89.421 Q 433.925 88.601 436.3 87.507 Q 440.1 85.657 443.15 83.907 Q 446.2 82.157 448.6 80.557 A 102.786 102.786 0 0 0 450.411 79.396 Q 451.389 78.753 452.234 78.16 A 55.022 55.022 0 0 0 452.975 77.632 A 101.866 101.866 0 0 0 454.27 76.677 Q 454.906 76.2 455.462 75.764 A 54.286 54.286 0 0 0 456.1 75.257 A 224.48 224.48 0 0 0 457.336 74.318 Q 459.015 73.033 459.93 72.27 A 31.467 31.467 0 0 0 459.975 72.232 Q 460.982 71.389 461.466 70.969 A 22.799 22.799 0 0 0 461.65 70.807 A 2.794 2.794 0 0 1 462.512 70.314 Q 462.912 70.175 463.349 70.175 A 2.826 2.826 0 0 1 463.55 70.182 A 2.707 2.707 0 0 1 464.24 70.317 A 1.929 1.929 0 0 1 465.15 70.957 A 1.986 1.986 0 0 1 465.629 72.246 Q 465.634 72.468 465.6 72.707 Q 465.45 73.757 464.6 74.457 Q 464.35 74.657 463.925 74.932 A 18.662 18.662 0 0 0 463.677 75.096 Q 463.295 75.352 462.655 75.799 A 150.861 150.861 0 0 0 462.5 75.907 A 51.584 51.584 0 0 1 462.138 76.146 Q 461.816 76.357 461.425 76.607 Q 460.888 76.951 460.222 77.405 A 73.272 73.272 0 0 0 460 77.557 Q 459.55 77.807 459.075 78.132 A 38.694 38.694 0 0 0 458.581 78.476 A 49.686 49.686 0 0 0 458.05 78.857 Q 456.937 79.535 455.567 80.399 A 253.879 253.879 0 0 0 455.475 80.457 Q 454.05 81.357 452.3 82.457 Q 449.6 84.057 446.025 86.032 A 91.551 91.551 0 0 1 442.643 87.803 Q 440.306 88.97 437.55 90.207 A 145.964 145.964 0 0 1 434.272 91.588 Q 431.684 92.638 429.575 93.357 A 337.292 337.292 0 0 1 427.16 94.17 Q 426.202 94.489 425.324 94.773 A 191.147 191.147 0 0 1 423.65 95.307 A 129.691 129.691 0 0 1 421.822 95.831 Q 421.095 96.033 420.427 96.208 A 74.562 74.562 0 0 1 419.15 96.532 Q 417.2 97.007 415.6 97.407 Q 414.1 97.757 412.55 97.957 Q 411 98.157 409.1 98.357 Q 408.066 98.472 406.74 98.499 A 41.43 41.43 0 0 1 405.9 98.507 A 37.623 37.623 0 0 1 404.019 98.458 A 44.808 44.808 0 0 1 402.825 98.382 A 40.071 40.071 0 0 1 400.91 98.186 A 51.331 51.331 0 0 1 399.3 97.957 A 50.01 50.01 0 0 1 395.967 97.312 Q 394.461 96.964 393.151 96.545 A 27.938 27.938 0 0 1 392.3 96.257 Q 390.041 95.453 388.34 94.649 A 26.279 26.279 0 0 1 387.35 94.157 A 26.507 26.507 0 0 1 386.133 93.474 A 31.845 31.845 0 0 1 385.375 93.007 A 15.971 15.971 0 0 1 384.185 92.178 A 13.09 13.09 0 0 1 383.55 91.657 A 11.797 11.797 0 0 1 382.052 90.26 A 13.213 13.213 0 0 1 381.85 90.032 A 7.713 7.713 0 0 1 380.928 88.693 A 9.656 9.656 0 0 1 380.5 87.807 L 380.5 87.857 A 14.534 14.534 0 0 1 379.338 84.884 A 11.475 11.475 0 0 1 378.95 81.957 A 10.308 10.308 0 0 1 378.985 81.084 Q 379.022 80.658 379.095 80.281 A 6.33 6.33 0 0 1 379.1 80.257 A 10.333 10.333 0 0 1 379.672 78.478 A 8.309 8.309 0 0 1 380.35 77.207 A 14.279 14.279 0 0 1 381.158 76.087 Q 381.592 75.546 382.038 75.116 A 8.573 8.573 0 0 1 382.1 75.057 Q 383.75 73.557 385.2 72.732 A 81.78 81.78 0 0 1 385.897 72.34 Q 386.9 71.782 387.65 71.407 Q 387.8 71.407 387.95 71.257 Q 388.889 70.855 389.528 70.592 A 56.466 56.466 0 0 1 389.675 70.532 A 41.012 41.012 0 0 1 390.309 70.28 Q 390.611 70.162 390.883 70.064 A 25.261 25.261 0 0 1 390.9 70.057 A 11.406 11.406 0 0 1 391.568 69.836 A 9.421 9.421 0 0 1 391.95 69.732 L 393.05 69.457 Z M 470.45 58.207 A 86.655 86.655 0 0 0 469.659 60.382 A 100.7 100.7 0 0 0 469.35 61.282 Q 468.8 62.907 468.25 64.757 A 55.784 55.784 0 0 0 469.484 63.439 Q 470.659 62.146 472.1 60.432 A 55.194 55.194 0 0 0 473.808 58.287 Q 474.609 57.231 475.482 55.999 A 124.794 124.794 0 0 0 477.3 53.357 Q 480.3 48.857 483.95 41.907 Q 487.6 34.957 491.15 25.757 A 85.387 85.387 0 0 0 492.804 20.928 A 94.44 94.44 0 0 0 493.025 20.207 Q 493.9 17.307 494.6 14.457 A 45.318 45.318 0 0 0 495.083 12.198 A 51.435 51.435 0 0 0 495.225 11.407 Q 495.5 9.807 495.7 8.157 Q 495.9 6.507 495.85 4.907 Q 495.85 4.567 495.781 4.112 A 9.989 9.989 0 0 0 495.7 3.657 A 3.373 3.373 0 0 0 495.394 3.958 Q 495.246 4.121 495.098 4.32 A 6.136 6.136 0 0 0 495 4.457 A 17.645 17.645 0 0 0 494.592 4.977 Q 494.388 5.246 494.171 5.55 A 30 30 0 0 0 494.025 5.757 A 50.821 50.821 0 0 0 493.257 6.887 A 59.027 59.027 0 0 0 492.95 7.357 Q 491.95 8.957 491 10.682 Q 490.05 12.407 489.15 14.157 Q 487.25 17.807 485.45 21.707 Q 483.65 25.607 481.75 29.857 A 407.889 407.889 0 0 0 480.093 33.68 Q 478.8 36.707 477.8 39.207 Q 476.225 43.144 474.941 46.305 A 1035.502 1035.502 0 0 1 474.9 46.407 Q 474.814 46.622 474.765 46.8 A 2.485 2.485 0 0 0 474.75 46.857 Q 474.7 47.057 474.6 47.257 A 1546.016 1546.016 0 0 1 472.992 51.406 A 1368.586 1368.586 0 0 1 472.475 52.732 A 165.665 165.665 0 0 0 470.7 57.498 A 183.648 183.648 0 0 0 470.45 58.207 Z M 544.9 58.207 A 86.655 86.655 0 0 0 544.109 60.382 A 100.7 100.7 0 0 0 543.8 61.282 Q 543.25 62.907 542.7 64.757 A 55.784 55.784 0 0 0 543.934 63.439 Q 545.109 62.146 546.55 60.432 A 55.194 55.194 0 0 0 548.258 58.287 Q 549.059 57.231 549.932 55.999 A 124.794 124.794 0 0 0 551.75 53.357 Q 554.75 48.857 558.4 41.907 Q 562.05 34.957 565.6 25.757 A 85.387 85.387 0 0 0 567.254 20.928 A 94.44 94.44 0 0 0 567.475 20.207 Q 568.35 17.307 569.05 14.457 A 45.318 45.318 0 0 0 569.533 12.198 A 51.435 51.435 0 0 0 569.675 11.407 Q 569.95 9.807 570.15 8.157 Q 570.35 6.507 570.3 4.907 Q 570.3 4.567 570.231 4.112 A 9.989 9.989 0 0 0 570.15 3.657 A 3.373 3.373 0 0 0 569.844 3.958 Q 569.696 4.121 569.548 4.32 A 6.136 6.136 0 0 0 569.45 4.457 A 17.645 17.645 0 0 0 569.042 4.977 Q 568.838 5.246 568.621 5.55 A 30 30 0 0 0 568.475 5.757 A 50.821 50.821 0 0 0 567.707 6.887 A 59.027 59.027 0 0 0 567.4 7.357 Q 566.4 8.957 565.45 10.682 Q 564.5 12.407 563.6 14.157 Q 561.7 17.807 559.9 21.707 Q 558.1 25.607 556.2 29.857 A 407.889 407.889 0 0 0 554.543 33.68 Q 553.25 36.707 552.25 39.207 Q 550.675 43.144 549.391 46.305 A 1035.502 1035.502 0 0 1 549.35 46.407 Q 549.264 46.622 549.215 46.8 A 2.485 2.485 0 0 0 549.2 46.857 Q 549.15 47.057 549.05 47.257 A 1546.016 1546.016 0 0 1 547.442 51.406 A 1368.586 1368.586 0 0 1 546.925 52.732 A 165.665 165.665 0 0 0 545.15 57.498 A 183.648 183.648 0 0 0 544.9 58.207 Z M 89.1 41.357 L 89 41.307 Q 89.286 41.389 90.056 41.471 A 28.695 28.695 0 0 0 90.425 41.507 A 15.303 15.303 0 0 0 91.056 41.55 Q 92.177 41.607 94.25 41.607 Q 96.293 41.607 99.397 41.517 A 333.551 333.551 0 0 0 99.725 41.507 Q 102.97 41.41 107.809 41.122 A 499.357 499.357 0 0 0 108.05 41.107 Q 112.1 40.857 114.625 40.607 A 139.688 139.688 0 0 0 115.822 40.484 Q 116.989 40.358 117.876 40.239 A 42.136 42.136 0 0 0 118.625 40.132 Q 120.073 39.911 120.774 39.739 A 7.673 7.673 0 0 0 120.8 39.732 A 14.258 14.258 0 0 0 121.128 39.646 Q 121.48 39.549 121.716 39.461 A 3.148 3.148 0 0 0 121.85 39.407 Q 122.297 39.273 122.665 39.219 A 3.91 3.91 0 0 1 122.75 39.207 Q 123.05 39.107 123.425 39.007 A 1.707 1.707 0 0 1 123.687 38.958 Q 123.763 38.95 123.837 38.95 A 1.276 1.276 0 0 1 124.125 38.982 A 0.978 0.978 0 0 1 124.545 39.199 A 1.322 1.322 0 0 1 124.7 39.357 A 0.974 0.974 0 0 1 124.847 39.607 Q 124.95 39.855 124.989 40.231 A 4 4 0 0 1 125 40.357 Q 125.022 40.759 124.92 41.086 A 1.557 1.557 0 0 1 124.475 41.782 A 2.713 2.713 0 0 1 123.981 42.134 Q 123.469 42.424 122.7 42.632 A 13.956 13.956 0 0 1 121.712 42.858 Q 120.816 43.032 119.675 43.157 A 68.679 68.679 0 0 1 118.218 43.3 Q 117.575 43.357 116.87 43.409 A 121.15 121.15 0 0 1 115.4 43.507 Q 113.578 43.645 111.319 43.806 A 1548.734 1548.734 0 0 1 109.175 43.957 A 128.51 128.51 0 0 0 105.506 44.27 Q 103.573 44.461 101.436 44.722 A 209.1 209.1 0 0 0 101.15 44.757 A 95.129 95.129 0 0 1 100.375 44.851 A 77.637 77.637 0 0 1 99.65 44.932 Q 98.95 45.007 98.25 45.107 A 226.711 226.711 0 0 1 96.906 45.271 Q 94.975 45.501 93.55 45.632 A 55.188 55.188 0 0 1 92.431 45.724 Q 91.284 45.806 90.463 45.807 A 16.304 16.304 0 0 1 90.45 45.807 A 10.758 10.758 0 0 1 89.6 45.776 Q 88.789 45.712 88.287 45.513 A 1.818 1.818 0 0 1 87.9 45.307 Q 87.2 44.807 87.1 43.657 A 3.596 3.596 0 0 1 87.082 43.347 Q 87.077 42.935 87.174 42.58 A 2.235 2.235 0 0 1 87.45 41.957 A 2.141 2.141 0 0 1 87.707 41.627 Q 88.064 41.257 88.5 41.257 L 88.725 41.257 Q 88.85 41.257 89.1 41.357 Z M 365.25 47.107 L 364.65 48.757 Q 366.4 46.007 367.95 43.057 A 62.594 62.594 0 0 0 370.471 37.627 A 68.866 68.866 0 0 0 370.8 36.807 A 50.726 50.726 0 0 0 371.62 34.366 A 64.575 64.575 0 0 0 372.225 32.282 A 63.063 63.063 0 0 0 373.272 27.779 A 69.874 69.874 0 0 0 373.4 27.107 Q 373.2 27.557 373.025 27.982 Q 372.85 28.407 372.65 28.807 Q 370.5 33.657 368.9 37.782 Q 367.3 41.907 365.9 45.507 Q 365.75 45.857 365.55 46.282 A 4.867 4.867 0 0 0 365.34 46.8 A 4.005 4.005 0 0 0 365.25 47.107 Z M 306 94.657 L 306.4 94.857 A 5.081 5.081 0 0 0 306.732 94.409 A 6.032 6.032 0 0 0 306.875 94.182 Q 307.1 93.807 307.3 93.407 A 2.842 2.842 0 0 1 307.047 93.558 A 2.555 2.555 0 0 1 307 93.582 A 1.082 1.082 0 0 0 306.859 93.666 A 0.836 0.836 0 0 0 306.75 93.757 L 306.8 93.757 Q 306.55 94.007 306.3 94.207 A 5.849 5.849 0 0 0 306.007 94.457 A 4.855 4.855 0 0 0 305.85 94.607 Q 305.9 94.607 305.925 94.632 A 0.078 0.078 0 0 0 305.956 94.651 Q 305.969 94.655 305.984 94.656 A 0.176 0.176 0 0 0 306 94.657 Z M 305.3 94.257 A 0.961 0.961 0 0 0 305.388 94.335 Q 305.444 94.379 305.5 94.407 A 0.961 0.961 0 0 0 305.413 94.329 Q 305.356 94.285 305.3 94.257 Z M 305.55 94.957 L 305.5 95.007 A 0.072 0.072 0 0 1 305.503 94.987 Q 305.509 94.965 305.532 94.959 A 0.074 0.074 0 0 1 305.55 94.957 Z M 496.15 3.307 L 496.1 3.357 L 496.15 3.307 Z M 570.6 3.307 L 570.55 3.357 L 570.6 3.307 Z"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">svg</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>有了 svg 之后，在 hexo 博客的 <code>source\js</code> 目录下创建 <code>sign.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">navbarBrand</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'.container a'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #6A9955">// 替换navbarBrand中的strong标签为svg标签</span></span><span class="line"><span style="color: #9CDCFE">navbarBrand</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">innerHTML</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`</span></span><span class="line"><span style="color: #CE9178">&lt;svg class="svg" viewBox="0 0 682.2 98.507" xmlns="http://www.w3.org/2000/svg"&gt;</span></span><span class="line"><span style="color: #CE9178">...略...</span></span><span class="line"><span style="color: #CE9178">&lt;/svg&gt;</span></span><span class="line"><span style="color: #CE9178">`</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">paths</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'.container .navbar-brand .svg path'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #6A9955">// console.log(paths.getTotalLength());</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">len</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">paths</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getTotalLength</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #9CDCFE">paths</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setProperty</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'--l'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">len</span><span style="color: #D4D4D4">)</span></span></code></pre></div></div></figure><h3 id="为什么这么写"><a class="markdownIt-Anchor" href="#为什么这么写"></a> 为什么这么写？</h3><p>这里主要是利用浏览器开发者工具查看你的网站元素结构，找到导航栏的标题位置：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411020528928.png" alt="image-20241102052841792"></p><p>可以看到类名为 <code>navbar-brand</code> 的就是导航栏的标题区域，我们就是要将 svg 放在这里。</p><p>上图我已经做出修改，如果没有进行修改的话，你这里的 <code>&lt;svg&gt;</code> 标签应该是依照你的<code>_config.fluid.yml</code> 中设置的导航栏标题也就是 <code>&lt;strong&gt;</code> 标签。</p><p>修改的语句也很简单，先找到父亲 <code>navbarBrand</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">navbarBrand</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'.container a'</span><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><p>接着使用<code>.innerHTML</code> 设置为 svg 即可：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #9CDCFE">navbarBrand</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">innerHTML</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`</span></span><span class="line"><span style="color: #CE9178">&lt;svg class="svg" viewBox="0 0 682.2 98.507" xmlns="http://www.w3.org/2000/svg"&gt;</span></span><span class="line"><span style="color: #CE9178">...略...</span></span><span class="line"><span style="color: #CE9178">&lt;/svg&gt;</span></span><span class="line"><span style="color: #CE9178">`</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>这样只是先将 svg 放在这里了，还需要明白怎么写动画。</p><blockquote><p>可以参考文章：<a href="https://juejin.cn/post/6955857586922979364">https://juejin.cn/post/6955857586922979364</a></p><p>或者视频：<a href="https://www.bilibili.com/video/BV1Qi4y1Y7Sp/">https://www.bilibili.com/video/BV1Qi4y1Y7Sp/</a></p><p>真不是摆烂，大佬讲的是真香</p></blockquote><p>所以现在还需要知道每条 path 的长度，可以使用<code>当前选择的元素.getTotalLength()</code> 得到：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">paths</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'.container .navbar-brand .svg path'</span><span style="color: #D4D4D4">) </span><span style="color: #6A9955">// 进一步选择到path</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">len</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">paths</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getTotalLength</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #9CDCFE">paths</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setProperty</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'--l'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">len</span><span style="color: #D4D4D4">)</span></span></code></pre></div></div></figure><p>如果你在之前生成 svg 的时候，生成了多条 path，这里你应该使用的是：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">paths</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelectorAll</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'.container .navbar-brand .svg path'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">paths</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">len</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getTotalLength</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setProperty</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'--l'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">len</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">})</span></span></code></pre></div></div></figure><p>给每条 path 设置上行内样式为变量 <code>--l</code> 方便后面 css 的编写。</p><h2 id="编写css"><a class="markdownIt-Anchor" href="#编写css"></a> 编写 CSS</h2><p>在 <code>source\css</code> 目录下创建 <code>sign.css</code>：</p><figure class="shiki css"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D7BA7D">.svg</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">200pt</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30pt</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.svg</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">path</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">stroke</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">white</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">stroke-width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">3pt</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">stroke-linecap</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">round</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">stroke-dasharray</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">var</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">--l</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">stroke-dashoffset</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">var</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">--l</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">fill</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">fill-rule</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">nonzero</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">animation</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">stroke</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">25s</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">forwards</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-webkit-animation</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">stroke</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">25s</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">forwards</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">@keyframes</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">stroke</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  to {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">stroke-dashoffset</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">/* fill: white; */</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>通过样式变量使得 <code>stroke-dasharray</code> 和 <code>stroke-dashoffset</code> 属性能轻易获取到 path 的长度，也就方便了 <code>@keyframes stroke</code> 的编写。</p><h2 id="另一个方法"><a class="markdownIt-Anchor" href="#另一个方法"></a> 另一个方法</h2><p>其实有个库可以实现这种效果：Vivus.js</p><p>demo：<a href="https://maxwellito.github.io/vivus/">https://maxwellito.github.io/vivus/</a></p><p>GIthub 地址：<a href="https://github.com/maxwellito/vivus">https://github.com/maxwellito/vivus</a></p><p>使用方法也很简单，只要给 svg 标签加上 id 即可：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">svg</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"my-svg"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  &lt;path...&gt;</span></span><span class="line"><span style="color: #D4D4D4">  &lt;path...&gt;</span></span><span class="line"><span style="color: #D4D4D4">  &lt;path...&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">svg</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  new Vivus('my-svg', </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">duration</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">200</span><span style="color: #569CD6">}</span><span style="color: #D4D4D4">, myCallback);</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>美化</tag>
      
      <tag>CSS</tag>
      
      <tag>JavaScript</tag>
      
      <tag>线条动画</tag>
      
      <tag>路径动画</tag>
      
      <tag>svg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo 博客配置 GitHub Actions 推送 indexnow</title>
    <link href="/archives/Hexo/7648.html"/>
    <url>/archives/Hexo/7648.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="Hexo博客配置GitHub Actions推送indexnow"><h1 id="hexo博客配置github-actions推送indexnow"><a class="markdownIt-Anchor" href="#hexo博客配置github-actions推送indexnow"></a> Hexo 博客配置 GitHub Actions 推送 indexnow</h1><h2 id="什么是indexnow"><a class="markdownIt-Anchor" href="#什么是indexnow"></a> 什么是 IndexNow？</h2><p>IndexNow 是一种开源协议，可以让网站所有者在网站内容出现变化（添加、更新或删除）后通知搜索引擎，让搜索引擎立即索引这些页面和内容。这使搜索引擎能够在其搜索结果中快速反映这种变化，从而提高整体抓取效率。</p><h2 id="api-key"><a class="markdownIt-Anchor" href="#api-key"></a> API Key</h2><p>找到 <a href="https://www.bing.com/indexnow/getstarted">Indexnow 官网</a>生成 API Key（每点击一次 Generate 都会生成一个新的 Key）：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410272123991.png" alt="image-20241027212339859"></p><h2 id="验证网站所有权"><a class="markdownIt-Anchor" href="#验证网站所有权"></a> 验证网站所有权</h2><p>你需要点击上图中 API Key 右边的下载按钮，将该 <code>5617c6a058f84405b90e2a0c6e99519a.txt</code> 文件保存好。</p><p>然后把它放到你的网站根目录下，让它可以通过网址链接 <code>https://www.example.com/5617c6a058f84405b90e2a0c6e99519a.txt</code> 的形式访问，并得到明文 API Key：<code>5617c6a058f84405b90e2a0c6e99519a</code></p><p>比如，将 <code>5617c6a058f84405b90e2a0c6e99519a.txt</code> 放在 <code>source</code> 目录下，并在<code>_config.yml</code> 中配置 <code>skip_render</code> 如下：</p><figure class="shiki yml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">skip_render</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  - </span><span style="color: #CE9178">'*.py'</span></span><span class="line"><span style="color: #D4D4D4">  - </span><span style="color: #CE9178">'*.txt'</span></span></code></pre></div></div></figure><p>这样可以确保 Hexo 不会尝试渲染这些文件，而只是将它们直接复制到 <code>public</code> 目录。</p><p>这样就做好了第一和第二步。</p><h2 id="github-actions配置"><a class="markdownIt-Anchor" href="#github-actions配置"></a> GitHub Actions 配置</h2><p class="note note-info">GitHub 的 Actions 允许你运行一些小文件，我们可以采用 Python 脚本的方式来提交 URLs</p><h3 id="编写提交urls的python脚本"><a class="markdownIt-Anchor" href="#编写提交urls的python脚本"></a> 编写提交 URLs 的 Python 脚本</h3><p>我的 Python 文件如下（<code>index_now.py</code>）：</p><figure class="shiki python"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> requests</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> xml.etree.ElementTree </span><span style="color: #C586C0">as</span><span style="color: #D4D4D4"> ET</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">HOST = </span><span style="color: #CE9178">"userName.github.io"</span><span style="color: #D4D4D4">  </span><span style="color: #6A9955"># 替换为你的实际域名</span></span><span class="line"><span style="color: #D4D4D4">KEY = </span><span style="color: #CE9178">"5617c6a058f84405b90e2a0c6e99519a"</span><span style="color: #D4D4D4">  </span><span style="color: #6A9955"># 替换为你的 API Key</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">def</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">get_latest_posts</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">sitemap_path</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">n</span><span style="color: #D4D4D4">=</span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">):</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955"># 解析 XML sitemap</span></span><span class="line"><span style="color: #D4D4D4">    tree = ET.parse(sitemap_path)</span></span><span class="line"><span style="color: #D4D4D4">    root = tree.getroot()</span></span><span class="line"><span style="color: #D4D4D4">    </span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955"># 使用命名空间</span></span><span class="line"><span style="color: #D4D4D4">    namespaces = {</span><span style="color: #CE9178">'s'</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'http://www.sitemaps.org/schemas/sitemap/0.9'</span><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955"># 获取所有 URL</span></span><span class="line"><span style="color: #D4D4D4">    urls = [(url.find(</span><span style="color: #CE9178">'s:loc'</span><span style="color: #D4D4D4">, namespaces).text, url.find(</span><span style="color: #CE9178">'s:lastmod'</span><span style="color: #D4D4D4">, namespaces).text)</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> url </span><span style="color: #C586C0">in</span><span style="color: #D4D4D4"> root.findall(</span><span style="color: #CE9178">'s:url'</span><span style="color: #D4D4D4">, namespaces)]</span></span><span class="line"><span style="color: #D4D4D4">    </span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955"># 根据最后修改时间排序</span></span><span class="line"><span style="color: #D4D4D4">    urls.sort(</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">lambda</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">x</span><span style="color: #D4D4D4">: x[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">], </span><span style="color: #9CDCFE">reverse</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">True</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955"># 返回最近的 n 个 URL</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> [url[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> url </span><span style="color: #C586C0">in</span><span style="color: #D4D4D4"> urls[:n]]</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">def</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">ping_bing</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">url_list</span><span style="color: #D4D4D4">):</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955"># url = 'https://www.bing.com/indexnow'</span></span><span class="line"><span style="color: #D4D4D4">    url = </span><span style="color: #CE9178">'https://api.indexnow.org/IndexNow'</span></span><span class="line"><span style="color: #D4D4D4">    headers = {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">'Content-Type'</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'application/json; charset=utf-8'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955"># 准备数据</span></span><span class="line"><span style="color: #D4D4D4">    data = {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">"host"</span><span style="color: #D4D4D4">: HOST,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">"key"</span><span style="color: #D4D4D4">: KEY,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">"keyLocation"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">f</span><span style="color: #CE9178">"https://</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">HOST</span><span style="color: #569CD6">}</span><span style="color: #CE9178">/</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">KEY</span><span style="color: #569CD6">}</span><span style="color: #CE9178">.txt"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">"urlList"</span><span style="color: #D4D4D4">: url_list</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955"># 发送 POST 请求</span></span><span class="line"><span style="color: #D4D4D4">    response = requests.post(url, </span><span style="color: #9CDCFE">headers</span><span style="color: #D4D4D4">=headers, </span><span style="color: #9CDCFE">json</span><span style="color: #D4D4D4">=data)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> response</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">__name__</span><span style="color: #D4D4D4"> == </span><span style="color: #CE9178">"__main__"</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">    sitemap_path = </span><span style="color: #CE9178">"sitemap.xml"</span><span style="color: #D4D4D4">  </span><span style="color: #6A9955"># 替换为你的 sitemap 文件路径</span></span><span class="line"><span style="color: #D4D4D4">    url_list = get_latest_posts(sitemap_path, </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">)  </span><span style="color: #6A9955"># 获取最近 10 篇文章的 URL</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">print</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"最近更新的文章 URL 列表："</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">print</span><span style="color: #D4D4D4">(url_list)  </span><span style="color: #6A9955"># 打印获取的 URL 列表</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    response = ping_bing(url_list)  </span><span style="color: #6A9955"># 向 IndexNow 发送请求</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">print</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"响应状态码："</span><span style="color: #D4D4D4">, response.status_code)  </span><span style="color: #6A9955"># 打印响应状态</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">print</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"响应内容："</span><span style="color: #D4D4D4">, response.text)  </span><span style="color: #6A9955"># 打印响应内容</span></span></code></pre></div></div></figure><p>脚本值得注意的点在于：</p><ol><li><code>HOST = "userName.github.io"</code></li><li><code>KEY = "5617c6a058f84405b90e2a0c6e99519a"</code></li><li><code>sitemap_path = "sitemap.xml"</code></li></ol><p>前面两个主要是配置成你自己的就行。</p><p>主要是第三个 sitemap 路径问题，我建议同样存放在网站根目录下。</p><p>可以安装 <code>hexo-generator-sitemap</code> 插件，该插件在每次 <code>hexo g</code> 生成文件时<strong>重新生成</strong>新的 <code>sitemap.xml</code> 文件并放置在 <code>public</code> 目录下，这会使得它被推送时放置在仓库根目录下，符合我脚本的要求。</p><p>脚本编写好后，同样需要将其推送到仓库，我的是根目录。我将脚本同样放在 <code>source</code> 目录下，这样它会和 <code>key.txt</code> 一同被推送至仓库根目录。</p><h3 id="本地创建workflows"><a class="markdownIt-Anchor" href="#本地创建workflows"></a> 本地创建 workflows</h3><h4 id="hexo配置"><a class="markdownIt-Anchor" href="#hexo配置"></a> Hexo 配置</h4><p>创建 GitHub workflow 一般是<code>.github/workflows/xxx.yml</code></p><p>但是 Hexo 默认忽略以点（<code>.example</code>）开头的文件和文件夹，所以我的做法是修改<code>_config.yml</code> 中的 <code>include</code> 项，将其添加进去：</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">include</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  - </span><span style="color: #CE9178">".github/**/**"</span></span></code></pre></div></div></figure><p>此时还需要修改下 <strong>skip_render</strong> 这个配置，否则 hexo 会自动把 yaml 文件给转成 json 格式的，到时候 GitHub 是不识别的（<code>_config.yml</code>）：</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">skip_render</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  - </span><span style="color: #CE9178">".github/**/**"</span></span></code></pre></div></div></figure><p>最后需要配置下 hexo 的 <strong>deploy</strong> 配置，不要忽略隐藏文件。否则在最后部署到 GitHub 时，隐藏文件会被忽略掉（<code>_config.yml</code>）：</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">deploy</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">type</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">git</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">repository</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">git@github.com:userName/userName.github.io.git</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">branch</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">master</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">ignore_hidden</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">  </span><span style="color: #6A9955"># 取消忽略隐藏文件</span></span></code></pre></div></div></figure><blockquote><p><code>.github</code> 隐藏目录相关配置项参考链接为：<a href="https://knktc.com/2021/06/26/hexo-use-github-actions-to-submit-sitemap/">Hexo 博客使用 GitHub Actions 来自动提交 Sitemap</a></p></blockquote><p>这样，Hexo 会将 <code>source/.github</code> 文件夹中的内容也复制到 <code>public</code> 目录中，一旦执行 <code>hexo d</code> 命令便会部署到 GitHub。</p><p><strong>不过你得确保你的 <code>.github</code> 目录直接放在 <code>source</code> 目录下</strong>，即结构如下：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">your-hexo-site/</span></span><span class="line"><span style="color: #DCDCAA">├──</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">source/</span></span><span class="line"><span style="color: #DCDCAA">│</span><span style="color: #D4D4D4">   </span><span style="color: #CE9178">├──</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.github/</span></span><span class="line"><span style="color: #DCDCAA">│</span><span style="color: #D4D4D4">   </span><span style="color: #CE9178">│</span><span style="color: #D4D4D4">   </span><span style="color: #CE9178">└──</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">workflows/</span></span><span class="line"><span style="color: #DCDCAA">│</span><span style="color: #D4D4D4">   </span><span style="color: #CE9178">│</span><span style="color: #D4D4D4">       </span><span style="color: #CE9178">└──</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">your-action.yml</span></span></code></pre></div></div></figure><p>这样一来，当你推送代码至仓库时，GitHub 会自动触发 Actions 运行你的 <code>your-action.yml</code> 文件，所以需要在这个 <code>yml</code> 文件中调用我们写的 Python 脚本。</p><h4 id="编写action触发文件"><a class="markdownIt-Anchor" href="#编写action触发文件"></a> 编写 action 触发文件</h4><p>我的 <code>indexnow.yml</code> 文件（名字可以随意，但请具有语义性）如下：</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">name</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">Submit IndexNow Request To Bing</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">on</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">push</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">branches</span><span style="color: #D4D4D4">: [</span><span style="color: #CE9178">"master"</span><span style="color: #D4D4D4">]  </span><span style="color: #6A9955"># 根据需要替换为你的主分支</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">workflow_dispatch</span><span style="color: #D4D4D4">:  </span><span style="color: #6A9955"># 允许手动触发工作流</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">jobs</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">indexnow</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">name</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">IndexNow</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">runs-on</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">ubuntu-latest</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">steps</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">      - </span><span style="color: #569CD6">name</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">Checkout repository</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">uses</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">actions/checkout@v4</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      - </span><span style="color: #569CD6">name</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">Set up Python</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">uses</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">actions/setup-python@v5</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">with</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">python-version</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'3.11'</span><span style="color: #D4D4D4">  </span><span style="color: #6A9955"># 可以根据需要调整 Python 版本</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      - </span><span style="color: #569CD6">name</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">Install dependencies</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">run</span><span style="color: #D4D4D4">: </span><span style="color: #C586C0">|</span></span><span class="line"><span style="color: #CE9178">          python -m pip install --upgrade pip</span></span><span class="line"><span style="color: #CE9178">          pip install requests  # 安装 requests 库</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      - </span><span style="color: #569CD6">name</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">Run IndexNow script</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">run</span><span style="color: #D4D4D4">: </span><span style="color: #C586C0">|</span></span><span class="line"><span style="color: #CE9178">          python index_now.py  # 替换为你的 Python 脚本文件名</span></span></code></pre></div></div></figure><p>该文件值得注意的点在于：</p><ol><li><code>branches: ["master"]</code></li><li><code>python index_now.py</code></li></ol><p>注意修改成你的配置项就行。</p><p>至此准备工作已经完毕，你只需要<strong>推送新代码到仓库</strong>就会自动触发 actions 发请求给必应的 indexnow，最终你可以在<a href="https://www.bing.com/webmasters/indexnow">必应网站管理员工具</a>查看效果。</p><ul><li>注：实际上你也可以单独在本地运行该 python 文件，效果是一致的。</li></ul><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>GitHubActions</tag>
      
      <tag>indexnow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo fluid 全屏背景图随日夜模式切换以及正文底页毛玻璃效果</title>
    <link href="/archives/Hexo/60191.html"/>
    <url>/archives/Hexo/60191.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="fluid主题美化设置全屏背景图并随日夜模式切换，设置正文底页为毛玻璃效果"><h1 id="fluid全屏背景图随日夜模式切换和正文底页毛玻璃效果"><a class="markdownIt-Anchor" href="#fluid全屏背景图随日夜模式切换和正文底页毛玻璃效果"></a> fluid 全屏背景图随日夜模式切换和正文底页毛玻璃效果</h1><h2 id="实现背景图全屏效果"><a class="markdownIt-Anchor" href="#实现背景图全屏效果"></a> 实现背景图全屏效果</h2><blockquote><p>设置背景图为全屏效果，可以使用 fluid 提供的<a href="https://fluid-dev.github.io/hexo-fluid-docs/advance/#fluid-%E6%B3%A8%E5%85%A5%E4%BB%A3%E7%A0%81">注入代码功能</a>，可以将代码无侵入式加入到主题里。</p></blockquote><p>在根目录下新建一个 scripts 目录，在目录内新建：<code>injector.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">root</span><span style="color: #D4D4D4">: </span><span style="color: #4FC1FF">siteRoot</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">"/"</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">hexo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #9CDCFE">hexo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">extend</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">injector</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">register</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"body_begin"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">`&lt;div id="web_bg"&gt;&lt;/div&gt;`</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">hexo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">extend</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">injector</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">register</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"body_end"</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">`&lt;script src="</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">siteRoot</span><span style="color: #569CD6">}</span><span style="color: #CE9178">js/backgroundize.js"&gt;&lt;/script&gt;`</span><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><p>名字其实可以随意。</p><div class="note note-warning">            <p>该文件不需要在<code>_config.fluid.yml</code> 中进行引用，<strong>hexo 自动执行调用里面的 js 文件</strong></p>          </div><p>其实到这一步就可以了，因为我们其实一般会在<code>_config.fluid.yml</code> 中自己指定背景图。但如果你想实现点击日夜模式切换按钮背景图也跟着切换的话，还需要写一个自定义 js 文件。</p><h2 id="实现背景图随日夜主题切换效果"><a class="markdownIt-Anchor" href="#实现背景图随日夜主题切换效果"></a> 实现背景图随日夜主题切换效果</h2><p>在 <code>source/js</code> 目录中新建 <code>backgroundize.js</code> 文件，我的代码文件如下：<code>backgroundize.js</code></p><figure class="shiki javascript"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 获取 DOM 元素</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">DarkmodeBtn</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"#color-toggle-btn .nav-link"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">BackgroundDiv</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"#web_bg"</span><span style="color: #D4D4D4">);</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 背景图配置，可以修改成你的图片链接</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">BackgroundImages</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">dark:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">desktop:</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #CE9178">"URL1"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">mobile:</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #CE9178">"mobileURL"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">light:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">desktop:</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #CE9178">"URL2"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">mobile:</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #CE9178">"mobileURL"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 不随模式变化的默认背景，适用于桌面端，你可以更细化</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">defaultImage:</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #CE9178">"URL3"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">};</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 不需要跟随日夜切换的页面路径</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">excludePages</span><span style="color: #D4D4D4"> = [</span><span style="color: #CE9178">"/"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">"/links/"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">"/about/"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">"/categories/"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">"/tags/"</span><span style="color: #D4D4D4">];</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 判断当前是否为移动端</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">isMobile</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">window</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">innerWidth</span><span style="color: #D4D4D4"> &lt; </span><span style="color: #B5CEA8">768</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 预加载所有背景图</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">preloadImages</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">allUrls</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Set</span><span style="color: #D4D4D4">();</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">Object</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">values</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">BackgroundImages</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">entry</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">typeof</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">entry</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">"object"</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">allUrls</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">add</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">entry</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">desktop</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">allUrls</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">add</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">entry</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">mobile</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">allUrls</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">add</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">entry</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  });</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">allUrls</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">url</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">img</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Image</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">img</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">url</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  });</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// console.log("preload completed.");</span></span><span class="line"><span style="color: #D4D4D4">};</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 设置背景图</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setBackgroundImage</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">customUrl</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">mobile</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">isMobile</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">imageUrl</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">customUrl</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">imageUrl</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">customUrl</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log("当前页面将使用自定义背景图");</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> === </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 用于排除页面，自动根据设备选择 defaultImage 或 fallback</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">imageUrl</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">mobile</span></span><span class="line"><span style="color: #D4D4D4">      ? </span><span style="color: #9CDCFE">BackgroundImages</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">dark</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">mobile</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 所有移动端都用同一图</span></span><span class="line"><span style="color: #D4D4D4">      : </span><span style="color: #9CDCFE">BackgroundImages</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">defaultImage</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log("当前页面将使用默认背景图");</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #9CDCFE">excludePages</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">includes</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">location</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">pathname</span><span style="color: #D4D4D4">) &amp;&amp; </span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 正常页面根据模式设置</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">imageUrl</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">mobile</span></span><span class="line"><span style="color: #D4D4D4">      ? </span><span style="color: #9CDCFE">BackgroundImages</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">].</span><span style="color: #9CDCFE">mobile</span></span><span class="line"><span style="color: #D4D4D4">      : </span><span style="color: #9CDCFE">BackgroundImages</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">].</span><span style="color: #9CDCFE">desktop</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(`当前使用${mode}模式背景图`);</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 从移动端视口切换回桌面端时，自动切换到默认背景图</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">imageUrl</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">mobile</span></span><span class="line"><span style="color: #D4D4D4">      ? </span><span style="color: #9CDCFE">BackgroundImages</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">dark</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">mobile</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 所有移动端都用同一图</span></span><span class="line"><span style="color: #D4D4D4">      : </span><span style="color: #9CDCFE">BackgroundImages</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">defaultImage</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">BackgroundDiv</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setAttribute</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"style"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">`background-image: url(</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">imageUrl</span><span style="color: #569CD6">}</span><span style="color: #CE9178">);`</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">};</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 获取当前日夜模式</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCurrentMode</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">html</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">documentElement</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">mode</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">html</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getAttribute</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"data-user-color-scheme"</span><span style="color: #D4D4D4">);</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">"dark"</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"dark"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"light"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">};</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 切换日夜模式时调用</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">handleToggleMode</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">mode</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">getCurrentMode</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #9CDCFE">excludePages</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">includes</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">location</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">pathname</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log("模式切换，将重新设置背景");</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setBackgroundImage</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log("当前页面无需切换背景");</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">};</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 防抖处理监听窗口大小变化</span></span><span class="line"><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">resizeTimeout</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">handleResize</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">clearTimeout</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">resizeTimeout</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">resizeTimeout</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">setTimeout</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">mode</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">getCurrentMode</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setBackgroundImage</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  }, </span><span style="color: #B5CEA8">200</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">};</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 页面初始化</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">initBackground</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">preloadImages</span><span style="color: #D4D4D4">();</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">currentPath</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">location</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">pathname</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">currentMode</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">getCurrentMode</span><span style="color: #D4D4D4">();</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">excludePages</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">includes</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">currentPath</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setBackgroundImage</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setBackgroundImage</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">currentMode</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 清除首页 banner 的背景图样式</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">banner</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"#banner"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">bannerMask</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">querySelector</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"#banner .mask"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">banner</span><span style="color: #D4D4D4">) </span><span style="color: #9CDCFE">banner</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setAttribute</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"style"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">"background-image: url()"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">bannerMask</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">bannerMask</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setAttribute</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"style"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">"background-color: rgba(0,0,0,0)"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">};</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 注册监听器</span></span><span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">DarkmodeBtn</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">DarkmodeBtn</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"click"</span><span style="color: #D4D4D4">, () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setTimeout</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">handleToggleMode</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">    }, </span><span style="color: #B5CEA8">100</span><span style="color: #D4D4D4">);</span><span style="color: #6A9955">// 延时，以免获取信息错误</span></span><span class="line"><span style="color: #D4D4D4">  });</span></span><span class="line"><span style="color: #D4D4D4">} </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">warn</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"未找到切换按钮"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #9CDCFE">window</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"resize"</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">handleResize</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">passive:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 防止默认事件</span></span><span class="line"><span style="color: #D4D4D4">});</span></span><span class="line"></span><span class="line"><span style="color: #9CDCFE">window</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"DOMContentLoaded"</span><span style="color: #D4D4D4">, () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"DOM 加载完毕，将初始化背景图"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">initBackground</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">});</span></span></code></pre></div></div></figure><p>该代码文件还可以结合一个自定义的 css 文件使用（可选）：<code>source/css/backgroundize.css</code></p><figure class="shiki css"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D7BA7D">#web_bg</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-image</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">var</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">--desktop-bg-image-normal</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">fixed</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">z-index</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">-1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-size</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">cover</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">/* 添加过渡效果 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">transition</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">all</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0.5s</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>最主要的是 transition 效果，以免切换过于生硬。</p><div class="note note-warning">            <p>别忘记在<code>_config.fluid.yml</code> 文件中的 <code>custom_js</code> 和 <code>custom_css</code> 中进行引用</p>          </div><p>例如：</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">custom_js</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  - </span><span style="color: #CE9178">/js/backgroundize.js</span></span><span class="line"><span style="color: #D4D4D4">  </span></span><span class="line"><span style="color: #569CD6">custom_css</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #D4D4D4">  - </span><span style="color: #CE9178">/css/backgroundize.css</span></span></code></pre></div></div></figure><h2 id="预加载的可能问题"><a class="markdownIt-Anchor" href="#预加载的可能问题"></a> 预加载的可能问题</h2><p>如果你遇到了第一次切换主题，图片与图片之间的切换有些生硬，有点闪屏的感觉，但后续的所有切换却十分丝滑，那么很可能是预加载的失败。</p><h3 id="可能的问题来源"><a class="markdownIt-Anchor" href="#可能的问题来源"></a> 可能的问题来源</h3><div class="note note-info">            <p>如果 <code>OSS/Bucket</code> 设置了响应头 <code>Cache-Control: no-store</code> 或 <code>max-age=0</code> 或没有启用 <code>Expires</code>，浏览器会认为每次访问都需要重新拉取。也就是尽管你预加载了，但切换时图片链接仍然会触发一次真正的请求。</p>          </div><p>我遇到的问题是，我使用的图片托管在阿里云的 oss 上，阿里云返回的响应头中存在：</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">x-oss-force-download: true</span></span><span class="line"><span style="color: #D4D4D4">Content-Disposition: attachment</span></span></code></pre></div></div></figure><p>而 <code>Content-Disposition: attachment</code> 的含义是：<strong>这个资源是供下载用的</strong>，而不是网页内容的一部分。</p><p>浏览器遇到这种响应头时，通常会<strong>绕过图片的常规缓存路径</strong>，或者不会把它作为正常的预加载资源处理。</p><p>这就导致：</p><ul><li>图片不会进入 <code>memory</code> 或 <code>disk cache</code></li><li>即使预加载代码写得很好，浏览器仍然会每次点击切换时发起新请求</li><li>导致首次切换背景图时出现 “<strong>闪屏或延迟加载</strong>”</li></ul><p>翻阅文档，发现阿里云在很久之前就已经做出了调整：</p><p><code>出于安全考虑，通过OSS默认 Bucket域名访问文件时，OSS会强制增加下载响应头，导致浏览器强制下载文件。</code></p><p>也就是强制增加了 <code>x-oss-force-download: true</code> 使得 <code>Content-Disposition</code> 为附件类型。</p><p>如果遇到其他问题，欢迎讨论。</p><h3 id="解决办法"><a class="markdownIt-Anchor" href="#解决办法"></a> 解决办法</h3><p>如果你的托管平台可以更改元信息，那么请更改所需文件的元信息：</p><ul><li><p><code>Content-Disposition: attachment</code> 改为 <code>Content-Disposition: inline</code> 或留空</p></li><li><p><code>x-oss-force-download: true</code> 改为 <code>false</code></p></li></ul><p>阿里云平台是无法通过更改文件元信息来解决的。</p><p>阿里云的推荐方案是为 <code>oss/bucket</code> 绑定自定义域名，不再使用阿里云提供的默认域名。详见：<a href="https://help.aliyun.com/zh/oss/user-guide/map-custom-domain-names-5">绑定自定义域名至 Bucket 默认域名</a></p><p>而要绑定的话，由于阿里云在国内，所以需要备案等手续，我就没有继续下去了，故当前我的日夜切换效果，第一次切换闪屏是不可避免的。理论上，解决了图片的响应头问题，是可以实现完美的切换效果的。</p><h2 id="毛玻璃底页效果"><a class="markdownIt-Anchor" href="#毛玻璃底页效果"></a> 毛玻璃底页效果</h2><ol><li><p>修改<code>_config.fluid.yml</code> 文件的主面板背景色</p><figure class="shiki yaml"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955"># 主面板背景色</span></span><span class="line"><span style="color: #6A9955"># Color of main board</span></span><span class="line"><span style="color: #569CD6">board_color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"#ffffff80"</span></span><span class="line"><span style="color: #569CD6">board_color_dark</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"#00000080"</span></span></code></pre></div></div></figure></li><li><p><code>source/css</code> 目录下新建 <code>glassBg.css</code> 文件</p><figure class="shiki css"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">/* 正文底页毛玻璃效果 */</span></span><span class="line"><span style="color: #D7BA7D">#board</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-webkit-backdrop-filter</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">blur</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">backdrop-filter</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">blur</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #6A9955">/* 侧边目录毛玻璃效果 */</span></span><span class="line"><span style="color: #D7BA7D">#toc</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">4rem</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">var</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">--board-bg-color</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-webkit-backdrop-filter</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">blur</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">var</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">--background-blur</span><span style="color: #D4D4D4">));</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">backdrop-filter</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">blur</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">var</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">--background-blur</span><span style="color: #D4D4D4">));</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure></li></ol><p>侧边的目录区域毛玻璃效果如果不需要可以删除。</p><h2 id="一些好用的插件"><a class="markdownIt-Anchor" href="#一些好用的插件"></a> 一些好用的插件</h2><p>Hexo 官方推荐插件就足够：<a href="https://fluid-dev.github.io/hexo-fluid-docs/advance/#hexo-%E6%8F%92%E4%BB%B6">https://fluid-dev.github.io/hexo-fluid-docs/advance/#hexo - 插件</a></p><h2 id="致谢"><a class="markdownIt-Anchor" href="#致谢"></a> 致谢</h2><p>感谢 <a href="https://github.com/banyee19">@banyee19</a> 在日夜背景图切换方面的探究，我一度以为我的切换效果是正常的，但使用其他设备进行查看后才发现效果无法正确实现，故此重构。</p><p>相关文章：</p><ul><li><a href="https://kznep19.blog/2025/04/26/%E7%99%BD%E5%A4%A9%E9%BB%91%E5%A4%9C%E8%83%8C%E6%99%AF%E5%9B%BE%E5%88%87%E6%8D%A2/">Hexo Fluid 背景图随日夜模式切换</a> by <a href="https://github.com/banyee19">@banyee19</a></li></ul><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>美化</tag>
      
      <tag>Hexo</tag>
      
      <tag>fluid</tag>
      
      <tag>日夜切换背景</tag>
      
      <tag>CSS</tag>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>华硕奥创中心以及其他服务组件彻底删除卸载</title>
    <link href="/archives/notes/57159.html"/>
    <url>/archives/notes/57159.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="有时候卸载奥创中心会残留一些它的其他服务，或者不知道如何卸载，本文将简要介绍如何对奥创中心以及它的其他服务项进行彻底删除。"><h1 id="华硕奥创中心以及其他服务组件彻底删除卸载"><a class="markdownIt-Anchor" href="#华硕奥创中心以及其他服务组件彻底删除卸载"></a> 华硕奥创中心以及其他服务组件彻底删除卸载</h1><h2 id="卸载奥创中心"><a class="markdownIt-Anchor" href="#卸载奥创中心"></a> 卸载奥创中心</h2><p>要顺利卸载奥创中心你首先得去官网找到它的官方卸载工具（<a href="https://www.asus.com/supportonly/armoury%20crate/helpdesk_download/">官网在哪？</a>）</p><p>它长这样：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501101729547.png" alt="image-20250110172917459"></p><p>你需要点击下方的 <code>Show all</code> 将其展开，找到 <code>Armour Create Uninstall Tool</code> 工具下载到本地并将其解压：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501101730856.png" alt="image-20250110173033808"></p><p>它目录中应当包含以下文件：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501101731079.png" alt="image-20250110173157054"></p><p>然后按照该工具的提示进行卸载即可。</p><h2 id="卸载残留问题"><a class="markdownIt-Anchor" href="#卸载残留问题"></a> 卸载残留问题</h2><p>不出意外的话往往卸载就出意外了，你会发现卸载后你的任务管理器中还运行着这些服务项：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501101735064.jpeg" alt="img"></p><p>事实上没那么恐怖，这是它的注册表并未删除干净。</p><ul><li><p>Windows7 的用户可以找到计算机右键选择管理（或者 <code>Win+R</code> 输入 <code>services.msc</code> 打开服务），然后在服务列表中将先所有 ASUS 有关的服务全部停止，然后使用命令将其删除：</p><figure class="shiki shell"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">sc</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">delete</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">xxx</span></span></code></pre></div></div></figure></li></ul><p>​需要注意的是服务名并非列表中展示给你看的名字，而是右键查看属性之后它展示的服务名称：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202501101742169.png" alt="image-20250110174216138"></p><ul><li><p>Windows10 及其以上用户先和 Win7 一样将所有有关的服务项先全部停止，然后 <code>Win+R</code> 输入 <code>regedit</code> 打开注册表编辑器，定位到：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services</span></span></code></pre></div></div></figure><p>然后对照服务项列表里的服务名将注册表中的文件夹及其子项删除即可。</p></li></ul><p>最后的最后，别忘记重启电脑。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>随记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>华硕</tag>
      
      <tag>卸载问题</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一文搞清 Strapi5 的安装与使用 | 踩坑爽 (bushi</title>
    <link href="/archives/Back-End/45101.html"/>
    <url>/archives/Back-End/45101.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><blockquote><p>我的 Strapi 版本：v5.0.0</p><p>节点版本：v20.13.1</p><p>数据库：MySQL8</p><table><thead><tr><th>数据库</th><th>受到推崇的</th><th>最低限度</th></tr></thead><tbody><tr><td> MySQL</td><td>8.0</td><td>8.0</td></tr><tr><td> 玛丽亚数据库</td><td> 10.6</td><td>10.5</td></tr><tr><td>PostgreSQL</td><td>14.0</td><td>12.0</td></tr><tr><td>SQLite</td><td>3</td><td>3</td></tr></tbody></table><p>Strapi 官方文档地址：<a href="https://strapi.nodejs.cn/dev-docs/installation/cli">https://strapi.nodejs.cn/dev-docs/installation/cli</a></p></blockquote><meta name="referrer" content="no-referrer"><meta name="description" content="从安装到使用，搞清Strapi5用作后端数据服务器的一切坑"><h1 id="一文搞清strapi5的安装与使用踩坑爽bushi"><a class="markdownIt-Anchor" href="#一文搞清strapi5的安装与使用踩坑爽bushi"></a> 一文搞清 Strapi5 的安装与使用 | 踩坑爽 (bushi</h1><h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><p>本篇文章主要是从安装到使用，说说我在 Windows | WindowsServer 上使用 Strapi5 作后端数据服务器时碰到的一切坑。</p><h2 id="安装strapi"><a class="markdownIt-Anchor" href="#安装strapi"></a> 安装 Strapi</h2><h3 id="检查本地环境"><a class="markdownIt-Anchor" href="#检查本地环境"></a> 检查本地环境</h3><p>请转到 <a href="https://strapi.nodejs.cn/dev-docs/installation/cli">Strapi 官方文档</a>，对照官方文档要求检查你本地的 <code>Node.js</code> 和 <code>npm</code> 版本。我的环境如下：</p><ul><li><p>Node.js 版本：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">$</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">node</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-v</span></span><span class="line"><span style="color: #DCDCAA">v20.13.1</span></span></code></pre></div></div></figure></li><li><p>npm 包管理器版本</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">$</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">npm</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-v</span></span><span class="line"><span style="color: #DCDCAA">10.8.2</span></span></code></pre></div></div></figure></li></ul><p>官方文档中使用 Python 是为了支持它默认的 SQLite 数据库，我这里使用的是 PHPStudy 集成的 MySQL8, 数据库，所以 Python 环境是不必须的。</p><blockquote><p>✋ 提醒</p><p>Strapi 不支持 MongoDB。</p></blockquote><h3 id="安装yarn可选"><a class="markdownIt-Anchor" href="#安装yarn可选"></a> 安装 yarn（可选）</h3><p>我之后投入了 yarn 的怀抱，所以这里可以安装一下 yarn 作为包管理器，<strong>非必须！</strong></p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">yarn</span></span></code></pre></div></div></figure><p>卸载命令是</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">uninstall</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">yarn</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span></span></code></pre></div></div></figure><p>我的 yarn 版本是</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">$</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">yarn</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-v</span></span><span class="line"><span style="color: #DCDCAA">1.22.22</span></span></code></pre></div></div></figure><h2 id="创建strapi项目"><a class="markdownIt-Anchor" href="#创建strapi项目"></a> 创建 Strapi 项目</h2><p>在一个你准备好的目录中，使用终端 <code>cmd</code> 或 <code>powershell</code> 执行</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">yarn</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">create</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">strapi</span></span></code></pre></div></div></figure><blockquote><p>✋ 注意</p><p>Yarn does not support passing the version tag such as <code>@latest</code>, as opposed to npm. If you experience unexpected results with yarn and the latest version of Strapi is not installed, you might need to <a href="https://yarn.nodejs.cn/cli/cache/clean">run the <code>yarn cache clean</code> command</a> to clean your Yarn cache.</p><p>Yarn 不支持传递版本标签，如 <code>@latest </code>, 这与 npm 相反。如果您在使用 yarn 时遇到意外结果，没有安装最新版本的 Strapi，您可能需要运行 [yarn cache clean](<a href="https://yarn">https://yarn</a> . nodejs . cn/CLI/cache/clean) 命令来清理 Yarn 缓存。</p></blockquote><p>或者使用 npm</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npx</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">create-strapi@latest</span></span></code></pre></div></div></figure><p>我推荐创建时，使用 npm 以保证安装最新版本的 Strapi</p><p>以下是我的安装选择：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955"># E:\Coding\StrapiProjects\demo1</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">$</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">npx</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">create-strapi@latest</span></span><span class="line"><span style="color: #DCDCAA">Need</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">to</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">the</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">following</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">packages:</span></span><span class="line"><span style="color: #DCDCAA">create-strapi@5.0.5</span></span><span class="line"><span style="color: #DCDCAA">Ok</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">to</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">proceed?</span><span style="color: #D4D4D4"> (y) y</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Strapi</span><span style="color: #D4D4D4">   </span><span style="color: #CE9178">v5.0.5</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">�</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Let's create your new project</span></span><span class="line"></span><span class="line"><span style="color: #CE9178">? What is the name of your project? demo1</span></span><span class="line"><span style="color: #CE9178">? What is the name of your project? demo1</span></span><span class="line"></span><span class="line"><span style="color: #CE9178">We can't</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">find</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">any</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">auth</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">credentials</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">in</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">your</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Strapi</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">config.</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">Create</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">a</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">free</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">account</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">on</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Strapi</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Cloud</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">and</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">benefit</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">from:</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">-</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">✦</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Blazing-fast</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">✦</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">deployment</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">for</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">your</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">projects</span></span><span class="line"><span style="color: #DCDCAA">-</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">✦</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Exclusive</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">✦</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">access</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">to</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">resources</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">to</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">make</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">your</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">project</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">successful</span></span><span class="line"><span style="color: #DCDCAA">-</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">An</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">✦</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Awesome</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">✦</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">community</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">and</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">full</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">enjoyment</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">of</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Strapi's ecosystem</span></span><span class="line"></span><span class="line"><span style="color: #CE9178">Start your 14-day free trial now!</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: #CE9178">? Please log in or sign up. Skip</span></span><span class="line"><span style="color: #CE9178">? Do you want to use the default database (sqlite) ? (Y/n) n</span></span><span class="line"><span style="color: #CE9178">? Choose your default database client mysql</span></span><span class="line"><span style="color: #CE9178">? Database name: demo1</span></span><span class="line"><span style="color: #CE9178">? Host: localhost</span></span><span class="line"><span style="color: #CE9178">? Port: 3306</span></span><span class="line"><span style="color: #CE9178">? Username: root</span></span><span class="line"><span style="color: #CE9178">? Password: ****</span></span><span class="line"><span style="color: #CE9178">? Enable SSL connection: (y/N) N</span></span><span class="line"><span style="color: #CE9178">? Start with an example structure &amp; data? (y/N) N</span></span><span class="line"><span style="color: #CE9178">? Start with Typescript? (Y/n) n</span></span><span class="line"><span style="color: #CE9178">? Install dependencies with npm? (Y/n) Y</span></span><span class="line"><span style="color: #CE9178">? Initialize a git repository? (Y/n) n</span></span></code></pre></div></div></figure><ul><li><code>? Please log in or sign up. Skip</code>：意思是让你进行在线登录，我选择跳过</li><li><code>? Do you want to use the default database (sqlite) ? (Y/n) n</code>：是否使用默认的 sqlite 数据库，我选择否</li><li><code>? Choose your default database client mysql</code>：出现三个选项让你选择，我选择 mysql</li><li><code>? Database name: demo1</code>：输入要连接的数据库名字（准备好一个空表的数据库）</li><li><code>? Host: localhost</code>：数据库的 host 地址，本地就是 localhost，远程填公网 ip</li><li><code>? Port: 3306</code>：数据库端口，我选择默认端口 3306</li><li><code>? Enable SSL connection: (y/N) N</code>：是否启用 SSL 连接？可自行决定（<a href="https://wiki.sqlfans.cn/mysql/mysql-bp-ssl-enable.html">什么是数据库 SSL 连接？</a>）</li><li><code>? Start with an example structure &amp; data? (y/N) N</code>：是否需要安装时附带简单数据？我自行决定数据，所以选否</li><li><code>? Start with Typescript? (Y/n) n</code>：项目需要 TypeScript 吗？可自行决定</li><li><code>? Install dependencies with npm? (Y/n) Y</code>：是否使用 npm 安装依赖？我选择是，省去手动安装依赖的命令</li><li><code>? Initialize a git repository? (Y/n) n</code>：是否初始化一个 git 仓库？可自行决定</li></ul><p>经过些许等待，看到以下画面说明成功了：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111812868.png" alt="image-20241011181201688"></p><p>如果你在安装时选择了不自动安装依赖，进入项目内是没有 node-modules 包的，可手动安装</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span></span></code></pre></div></div></figure><p>安装好依赖之后请先别着急启动，接着看汉化步骤（如果你英语好，也请看看汉化小节的最后，运行命令在那里）</p><h2 id="strapi汉化"><a class="markdownIt-Anchor" href="#strapi汉化"></a> Strapi 汉化</h2><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409210045773.png" alt="image-20240921004508650"></p><p>项目运行登录进面板之后点击左下角的 profile 进行设置</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409210109467.png" alt="image-20240921010929358"></p><h2 id="运行strapi应用"><a class="markdownIt-Anchor" href="#运行strapi应用"></a> 运行 Strapi 应用</h2><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">run</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">develop</span></span></code></pre></div></div></figure><p>或</p><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">yarn</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">develop</span></span></code></pre></div></div></figure><h2 id="strapi运行-mysql建表报错"><a class="markdownIt-Anchor" href="#strapi运行-mysql建表报错"></a> Strapi 运行 - MySQL 建表报错</h2><blockquote><p>Error: alter table <code>i18n_locale</code> add index <code>i18n_locale_documents_idx</code>(<code>document_id</code>, <code>locale</code>, <code>published_at</code>)<br>Specified key was too long; max key length is 1000 bytes</p></blockquote><p>类似上述报错，这是因为 MySQL 对于 <a href="https://so.csdn.net/so/search?q=InnoDB%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E&amp;spm=1001.2101.3001.7020">InnoDB 存储引擎</a>有一个索引键长度的限制，这个限制基于字符集的不同而不同。在使用 <code>utf8</code> 字符集时，每个字符可能占用 <code>3</code> 个字节，那么对于 <code>innodb</code> 表，索引键的最大长度大约为 <code>1000</code> 个字符左右（因为 <code>3072 / 3 ≈ 1024</code>）。若字符集是 <code>utf8mb4</code>，每个字符可能占用 <code>4</code> 个字节，所以最大长度会进一步减少到 <code>768</code> 个字符左右（<code>3072 / 4 = 768</code>）</p><blockquote><p>uf8mb4 字符集:<br>要在 Mysql 中保存 4 字节长度的 UTF-8 字符，需要使用 utf8mb4 字符集（mb4 就是 most bytes 4 的意思，专门用来兼容四字节的 unicode），但只有 5.5.3 版本以后的才支持。<br>为了获取更好的兼容性，应该总是使用 utf8mb4 而非 utf8. 对于 CHAR 类型数据，utf8mb4 会多消耗一些空间，根据 Mysql 官方建议，使用 VARCHAR 替代 CHAR。其实，utf8mb4 是 utf8 的超集，理论上原来使用 utf8，然后将字符集修改为 utf8mb4，也会不会对已有的 utf8 编码读取产生任何问题。当然，为了节省空间一般情况下使用 utf8 也就够了。</p></blockquote><h3 id="解决办法"><a class="markdownIt-Anchor" href="#解决办法"></a> 解决办法</h3><p>由于我使用的是 PHPstudy 集成的 MySQL8 所以直接找到 PHPstudy 将引擎改为 InnoDB 就好了</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409210102415.png" alt="image-20240921010242363"></p><h2 id="strapi启动项目登录凭证"><a class="markdownIt-Anchor" href="#strapi启动项目登录凭证"></a> Strapi 启动项目登录凭证</h2><p>正确启动之后，会自动打开浏览器访问 admin 管理面板的注册页面，请自行注册。</p><p>注册产生的凭证决定你是否能登录上 Strapi 的管理面板，请妥善保存你的登录信息。</p><p>可只保存关键信息，下面是我的示例：</p><table><thead><tr><th>配置项</th><th>值</th></tr></thead><tbody><tr><td> name</td><td>4rozen</td></tr><tr><td> 姓氏</td><td> Chen</td></tr><tr><td> 电子邮件</td><td><code>maril4chen@foxmail.com</code></td></tr><tr><td>密码</td><td> Strapi1005</td></tr></tbody></table><h2 id="了解strapi的身份管理机制"><a class="markdownIt-Anchor" href="#了解strapi的身份管理机制"></a> 了解 Strapi 的身份管理机制</h2><p>Strapi 可以设置普通注册用户为 Authenticaed 或 public 分组</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409231751921.png" alt="image-20240923175122837" style="zoom:67%;"><p>由于进行普通注册会默认得到 jwt 令牌，所以我们可以设置为 Authenticaed 分组</p><p>这里你一定会疑惑 Strapi 的身份机制到底是什么？</p><p>对普通用户简单来说有以下身份：</p><ol><li>public：未经过身份验证的用户所在分组，访问接口只能访问公共接口</li><li> Authenticaed：经过身份验证的用户所在分组，访问接口更多</li></ol><blockquote><p>身份验证发生在登录或者是注册，能完成其中之一都可以算作身份验证通过</p></blockquote><p>每一个用户登录之前都是 public 用户，在注册后就成为了 Authenticaed user 经过验证的用户。</p><p>Strapi 使用 Roles 来对普通注册的 user 用户进行分组，在 content manager 中有默认创建的 Users 表，可以点击用户进行设置，分为以下身份：</p><ul><li><p>Authenticaed：身份验证通过的用户</p></li><li><p>public：路人</p></li></ul><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409231812271.png" alt="image-20240923181205208"></p><p>Strapi 同样也对通过后台 admin 进行注册的管理员用户使用 Roles 来进行管理，分为：</p><ul><li>Author：作者可以管理他们创建的内容。</li><li>Editor：编辑者可以管理和发布内容，包括其他用户的内容。</li><li>Super Admin：超级用户可以访问和管理所有功能和设置。</li></ul><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409231817758.png" alt="image-20240923181701691"></p><p><strong>第一次注册进来默认是 Super Admin 超级管理员。</strong></p><p>如果有更多人，点击 Administration panel 管理面板中的 Roles 角色可以进行分组管理。</p><h2 id="如何创建表结构"><a class="markdownIt-Anchor" href="#如何创建表结构"></a> 如何创建表结构</h2><p>可能看到上面的身份管理你一脸懵，没关系，我们先来创建一个用于存放商品信息的示例表：</p><ol><li><p>点击左侧侧边栏的 Content-Type Builder 内容构建<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111826492.png" alt="image-20241011182621412"></p></li><li><p>点击 Create new collection type 创建内容集合类型的复杂数据表，这种表结构支持表与表之间的引用关联，这有助于我们创建符合数据要求的数据结构<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111828046.png" alt="image-20241011182837966"></p></li><li><p>填写单数形式的表名，当然复数形式的表名也可以<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111832024.png" alt="image-20241011183217936" style="zoom:67%;"></p></li><li><p>点击 ADVANCED SETTINGS 高级设置<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111834339.png" alt="image-20241011183455258" style="zoom:67%;"></p></li><li><p>点击 Continue 继续，此时需要你进行表的字段设置，比如设置商品名和商品图如下：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111837231.png" alt="image-20241011183733123" style="zoom:67%;"></p><p>具体设置 Text 类型的商品名如下：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111841019.png" alt="image-20241011184132933" style="zoom:67%;"><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111843156.png" alt="image-20241011184331055" style="zoom:67%;"></p><p>设置商品图片如下：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111845558.png" alt="image-20241011184512477" style="zoom:67%;"><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111846054.png" alt="image-20241011184637966" style="zoom:67%;"><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111847286.png" alt="image-20241011184717164" style="zoom:67%;"></p><p>添加成功之后别忘记点击 Save 保存</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111848805.png" alt="image-20241011184806683"></p><p>之后 Strapi 将进行重启，不出意外将成功创建 Good 数据表和我们刚才添加的字段：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111853588.png" alt="image-20241011185353508"></p></li><li><p>填充数据：点击左侧边栏的 Content Manager 内容管理选择刚才我们创建的数据表 good 并点击右上角的 Create new entry 创建实体就行了。</p></li></ol><h2 id="strapi接口权限设置"><a class="markdownIt-Anchor" href="#strapi接口权限设置"></a> Strapi 接口权限设置</h2><p>数据表有了，怎么通过接口调试呢？</p><p>Strapi 的接口要想调试，首先得给予权限。</p><ol><li><p>找到左侧侧边栏的 setting 然后点击 Roles<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111953074.png" alt="image-20241011195314924"></p><p><code>Authenticated</code> 为经过注册等身份验证手段的用户，而 Public 为公共用户。这将以此分割接口权限，<code>Public</code> 为随便就能访问的接口，<code>Authenticated</code> 为身份验证之后才能使用的接口</p></li><li><p>除了登录注册接口，我们可能会希望所有接口能够经过权限验证才能通行。但是我这里为了演示，就将 <code>good</code> 表的接口给 <code>Public</code> 用户开通：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410111958468.png" alt="image-20241011195836369" style="zoom:67%;"><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410112000118.png" alt="image-20241011200008789"></p></li><li><p>别忘记右上角点击保存。我这里直接使用浏览器进行接口测试：</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410112008460.png" alt="image-20241011200804395" style="zoom:67%;"></li></ol><p>如果想接口限权，只允许身份验证的用户才能使用的话，就请给 <code>Authenticated</code> 用户开权限而不是 Public</p><h2 id="strapi接口文档查看"><a class="markdownIt-Anchor" href="#strapi接口文档查看"></a> Strapi 接口文档查看</h2><blockquote><p>说到接口，这里推荐安装 document 插件进行可视化查看，因为 Strapi 默认不提供可视化的接口文档，只提供接口路由可供查看。</p><p>插件官方文档：<a href="https://docs.strapi.io/dev-docs/plugins/documentation">https://docs.strapi.io/dev-docs/plugins/documentation</a></p></blockquote><p>安装接口文档插件命令</p><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">yarn</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">add</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">@strapi/plugin-documentation</span></span><span class="line"><span style="color: #6A9955"># 或者npm</span></span><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">@strapi/plugin-documentation</span></span></code></pre></div></div></figure><p>接口文档访问地址</p><figure class="shiki http"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">http://localhost:1337/documentation/v1.0.0#/</span></span></code></pre></div></div></figure><p>其中 Users-Permissions - Auth 为认证用户和普通用户的接口，下面的 User-Permissions 则是管理员端的相关接口。</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409231908943.png" alt="image-20240923190855795"></p><h2 id="配置邮箱发信插件"><a class="markdownIt-Anchor" href="#配置邮箱发信插件"></a> 配置邮箱发信插件</h2><p>Strapi 默认并不会自行配置邮件服务。</p><p>为了能够发送邮件（例如密码重置邮件），需要设置一个邮件提供商（如 SendGrid、Gmail、SMTP 等）。如果没有配置邮件提供商，本地 Strapi 无法实际发送邮件。</p><h3 id="安装-nodemailer-插件"><a class="markdownIt-Anchor" href="#安装-nodemailer-插件"></a> 安装 <code>nodemailer</code> 插件</h3><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955"># using yarn</span></span><span class="line"><span style="color: #DCDCAA">yarn</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">add</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">@strapi/provider-email-nodemailer</span></span><span class="line"></span><span class="line"><span style="color: #6A9955"># using npm</span></span><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">@strapi/provider-email-nodemailer</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--save</span></span></code></pre></div></div></figure><h3 id="配置-email-provider"><a class="markdownIt-Anchor" href="#配置-email-provider"></a> <strong>配置 Email Provider</strong></h3><p>接下来，需要配置邮件提供商。</p><p>在 Strapi 中，邮件服务的配置文件位于 <code>config/plugins.js</code>。国内推荐 qq 或者网易邮箱（自行搜索邮箱开通 SMTP），这里介绍网易邮箱配置：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = ({ </span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4"> }) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> ({</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// ...</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">email:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">config:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">provider:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'nodemailer'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">providerOptions:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">host:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">env</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SMTP_HOST'</span><span style="color: #D4D4D4">), </span><span style="color: #6A9955">// 网易邮箱SMTP服务器地址</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">port:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">env</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SMTP_PORT'</span><span style="color: #D4D4D4">), </span><span style="color: #6A9955">// SSL端口</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">secure:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 使用SSL</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">auth:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">user:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">env</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SMTP_USERNAME'</span><span style="color: #D4D4D4">), </span><span style="color: #6A9955">// 网易邮箱账号</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">pass:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">env</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SMTP_PASSWORD'</span><span style="color: #D4D4D4">), </span><span style="color: #6A9955">// 授权码</span></span><span class="line"><span style="color: #D4D4D4">        },</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 其他自定义Nodemailer选项</span></span><span class="line"><span style="color: #D4D4D4">      },</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">settings:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">defaultFrom:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">env</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SMTP_USERNAME'</span><span style="color: #D4D4D4">),</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">defaultReplyTo:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">env</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SMTP_PASSWORD'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      },</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// ...</span></span><span class="line"><span style="color: #D4D4D4">});</span></span></code></pre></div></div></figure><h3 id="获取-smtp-授权码"><a class="markdownIt-Anchor" href="#获取-smtp-授权码"></a> 获取 SMTP 授权码</h3><ol><li>登录 163 邮箱。</li><li>打开 <strong>设置</strong> -&gt; <strong>POP3/SMTP/IMAP</strong>。</li><li>开启 <strong>SMTP</strong> 服务，并生成授权码（<strong>授权码只展示一次，请妥善保存</strong>）。</li></ol><p>在你的 <code>.env</code> 文件中设置相应的环境变量</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955"># Mail</span></span><span class="line"><span style="color: #9CDCFE">SMTP_HOST</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">smtp.163.com</span></span><span class="line"><span style="color: #9CDCFE">SMTP_PORT</span><span style="color: #D4D4D4">=</span><span style="color: #B5CEA8">465</span></span><span class="line"><span style="color: #9CDCFE">SMTP_USERNAME</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">your_mail0@163.com</span></span><span class="line"><span style="color: #9CDCFE">SMTP_PASSWORD</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">JBxxxxxxxxxxxxtreB</span></span></code></pre></div></div></figure><h3 id="修改template模板"><a class="markdownIt-Anchor" href="#修改template模板"></a> 修改 template 模板</h3><p><strong>将模板中的发件人和刚才配置的插件文件中的发件人一致</strong></p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409232306287.png" alt="image-20240923230633136"></p><p>否则你可能遇到错误</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">Error:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Mail</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">command</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">failed:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">501</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Mail</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">address</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">must</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">be</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">same</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">as</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">authorization</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">user.</span></span></code></pre></div></div></figure><h2 id="api-查询媒体数据"><a class="markdownIt-Anchor" href="#api-查询媒体数据"></a> API - 查询媒体数据</h2><p>在查询某些包含关系、媒体字段（图片、视频等）、组件或动态区域的接口时，如果不在查询参数中加上 <code>populate</code> 参数，Strapi 将默认不会查询返回，这是出于性能考虑。</p><p>例如 <code>/api/users/me</code> 接口，假设 Users 表中还包含一个 avatar 头像字段，则想要接口返回头像数据，应该是如下查询（<code>*</code> 表示查询所有关系）</p><figure class="shiki http"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">http://localhost:1337/api/users/me?populate=*</span></span></code></pre></div></div></figure><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409242108207.png" alt="image-20240924210837091"></p><blockquote><p>populate 参数中文文档参考：<a href="https://strapi.nodejs.cn/dev-docs/api/rest/populate-select/">https://strapi.nodejs.cn/dev-docs/api/rest/populate-select/</a></p></blockquote><h2 id="api-查询特定字段"><a class="markdownIt-Anchor" href="#api-查询特定字段"></a> API - 查询特定字段</h2><p>查询请求可以接受 <code>fields</code> 参数来<strong>仅选择</strong>某些字段。默认情况下，仅返回以下 <a href="https://strapi.nodejs.cn/dev-docs/backend-customization/models#model-attributes">字段类型</a>：</p><ul><li>字符串类型：字符串、文本、富文本、枚举、电子邮件、密码和 uid，</li><li>日期类型：日期、时间、日期时间和时间戳，</li><li>号码类型：整数、大整数、浮点数和小数，</li><li>通用类型：布尔值、数组和 JSON。</li></ul><blockquote><p>字段选择不适用于关系、媒体、组件或动态区域字段。要填充这些字段，请使用 <a href="https://strapi.nodejs.cn/dev-docs/api/rest/populate-select/#population"><code>populate</code> 参数</a>。</p></blockquote><p>该参数可以限制响应的数据字段，可以使得某些数据不被暴露，一定程度提高安全性和数据简洁性。</p><p>例如 <code>/api/users/me</code> 接口，查询所有的关系返回数据为</p><figure class="shiki json"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">11</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"dtree1c2woi3njmz56xmttcm"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"username"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"xiaowu1"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"email"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"1681237971@qq.com"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"provider"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"local"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"confirmed"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"blocked"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-23T16:06:23.045Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-24T12:51:20.561Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"publishedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-24T12:51:20.528Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"locale"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"avatar"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">32</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"nq7hj2shguktf5begtsluvup"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"name"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"头像.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"alternativeText"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"caption"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"width"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">350</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"height"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">350</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"formats"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"thumbnail"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"ext"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">".jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"url"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"/uploads/thumbnail__993e719107.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"hash"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"thumbnail__993e719107"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"mime"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"image/jpeg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"name"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"thumbnail_头像.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"path"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"size"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">7.37</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"width"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">156</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"height"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">156</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"sizeInBytes"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">7369</span></span><span class="line"><span style="color: #D4D4D4">            }</span></span><span class="line"><span style="color: #D4D4D4">        },</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"hash"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"_993e719107"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"ext"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">".jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"mime"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"image/jpeg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"size"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20.89</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"url"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"/uploads/_993e719107.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"previewUrl"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"provider"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"local"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"provider_metadata"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-24T12:51:16.512Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-24T12:51:16.512Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"publishedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-24T12:51:16.513Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"locale"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>如果带上下面的请求参数</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/users/me?fields=username,email,createdAt,updatedAt,id</span><span style="color: #D4D4D4">&amp;</span><span style="color: #DCDCAA">populate[avatar][fields]</span><span style="color: #D4D4D4">=id,height,width,name,updatedAt,ext</span></span></code></pre></div></div></figure><p>则返回数据为</p><figure class="shiki json"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">11</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"dtree1c2woi3njmz56xmttcm"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"username"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"xiaowu1"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"email"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"1681237971@qq.com"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-23T16:06:23.045Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-24T12:51:20.561Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"avatar"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">32</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"nq7hj2shguktf5begtsluvup"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"height"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">350</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"width"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">350</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"name"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"头像.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-24T12:51:16.512Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"ext"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">".jpg"</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="参数解释"><a class="markdownIt-Anchor" href="#参数解释"></a> 参数解释</h3><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/users/me?fields=username,email,createdAt,updatedAt,id</span><span style="color: #D4D4D4">&amp;</span><span style="color: #DCDCAA">populate[avatar][fields]</span><span style="color: #D4D4D4">=id,height,width,name,updatedAt,ext</span></span></code></pre></div></div></figure><p><code>fields</code> 关键字表示要进行第一级的字段选取，<code>populate[第一个参数][第二个参数]</code> 的第一个中括号参数为第二级字段的根节点（这里是 <code>avatar</code>），接着第二个中括号写 <code>fields</code> 关键字，表示要进行选取的字段名，这里是 <code>id,height,width,name,updatedAt,ext</code></p><h2 id="api-文件上传"><a class="markdownIt-Anchor" href="#api-文件上传"></a> API - 文件上传</h2><p>Strapi 的文件上传除了在管理面板中进行上传之外，还可以通过接口的方式进行上传（Strapi 支持 blob、base64 上传，请提前给予权限）</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409260028631.png" alt="image-20240926002852546"></p><p>请在接口前加上 /api，即：</p><figure class="shiki http"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">http://localhost:1337/api/upload</span></span></code></pre></div></div></figure><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409260029602.png" alt="image-20240926002913544"></p><p>例如在 apifox 中进行测试：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409260033256.png" alt="image-20240926003359170"></p><h2 id="api-更新包含媒体字段的数据"><a class="markdownIt-Anchor" href="#api-更新包含媒体字段的数据"></a> API - 更新包含媒体字段的数据</h2><p>那么如果我创建了一个数据表其中包含一个媒体字段，如何更新该表中的数据？</p><p>假设该表如下：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409260036848.png" alt="image-20240926003626793"></p><p>请求接口为：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">POST</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles/:id</span></span></code></pre></div></div></figure><p>访问接口文档插件的地址，你会发现它的示例如下：</p><figure class="shiki json"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">"data"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"title"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"string"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"content"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"string"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"cover_img"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"string or id"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"state"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"article_category"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"string or id"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"author"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"string or id"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"locale"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"string"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"localizations"</span><span style="color: #D4D4D4">: [</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #CE9178">"string or id"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #CE9178">"string or id"</span></span><span class="line"><span style="color: #D4D4D4">    ]</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p><code>"cover_img": "string or id"</code></p><p>string 或者 id？string 说是网络地址我都能理解，id 是什么？</p><ul><li>实际上该接口仅仅允许你<strong>通过已经上传的图片 id 进行设置 cover_img</strong></li></ul><p><strong>也就是说你要先将更换好的图片进行上传，然后得到它的 id，再将该 id 赋值给 cover_img 才行</strong></p><p><s>折腾了我一晚上，各种曲线救国写的累死人，没想到随意一个测试，原来是这样的…… 哈哈😎😎</s></p><h2 id="api-strapi条件查询"><a class="markdownIt-Anchor" href="#api-strapi条件查询"></a> API-Strapi 条件查询</h2><p>Strapi 如何进行条件查询？</p><blockquote><p>参考文档：</p><ul><li>文档服务 API 可用方法：<a href="https://strapi.nodejs.cn/dev-docs/api/document-service">https://strapi.nodejs.cn/dev-docs/api/document-service</a></li><li> 文档服务 API 过滤器：<a href="https://strapi.nodejs.cn/dev-docs/api/document-service/filters">https://strapi.nodejs.cn/dev-docs/api/document-service/filters</a></li></ul></blockquote><p>总之，Strapi 提供了一些常见的查询操作符，我们可以通过这些操作符进行各种条件查询。常用操作符包括：</p><table><thead><tr><th>操作符</th><th>含义</th><th>示例</th></tr></thead><tbody><tr><td><code>$eq</code></td><td>等于</td><td><code>filters[title][$eq]=Vue.js Tutorial</code></td></tr><tr><td><code>$ne</code></td><td>不等于</td><td><code>filters[title][$ne]=Vue.js Tutorial</code></td></tr><tr><td><code>$lt</code></td><td>小于</td><td><code>filters[views][$lt]=1000</code></td></tr><tr><td><code>$lte</code></td><td>小于等于</td><td><code>filters[views][$lte]=1000</code></td></tr><tr><td><code>$gt</code></td><td>大于</td><td><code>filters[views][$gt]=1000</code></td></tr><tr><td><code>$gte</code></td><td>大于等于</td><td><code>filters[views][$gte]=1000</code></td></tr><tr><td><code>$contains</code></td><td>包含（字符串部分匹配）</td><td><code>filters[title][$contains]=Vue</code></td></tr><tr><td><code>$startsWith</code></td><td>以指定字符串开头</td><td><code>filters[title][$startsWith]=Vue</code></td></tr><tr><td><code>$endsWith</code></td><td>以指定字符串结尾</td><td><code>filters[title][$endsWith]=Tutorial</code></td></tr><tr><td><code>$null</code></td><td>字段值为空</td><td><code>filters[coverImage][$null]=true</code></td></tr><tr><td><code>$in</code></td><td>在给定数组中</td><td><code>filters[category][$in][0]=News</code></td></tr><tr><td><code>$between</code></td><td>在两个值之间</td><td><code>filters[views][$between][0]=10&amp;filters[views][$between][1]=100</code></td></tr></tbody></table><p>示例</p><p>查询 <code>views</code> 字段在 100 和 1000 之间的文章：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles?filters[views][</span><span style="color: #9CDCFE">$gte</span><span style="color: #CE9178">]=</span><span style="color: #B5CEA8">100</span><span style="color: #D4D4D4">&amp;</span><span style="color: #DCDCAA">filters[views][$lte]</span><span style="color: #D4D4D4">=1000</span></span></code></pre></div></div></figure><p>查询 <code>category</code> 是 "Tech" 或 "News" 的文章：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles?filters[category][</span><span style="color: #9CDCFE">$in</span><span style="color: #CE9178">][</span><span style="color: #B5CEA8">0</span><span style="color: #CE9178">]=Tech</span><span style="color: #D4D4D4">&amp;</span><span style="color: #DCDCAA">filters[category][$in][1]</span><span style="color: #D4D4D4">=News</span></span></code></pre></div></div></figure><p>假设数据如下（接口是：/api/articles）</p><figure class="shiki json"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"data"</span><span style="color: #D4D4D4">: [</span></span><span class="line"><span style="color: #D4D4D4">        {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"fuki5p5xzjnk5n7vfvwzv9c4"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"title"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"CTF-WP"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"content"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"&lt;p&gt;这是一份测试内容数据321&lt;/p&gt;"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"state"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T05:29:27.298Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:15:03.198Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"publishedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:15:03.188Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"cover_img"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">45</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"nzpwo3hy9qkesr5l0uqd1k02"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"name"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"1607569780_678488.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"alternativeText"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"caption"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"width"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1920</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"height"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1080</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"ext"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">".jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"mime"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"image/jpeg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"url"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"/uploads/1607569780_678488_991350393d.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:15:03.111Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:15:03.111Z"</span></span><span class="line"><span style="color: #D4D4D4">            },</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"article_category"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">6</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"qznn6b3nxzqxyv9qlzyu6t65"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"category_name"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"mod修改"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"category_alias"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"mod"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T07:58:18.423Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T07:58:18.423Z"</span></span><span class="line"><span style="color: #D4D4D4">            }</span></span><span class="line"><span style="color: #D4D4D4">        },</span></span><span class="line"><span style="color: #D4D4D4">        {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"hevczglj0hqyjc5h5zva0cb9"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"title"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"这是测试新增文章的标"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"content"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"&lt;p&gt;托尔斯泰&lt;/p&gt;"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"state"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:33:11.929Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:33:11.929Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"publishedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:33:11.924Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"cover_img"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">48</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"curr9bdzmqaxi6hz9sw2f7q8"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"name"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"d6ef9eb44aed2e7335cd59efc201a18b86d6fa60.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"alternativeText"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"caption"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"width"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1920</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"height"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1200</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"ext"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">".jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"mime"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"image/jpeg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"url"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"/uploads/d6ef9eb44aed2e7335cd59efc201a18b86d6fa60_41d5dbc6ce.jpg"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:33:11.737Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T17:33:11.737Z"</span></span><span class="line"><span style="color: #D4D4D4">            },</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"article_category"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"id"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"documentId"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"dchbyr5f11zshu2gb2thyxvh"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"category_name"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"随想"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"category_alias"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"suixiang"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"createdAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T07:57:58.692Z"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">"updatedAt"</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">"2024-09-25T07:57:58.692Z"</span></span><span class="line"><span style="color: #D4D4D4">            }</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">    ],</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"meta"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">"pagination"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"page"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"pageSize"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">25</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"pageCount"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">"total"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">2</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="根据分类id和文章发布状态进行查询"><a class="markdownIt-Anchor" href="#根据分类id和文章发布状态进行查询"></a> 根据分类 id 和文章发布状态进行查询</h3><p>怎么根据分类 id 和文章发布状态进行查询？比如我要查询文章所属分类为随想且发布状态为已发布</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles?filters[article_category][id][</span><span style="color: #9CDCFE">$eq</span><span style="color: #CE9178">]=</span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">&amp;</span><span style="color: #DCDCAA">filters[state][$eq]</span><span style="color: #D4D4D4">=</span><span style="color: #DCDCAA">true</span></span></code></pre></div></div></figure><h3 id="分页查询"><a class="markdownIt-Anchor" href="#分页查询"></a> 分页查询</h3><p>通过 <code>pagination</code> 参数在请求中实现分页查询。Strapi 的分页功能包括 <code>page</code>（页码）和 <code>pageSize</code>（每页显示的记录数），我们可以在 API 请求的 URL 中传递这些参数。例如：</p><p>查询第 2 页的数据，并且每页显示 5 条文章，URL 可以写成这样</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles?pagination[page]=</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">&amp;</span><span style="color: #9CDCFE">pagination</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">pageSize</span><span style="color: #D4D4D4">]=</span><span style="color: #B5CEA8">5</span></span></code></pre></div></div></figure><p>分页查询的结果中，Strapi 会在 <code>meta</code> 字段中返回有关分页的信息：</p><figure class="shiki json"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">"data"</span><span style="color: #D4D4D4">: [ </span><span style="color: #F44747">...</span><span style="color: #D4D4D4"> ],  </span><span style="color: #6A9955">// 数据列表</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">"meta"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"pagination"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">"page"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">,        </span><span style="color: #6A9955">// 当前页码</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">"pageSize"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">,    </span><span style="color: #6A9955">// 每页显示条数</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">"pageCount"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">,  </span><span style="color: #6A9955">// 总页数</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">"total"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50</span><span style="color: #D4D4D4">       </span><span style="color: #6A9955">// 总记录数</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="模糊查询"><a class="markdownIt-Anchor" href="#模糊查询"></a> 模糊查询</h3><p>Strapi 支持通过 API 进行模糊查询，我们可以使用 <code>filters</code> 参数结合 <code>$contains</code> 运算符来实现模糊查询。例如：</p><p>根据文章标题（<code>title</code> 字段）进行模糊查询，查询包含某个关键词的文章列表，API 请求可以这样写：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles?filters[title][</span><span style="color: #9CDCFE">$contains</span><span style="color: #CE9178">]=keyWord</span></span></code></pre></div></div></figure><p>我们甚至可以结合分页查询和模糊查询</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">/api/articles?filters[title][$contains]</span><span style="color: #D4D4D4">=</span><span style="color: #DCDCAA">test</span><span style="color: #D4D4D4">&amp;</span><span style="color: #9CDCFE">pagination</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">page</span><span style="color: #D4D4D4">]=</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">&amp;</span><span style="color: #9CDCFE">pagination</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">pageSize</span><span style="color: #D4D4D4">]=</span><span style="color: #B5CEA8">5</span></span></code></pre></div></div></figure><h3 id="排序查询"><a class="markdownIt-Anchor" href="#排序查询"></a> 排序查询</h3><p>Strapi 支持通过 API 查询时对数据进行排序。我们可以使用 <code>sort</code> 参数来指定排序字段和顺序。</p><h4 id="单字段排序查询"><a class="markdownIt-Anchor" href="#单字段排序查询"></a> 单字段排序查询</h4><p>单字段排序查询例如：</p><p>根据 <code>updatedAt</code> 字段进行排序，可以按照如下方式查询最新更新的文章</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles?sort=updatedAt:desc</span></span></code></pre></div></div></figure><p><code>sort=updatedAt:desc</code>：按照 <code>updatedAt</code> 字段降序排列（最新的文章在前）</p><ul><li><code>desc</code>：降序排列，从新到旧。</li><li><code>asc</code>：升序排列，从旧到新。</li></ul><h4 id="多字段排序"><a class="markdownIt-Anchor" href="#多字段排序"></a> 多字段排序</h4><p>例如，首先按 <code>state</code>（状态），然后按 <code>updatedAt</code>：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles?sort=state:asc,updatedAt:desc</span></span></code></pre></div></div></figure><p>这将先按 <code>state</code> 升序排列，再按 <code>updatedAt</code> 降序排列。</p><h4 id="结合分页和过滤"><a class="markdownIt-Anchor" href="#结合分页和过滤"></a> 结合分页和过滤</h4><p>甚至可以将排序与分页、过滤结合使用。例如，查询标题中包含 <code>test</code> 的文章，按 <code>updatedAt</code> 从新到旧排序，并分页显示：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">GET</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/api/articles?filters[title][</span><span style="color: #9CDCFE">$contains</span><span style="color: #CE9178">]=test</span><span style="color: #D4D4D4">&amp;</span><span style="color: #9CDCFE">sort</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">updatedAt:desc</span><span style="color: #D4D4D4">&amp;</span><span style="color: #9CDCFE">pagination</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">page</span><span style="color: #D4D4D4">]=</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">&amp;</span><span style="color: #9CDCFE">pagination</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">pageSize</span><span style="color: #D4D4D4">]=</span><span style="color: #B5CEA8">5</span></span></code></pre></div></div></figure><p>这会返回包含 <code>test</code> 关键词的文章，按更新时间降序排列，并分页显示。</p><h4 id="小结"><a class="markdownIt-Anchor" href="#小结"></a> 小结</h4><p>总之，Strapi 提供了多个过滤操作符，使得我们可以灵活地查询数据</p><ul><li><code>$eq</code>：精确匹配</li><li><code>$ne</code>：不等于</li><li><code>$lt</code>：小于</li><li><code>$lte</code>：小于或等于</li><li><code>$gt</code>：大于</li><li><code>$gte</code>：大于或等于</li><li><code>$contains</code>：包含（模糊查询）</li><li><code>$notContains</code>：不包含</li><li><code>$startsWith</code>：以指定字符串开头</li><li><code>$endsWith</code>：以指定字符串结尾</li></ul><h2 id="结语"><a class="markdownIt-Anchor" href="#结语"></a> 结语</h2><p>目前我碰到的问题基本就是这些，如果有更复杂的项目时，可能才会碰到更多问题……</p><blockquote><p>关于 Nginx 如何监听 Strapi 可以看看我的 <a href="https://4rozen.github.io/2023/10/26/Vue%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85+%E9%83%A8%E7%BD%B2%E5%88%B0GitHub%E4%B8%BAdemo.md/">Vue 打包</a>那篇文章：解决打包后的刷新 404 问题 -&gt;Github Pages 上的 history 路由模式的可行性 -&gt; 一个可能需要的配置参考</p></blockquote><p>我不得不说的是，Strapi 对于表与表之间的引用在 API 接口调试方面体验确实很糟糕，某些接口使用 <code>documentId</code> 有些接口却只认真实 <code>id</code></p><p>不过免费的可用，还能要求什么呢 (〃￣︶￣) 人 (￣︶￣〃)</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>后端笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Strapi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Simple Animated Guns 枪械属性修改</title>
    <link href="/archives/Gamer/64665.html"/>
    <url>/archives/Gamer/64665.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="Minecraft我的世界mod模组：Simple Animated Guns模组枪械属性修改简易教程"># Simple Animated Guns模组枪械属性修改简易教程<blockquote><p>环境：Windows11、Java"17.0.11" 2024-04-16 LTS 64-Bit、PCL2 或其他启动器</p><p>工具：Vscode</p></blockquote><p>省略我半小时的翻看源代码的心路历程，我们直入正题吧… 本文并不复杂，只要不是纯小白，都可一战</p><p>在此之前你需要准备的是：</p><ol><li>原 mod 项目</li><li>一个能用的编辑器，如 Vscode、Sublime</li><li>Java17 环境</li></ol><h2 id="clone或下载原作者项目"><a class="markdownIt-Anchor" href="#clone或下载原作者项目"></a> Clone 或下载原作者项目</h2><blockquote><p>原作者项目地址：<a href="https://github.com/elidhan/Simple-Animated-Guns/tree/1.20.1">Simple-Animated-Guns</a></p><p>由于没有官方修改枪械属性的相关教程，所以我的思路是通过开源的源工程文件进行代码审计，修改好属性后将其编译成一个我们的自定义版本。本文仅供学习参考。</p><p>赞美原作者！！！Fabric 的枪械 mod 真的很少！</p></blockquote><p>进行以下的步骤前，请先确认你操作的分支是否为你需要的分支：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721236869939.png" alt="QQ_1721236869939"></p><p>比如我玩的 BetterMC 是 1.20.1 的，所以我就选择了对应的版本。然后我们需要把原作者的项目搞到本地来，因为我们要进行修改嘛。这里不论是 Git clone 还是下载成压缩包都是需要一定 “本事” 的，有能力的可以自行下载到本地，我这里直接提供蓝奏云的下载链接在文末，请自行下载需要的版本分支项目。</p><h2 id="准备好编辑器"><a class="markdownIt-Anchor" href="#准备好编辑器"></a> 准备好编辑器</h2><p>我推荐使用微软的 vsocde 作为编辑器，这个编辑器在微软商店就能下载到：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721237162354.png" alt="QQ_1721237162354"></p><p>当然你也可以使用你习惯的编辑器，Sublime Text 啥的都可以。如果你的 Vscode 是英文的不习惯，可以自行搜索 Vscode 汉化，或者参考下面的文章：</p><ul><li><a href="https://blog.csdn.net/danshiming/article/details/132110419">Vscode 设置中文</a></li><li><a href="https://blog.csdn.net/qq_45565693/article/details/128421869">Vscode 安装汉化插件不生效</a></li></ul><h2 id="准备好java环境"><a class="markdownIt-Anchor" href="#准备好java环境"></a> 准备好 Java 环境</h2><p>如果你下载好了项目文件，请将其解压。然后咱们来检查目录中是否存在 <code>build.gradle</code> 文件，如果没有请重新下载，不出意外是有的。项目目录应该如下：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721238704344.png" alt="QQ_1721238704344"></p><p>请使用我们准备好的 Vscode 将其打开，不出意外你会得到：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721239112188.png" alt="QQ_1721239112188"></p><p>可以看到这里要求的 Java 版本。请按要求切换本地 Java 版本环境，也就是转到系统环境变量进行调整。如果你忘记本地 Java 版本，请使用命令行执行查看版本命令，查看本地 Java 版本的命令是：</p><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">java</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-version</span></span></code></pre></div></div></figure><p>Win+R 就可以打开运行，然后输入 cmd 就可以打开一个命令行了。</p><p>上述命令需要你配置好 Java 环境变量。如果出现版本号且版本对得上，就说明你的 Java 环境是 ok 的；如果你从未安装过 Java 只是在使用启动器时有所耳闻，<strong>可以参考下面的文章来安装并配置 Java 环境变量</strong>（文末我会提供 Java17 版本 123 云盘链接，蓝奏云限制 100m 大小没办法）。</p><p>环境变量的作用就是能让你在命令行内直接使用 java 命令，而不是必须得在 java.exe 目录下才能使用 java 命令</p><ul><li><a href="https://blog.csdn.net/godot06/article/details/104378253">Java 基础 1 - 环境篇：JDK 安装与环境变量配置</a></li></ul><p>如果你使用我提供的 Java17 安装包，也请看一看上面的这篇文章，直接跳到 <code>1-2安装</code>步骤即可，或者自行搜索可信的教程文章也是可以的。</p><p>上述文章在环境变量配置中，关键字符串如下（分号是变量值最后如果没有分号才需要加）</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">;</span><span style="color: #DCDCAA">%JAVA_HOME%\bin</span><span style="color: #D4D4D4">;</span><span style="color: #DCDCAA">%JAVA_HOME%\jre\bin</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>如果你的 PATH 变量不是文章中的样式，而是和我一样是列表，那就简单得多了直接点右边的新建就可以：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721243505134.png" alt="QQ_1721243505134"></p><p>好了，如果不出意外你已经可以通过 cmd（Win+R 输入 cmd 即可）执行 java 命令了。如果你忘记 Java 在哪，可以使用下面的命令</p><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">where</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">java</span></span></code></pre></div></div></figure><h2 id="解析-simple-animated-guns枪械属性"><a class="markdownIt-Anchor" href="#解析-simple-animated-guns枪械属性"></a> 解析 - Simple Animated Guns 枪械属性</h2><p>请使用我们准备好的 Vscode 编辑器打开项目</p><p>如果你安装时选择了将 Vscode 添加到右键菜单，则可以直接在项目目录空白处直接右键将其作为项目打开：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721244782340.png" alt="QQ_1721244782340"></p><p>你的右键菜单可能和我不一样，因为我嫌它安装时给我的字太长了不好看，所以改成了 <code>Open as Project</code></p><p>如果你没有，那么你可以直接打开 Vscode，在左上角点击文件 -&gt; 打开文件夹，然后找到项目文件夹就好了</p><p>打开后，你会得到一个相对简洁的界面：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721245065074.png" alt="QQ_1721245065074"></p><p>鼠标左键点击箭头指向的图标就可以看到我们的工程项目文件目录了。</p><p>Ok，我们先来看看总览性的东西吧。</p><p>我们找到：<code>src\main\resources\assets\anim_guns\lang\en_us.json</code> 的这个 en_us.json 文件</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721245291655.png" alt="QQ_1721245291655"></p><p>这个就是作者定义的全部相关东西了。值得一提的是，在原地址的 default 分支，也就是 1.18.2v1-test-arms-weaponmods 分支中，几乎相同的位置下是存在官方汉化的：</p><p>地址：<a href="https://github.com/elidhan/Simple-Animated-Guns/tree/1.18.2v1-test-arms-weaponmods/src/main/resources/assets/anim_guns/lang">https://github.com/elidhan/Simple-Animated-Guns/tree/1.18.2v1-test-arms-weaponmods/src/main/resources/assets/anim_guns/lang</a></p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721245438657.png" alt="QQ_1721245438657"></p><p>不过版本更迭，现在 1.20.1 并没有这份官方汉化 json 文件了，我个人简单翻译了一下，在 1.20.1 版本的同目录下创建了一份 zh_cn.json 文件，以供大家参考。</p><p>个人力量有限，出错在所难免，如遇到请见谅。</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721245633177.png" alt="QQ_1721245633177"></p><p>有了这份总览，心中总算也是踏实许多。</p><p>接下来我们找到：<code>src\main\java\net\elidhan\anim_guns\item\ModItems.java</code></p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721245988951.png" alt="QQ_1721245988951"></p><p>下面就是我找到 GunItem.java 中的构造函数后进行对照再为大家进行注释解释后的代码了，我这里仅用第一个枪械做例子。</p><p><s>因为其他的枪械是大差不差的，除了开火模式全自动半自动的差别、装填方式、持枪方式、可装备的附件类型外，基本差不多？。</s></p><h3 id="属性值一览"><a class="markdownIt-Anchor" href="#属性值一览"></a> 属性值一览</h3><p>1.20.1 版本分支构造函数如下：</p><figure class="shiki java"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">GunItem</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">Settings</span><span style="color: #D4D4D4"> settings, </span><span style="color: #4EC9B0">String</span><span style="color: #D4D4D4"> gunID, </span><span style="color: #4EC9B0">String</span><span style="color: #D4D4D4"> animationID,</span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">float</span><span style="color: #D4D4D4"> gunDamage, </span><span style="color: #4EC9B0">int</span><span style="color: #D4D4D4"> rateOfFire, </span><span style="color: #4EC9B0">int</span><span style="color: #D4D4D4"> magSize,</span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">Item</span><span style="color: #D4D4D4"> ammoType, </span><span style="color: #4EC9B0">int</span><span style="color: #D4D4D4"> reloadCooldown, </span><span style="color: #4EC9B0">float</span><span style="color: #D4D4D4">[] bulletSpread,</span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">float</span><span style="color: #D4D4D4">[] gunRecoil, </span><span style="color: #4EC9B0">int</span><span style="color: #D4D4D4"> pelletCount, </span><span style="color: #4EC9B0">LoadingType</span><span style="color: #D4D4D4"> loadingType,</span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">SoundEvent</span><span style="color: #D4D4D4"> reloadSoundStart, </span><span style="color: #4EC9B0">SoundEvent</span><span style="color: #D4D4D4"> reloadSoundMagOut, </span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">SoundEvent</span><span style="color: #D4D4D4"> reloadSoundMagIn, </span><span style="color: #4EC9B0">SoundEvent</span><span style="color: #D4D4D4"> reloadSoundEnd,</span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">SoundEvent</span><span style="color: #D4D4D4"> shootSound, </span><span style="color: #4EC9B0">SoundEvent</span><span style="color: #D4D4D4"> postShootSound, </span><span style="color: #4EC9B0">int</span><span style="color: #D4D4D4"> reloadCycles,</span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">boolean</span><span style="color: #D4D4D4"> isScoped, </span><span style="color: #4EC9B0">boolean</span><span style="color: #D4D4D4"> unscopeAfterShot,</span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">int</span><span style="color: #D4D4D4"> reloadStage1, </span><span style="color: #4EC9B0">int</span><span style="color: #D4D4D4"> reloadStage2, </span><span style="color: #4EC9B0">int</span><span style="color: #D4D4D4"> reloadStage3, </span><span style="color: #4EC9B0">FiringType</span><span style="color: #D4D4D4"> firingType,</span></span><span class="line"><span style="color: #D4D4D4">                   </span><span style="color: #4EC9B0">ArmType</span><span style="color: #D4D4D4"> armType, </span><span style="color: #9CDCFE">AttachmentItem</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">AttachType</span><span style="color: #D4D4D4">[] acceptedAttachmentTypes)</span></span><span class="line"><span style="color: #D4D4D4">    {</span></span><span class="line"><span style="color: #D4D4D4">        … 实现部分略 …</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><p>主要还是看构造函数中的参数要求，实现部分的赋值倒是可以忽略。</p><p>下面这个是 1.20.1 版本分支的枪械属性注册</p><figure class="shiki java"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 以下为枪械注册属性信息</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// pistol_light为手枪</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 所有枪械id可在src\main\resources\assets\anim_guns\lang\zh_cn.json中找到，zh_cn.json为本人简单翻译，仅供参考</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Item</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">PISTOL</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">registerItem</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"pistol_light"</span><span style="color: #D4D4D4">, </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">GunItem</span><span style="color: #D4D4D4">(</span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">FabricItemSettings</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">maxCount</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">),</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #6A9955">// 以下属性值仅作参考示例，参数类型在src\main\java\net\elidhan\anim_guns\item\GunItem.java中的构造方法GunItem已写明，可自行理解</span></span><span class="line"><span style="color: #D4D4D4">           </span><span style="color: #CE9178">"pistol_light"</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 枪械id，请勿修改</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #CE9178">"pistol_generic"</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 动画id，请勿修改</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 伤害值</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 射速</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">17</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 弹匣容量</span></span><span class="line"><span style="color: #D4D4D4">STANDARD_HANDGUN_BULLET, </span><span style="color: #6A9955">// 弹药类型</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">35</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 重新装填的持续时间，单位为ticks，Minecraft的ticks是1/20秒(s)，也就是50毫秒(ms)</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">float</span><span style="color: #D4D4D4">[] {</span><span style="color: #B5CEA8">1.5f</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1.5f</span><span style="color: #D4D4D4">}, </span><span style="color: #6A9955">// 子弹偏移/散布范围</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">float</span><span style="color: #D4D4D4">[] {</span><span style="color: #B5CEA8">1f</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2.5f</span><span style="color: #D4D4D4">},  </span><span style="color: #6A9955">// 后坐力</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 每次击发的子弹数，主要跟枪械开火模式有关，单发、连发之类的</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">GunItem</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">LoadingType</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">MAGAZINE</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装填方式，这里是弹匣装填</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 重新装填开始时的音效，此处为null</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">ModSounds</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">RELOAD_GENERIC_PISTOL_P1</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装填时，将弹匣拔出的音效</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">ModSounds</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">RELOAD_GENERIC_PISTOL_P2</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装填时，将新弹匣放入的音效</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">ModSounds</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">RELOAD_GENERIC_PISTOL_P3</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装填完毕音效</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">ModSounds</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">PISTOL_LIGHT</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 子弹击发音效</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 射击后的音效，如子弹落地音、枪声回响音等，此处为null</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 重新装填涉及的所有步骤的循环次数，这里为1，表示所有步骤仅做一次</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 是否具有瞄准镜</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 射击后是否取消瞄准状态</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">9</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 下面三个数字都是重新装填子弹的步骤持续时间</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #B5CEA8">20</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">GunItem</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">FiringType</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">SEMI_AUTO</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 射击方式，这里是半自动模式</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">GunItem</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">ArmType</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">HANDGUN_TWOHAND</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装备或持枪方式，这里是双手持枪</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">AttachmentItem</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">AttachType</span><span style="color: #D4D4D4">[]{</span><span style="color: #9CDCFE">AttachmentItem</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">AttachType</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">MUZZLE</span><span style="color: #D4D4D4">}) </span><span style="color: #6A9955">// 可装备的附件类型，这里只有一个MUZZLE（枪口），也可以在json文件查看</span></span><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">} </span><span style="color: #6A9955">// 这里还提供了一个匿名内部类，可自定义</span></span><span class="line"><span style="color: #D4D4D4">    );</span></span></code></pre></div></div></figure><p>下面这个则是 1.18.2v1-test-arms-weaponmods 版本分支的</p><figure class="shiki java"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">   </span><span style="color: #6A9955">// 将sniper_classice狙击步枪进行注册，CLASSIC_SNIPER_RIFLE为注册后的静态名称，主要咱们看GunItem的参数</span></span><span class="line"><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Item</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">CLASSIC_SNIPER_RIFLE</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">registerItem</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"sniper_classic"</span><span style="color: #D4D4D4">, </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">GunItem</span><span style="color: #D4D4D4">(</span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">FabricItemSettings</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">group</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">AnimatedGuns</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">GUNS</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">maxCount</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">), </span><span style="color: #6A9955">//使用FabricItemSettings设置物品的显示效果</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #CE9178">"sniper_classic"</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 枪的ID名，请勿修改</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #CE9178">"sniper_classic"</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 枪的名称，请勿修改</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">29</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 枪的伤害值</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">20</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 枪的射速</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 枪的弹匣弹药容量</span></span><span class="line"><span style="color: #D4D4D4">       HEAVY_RIFLE_BULLET, </span><span style="color: #6A9955">// 枪的子弹类型</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">36</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 子弹装填时间，单位为ticks，Minecraft的ticks是1/20秒(s)，也就是50毫秒(ms)</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">float</span><span style="color: #D4D4D4">[] {</span><span style="color: #B5CEA8">0.125f</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.125f</span><span style="color: #D4D4D4">}, </span><span style="color: #6A9955">// 子弹散布/扩散范围</span></span><span class="line"><span style="color: #D4D4D4"> </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">float</span><span style="color: #D4D4D4">[]{</span><span style="color: #B5CEA8">2.5f</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">8.25f</span><span style="color: #D4D4D4">}, </span><span style="color: #6A9955">// 后坐力</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 每次击发的子弹数，主要跟枪械开火模式有关，全自动和连发之类的</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">GunItem</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">LoadingType</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">PER_CARTRIDGE</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 子弹装填方式，这里是击发一发后就装填一发</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装填开始时的音效</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">ModSounds</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">RELOAD_GENERIC_SNIPER_P1</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装填过程中弹匣拔出音</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">ModSounds</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">RELOAD_CLASSIC_SNIPER_P2</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装填过程中的新的弹匣装填音</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #9CDCFE">ModSounds</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">RELOAD_GENERIC_SNIPER_P3</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 装填结束时的音效</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #9CDCFE">ModSounds</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">SNIPER_CLASSIC</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 子弹击发声音</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 重新装填弹匣的预期子弹数</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 是否具有瞄准镜</span></span><span class="line"><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 是否在射击后取消瞄准效果</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">12</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 下面都是重新装填子弹的各个阶段的持续时间</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">13</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #B5CEA8">24</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">       </span><span style="color: #6A9955">// 后面还有个{}，是一个匿名内部类，此处为空，但是可以在里面添加自定义的方法或覆盖父类的方法</span></span><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">});</span></span></code></pre></div></div></figure><p>当然旧版本会少对应的属性参数，而新版本的 1.20.1 则是增加了持枪动作类型和枪口等附件的支持的。</p><h3 id="构造函数解析"><a class="markdownIt-Anchor" href="#构造函数解析"></a> 构造函数解析</h3><p>GunItem 构造函数的具体参数要求如下：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721381736298.png" alt="1721381736298"></p><p>上面的构造函数参数类型要求请千万做到心中明确。</p><p>如果你学过 Java 或者其他编程语言，这部分你可以跳过，但是也请稍微留意一下参数类型要求。<s>否则修改一时爽，编译（）</s></p><p>好了，收回删除线伏笔，这些枪械可能存在的差异，如：全自动半自动的、装填方式、持枪方式等。我也给大家进行注释解释了，就在：<code>src\main\java\net\elidhan\anim_guns\item\GunItem.java</code> 的 826 行开始：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721247100101.png" alt="QQ_1721247100101"></p><p>这些都是枚举类型的，大家可以自行对应理解。而可装备的附件类型其实就在枪械的上面，或者说，在 json 文件中也能知道，好像就 3 种？：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721247279794.png" alt="QQ_1721247279794">zh_cn.json63 行处：</p><figure class="shiki json"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #CE9178">"item.anim_guns.sight_holo"</span><span style="color: #D4D4D4">:  </span><span style="color: #CE9178">"全息瞄准镜"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #CE9178">"item.anim_guns.grip_foregrip"</span><span style="color: #D4D4D4">:  </span><span style="color: #CE9178">"前握把"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #CE9178">"item.anim_guns.muzzle_mbrake"</span><span style="color: #D4D4D4">:  </span><span style="color: #CE9178">"枪口制动器"</span><span style="color: #D4D4D4">,</span></span></code></pre></div></div></figure><h2 id="实践-属性修改"><a class="markdownIt-Anchor" href="#实践-属性修改"></a> 实践 - 属性修改</h2><p>Ok，现在大家都有了基本认识，我们来简单修改一个 amr_classic 狙击枪的伤害值吧。</p><p>我们找到：<code>src\main\java\net\elidhan\anim_guns\item\ModItems.java</code> 的 689 行开始</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721248383896.png" alt="QQ_1721248383896"></p><p>我们简单修改原伤害值 40 为 50</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721248484232.png" alt="QQ_1721248484232"></p><p>Ok，这里我们的修改完成后，我们基本上就要进行编译了。不过在编译之前，我们先来添加一下国内镜像的仓库源，以防等会编译过程中可能出现的下载慢的情况。</p><p>我们打开 <code>build.gradle</code> 文件</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721248808489.png" alt="QQ_1721248808489"></p><p>添加一个阿里云的 maven 地址：</p><figure class="shiki groovy"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">maven{ url</span><span style="color: #CE9178">'https://maven.aliyun.com/nexus/content/groups/public/'</span><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721248879550.png" alt="QQ_1721248879550"></p><p>好的，我们做完修改之后，点击左上角的文件 -&gt; 全部保存。将我们做的修改保存下来，不然是不会生效的。</p><h2 id="实践-编译"><a class="markdownIt-Anchor" href="#实践-编译"></a> 实践 - 编译</h2><p>别关闭 Vscode 哦，我们直接在打开项目的 Vscode 上点击它上方导航栏的终端选项，<strong>新建一个终端</strong>用来运行我们要执行的命令：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721249073586.png" alt="QQ_1721249073586"></p><p>由于项目自带 gradlew 和 gradlew.bat，所以我们可以不用安装 gradle，我们直接使用它们来编译，执行命令为：</p><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">gradlew</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span></code></pre></div></div></figure><p>如果出现绿字 BUILD SUCCESSFUL in 基本上是没问题的：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721249741382.png" alt="QQ_1721249741382"></p><p>编译后的文件在：Simple-Animated-Guns-1.20.1\build\libs 中</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721249787069.png" alt="QQ_1721249787069"></p><p>不出意外的话，使用上面这个不带 sources 的 jar 包就可以了。</p><h2 id="实践-替换jar包测试"><a class="markdownIt-Anchor" href="#实践-替换jar包测试"></a> 实践 - 替换 jar 包测试</h2><p>打开 PCL2，将 jar 包替换（请备份原文件）</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721249892892.png" alt="QQ_1721249892892"></p><p>这里我将原来我正常使用的 jar 包剪切出去，放在了编译后的目录下统一管理，接下来将我们编译的 jar 放回进行测试：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721249976750.png" alt="QQ_1721249976750"></p><p>替换之后，可以看到 PCL2 可以搜到我们替换的 jar 包</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721250119387.png" alt="QQ_1721250119387"></p><p>接下来就是进游戏测试了：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/2024-07-18_05.07.31.png" alt="2024-07-18_05.07.31"></p><p>可以看到 Damage 伤害变成了我们修改后的 50，成功！</p><p>我会把我的这一份项目源码也上传蓝奏云供大家参考。</p><p>本来到这里也该结束了，但是再稍微提一嘴准星的问题吧。</p><p>因为我是玩的 BetterMC1.20.1，玩过的朋友可能知道，它这个整合包的准星不是传统派的十字，而是十字左右套了个左右括号包裹起来，我是很难习惯，所以我就把它改回了传统的十字准星，这个改法在 BetterMC 的 MC 百科词条下的评论区我发了办法，感兴趣的可以看看：<a href="https://www.mcmod.cn/modpack/205.html">BetterMC 修改准星 489 楼评论</a></p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/QQ_1721252012398.png" alt="QQ_1721252012398"></p><h2 id="相关链接"><a class="markdownIt-Anchor" href="#相关链接"></a> 相关链接</h2><ul><li><p><a href="https://www.123pan.com/s/jqMxjv-rnGQv.html%E6%8F%90%E5%8F%96%E7%A0%81:Java">Java17 下载 - 提取码 Java</a></p></li><li><p><a href="https://wwf.lanzouj.com/b00pzoayid">原作者全版本源码 - 密码:h47e</a></p></li><li><p><a href="https://wwf.lanzouj.com/b00pzoayhc">我的项目源码 v1.20.1 修改版 - 密码 3cr8</a></p></li><li><p><a href="https://code.visualstudio.com/">Vscode 官网下载地址</a></p></li></ul><h2 id="勘误补充"><a class="markdownIt-Anchor" href="#勘误补充"></a> 勘误 &amp; 补充</h2><p>2024 年 7 月 18 日 21:54 勘误，补上原作者全版本源码链接。</p><p>2024 年 7 月 19 日 11:43 补充，在属性值部分补充关于构造函数的参数要求。</p><h2 id="可能遇到的问题"><a class="markdownIt-Anchor" href="#可能遇到的问题"></a> 可能遇到的问题</h2><ul><li>编译的时候显示：<code>Exception in thread "main" javax.net.ssl.SSLHandshakeException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target</code></li></ul><p>​请检查是否开启了系统代理。关闭后再尝试编译。</p><ul><li>编译时报错： 不兼容的类型：从 double 转换到 float 可能会有损失 &amp; 错误：找不到符号 &amp; 构造器 (FabricItemSettings,String,String,double,int,int,Item,int,float [],float [],int,LoadingType,&lt; 空值 &gt;,SoundEvent,SoundEvent,SoundEvent,SoundEvent,&lt; 空值 &gt;,int,boolean,boolean,int,int,int,FiringType,ArmType,AttachType [])</li></ul><p>​请检查属性值是否符合参数要求，如：9.5 默认为 double 类型，而构造函数要求为 float。请改为 9.5f 或 9.5F</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Gamer</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Minecraft</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React18 学习笔记</title>
    <link href="/archives/React/36922.html"/>
    <url>/archives/React/36922.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="React18学习笔记。"><h1 id="react18学习笔记"><a class="markdownIt-Anchor" href="#react18学习笔记"></a> React18 学习笔记</h1><h2 id="创建demo工程"><a class="markdownIt-Anchor" href="#创建demo工程"></a> 创建 demo 工程</h2><p>命令为 <code>npx create-react-app react-basic</code></p><h2 id="严格模式"><a class="markdownIt-Anchor" href="#严格模式"></a> 严格模式</h2><p>React18 默认创建的工程开启了严格模式。React 应用在开发环境下若使用了 React 的严格模式（<code>&lt;React.StrictMode&gt;</code>），在渲染过程中，所有组件都会被调用两次。这是为了帮助检测不严谨的代码和潜在的问题。</p><p>具体在 <code>src\index.js</code> 中将 <code>&lt;React.StrictMode&gt;</code> 标签去掉即可</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">React</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">ReactDOM</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react-dom/client'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'./App'</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">root</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">ReactDOM</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">createRoot</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getElementById</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'root'</span><span style="color: #D4D4D4">));</span></span><span class="line"><span style="color: #9CDCFE">root</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">render</span><span style="color: #D4D4D4">(</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">React.StrictMode</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">App</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #4EC9B0">React.StrictMode</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><p>即：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">React</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">ReactDOM</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react-dom/client'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'./App'</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">root</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">ReactDOM</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">createRoot</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getElementById</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'root'</span><span style="color: #D4D4D4">));</span></span><span class="line"><span style="color: #9CDCFE">root</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">render</span><span style="color: #D4D4D4">(</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">App</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><h2 id="jsx概念"><a class="markdownIt-Anchor" href="#jsx概念"></a> JSX 概念</h2><p>JSX 是 JavaScript 和 XML（HTML）的缩写，并非标准的 JS 语法，而是一种语法扩展，其表示在 JS 代码中编写 HTML 模版结构，它是 React 中编写 UI 模版的方式。</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Hello World</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><blockquote><p>在 React 中，<code>className</code> 是用来指定 HTML 元素的 CSS 类的属性。由于 JavaScript 语言中 <code>class</code> 是一个保留字，因此在 JSX 中使用 <code>class</code> 时会出现语法错误。因此，React 使用 <code>className</code> 来替代 <code>class</code>。</p></blockquote><p>可以使用在线网站查看 jsx 如何被 babel 转为 js 语法：<a href="https://www.babeljs.io">https://www.babeljs.io</a></p><p>点击网站上方导航栏的 try it out 将 react 勾选上就可以简单看看：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091620738.png" alt="image-20241109162000100"></p><h2 id="jsx中使用js表达式"><a class="markdownIt-Anchor" href="#jsx中使用js表达式"></a> JSX 中使用 JS 表达式</h2><p>在 JSX 中可以通过大括号 <code>{}</code> 识别 JavaScript 中的表达式，比如常见的变量、函数调用、方法调用等等。常见场景有：</p><ol><li>使用引号传递字符串</li><li>使用 JavaScript 变量</li><li>函数调用和方法调用</li><li>使用 JavaScript 对象 </li></ol><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">msg</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'Easy React'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">sayMyName</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'The name is John Wick'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Simple Title</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #6A9955">/** 使用引号传递字符串 */</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #CE9178">'This is a string'</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;</span><span style="color: #569CD6">br</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">br</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #6A9955">/** 使用JS变量 */</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">msg</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;</span><span style="color: #569CD6">br</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">br</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #6A9955">/** 函数调用 */</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #DCDCAA">sayMyName</span><span style="color: #D4D4D4">()</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;</span><span style="color: #569CD6">br</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">br</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #6A9955">/** 方法调用 */</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Date</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">toLocaleDateString</span><span style="color: #D4D4D4">()</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;</span><span style="color: #569CD6">br</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">br</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #6A9955">/** 使用JS对象 */</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">{ </span><span style="color: #9CDCFE">color:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'blue'</span><span style="color: #D4D4D4"> }</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">早上好，夜之城。</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091632425.png" alt="image-20241109163225388"></p><p>其中 <code>&lt;div style={{ color: 'blue' }}&gt;早上好，夜之城。&lt;/div&gt;</code> 的 style 的第一层大括号是识别 JS 表达式，用于识别包含 color 属性的对象。</p><div class="note note-warning">            <p>warning</p><p>if 语句、switch 语句、变量声明等属于语句，不是表达式，不能出现在大括号 {} 中</p>          </div><h2 id="jsx实现列表渲染"><a class="markdownIt-Anchor" href="#jsx实现列表渲染"></a> JSX 实现列表渲染</h2><p>渲染需求：</p><figure class="shiki html"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">ul</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4"></span><span style="color: #808080">&lt;</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">凯瑟琳：数学家</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">马里奥：化学家</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">凯西里：化学家</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">沃尔特：化学家</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">苏布拉马妮阳：化学家</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">ul</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>在 JSX 中可以使用原生 JS 的 map 方法变量渲染：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">list</span><span style="color: #D4D4D4"> = [</span></span><span class="line"><span style="color: #D4D4D4">  { </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'John'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">age:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">25</span><span style="color: #D4D4D4"> },</span></span><span class="line"><span style="color: #D4D4D4">  { </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'Mary'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">age:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">30</span><span style="color: #D4D4D4"> },</span></span><span class="line"><span style="color: #D4D4D4">  { </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'Tom'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">age:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">28</span><span style="color: #D4D4D4"> },</span></span><span class="line"><span style="color: #D4D4D4">  { </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'Jane'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">age:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">23</span><span style="color: #D4D4D4"> },</span></span><span class="line"><span style="color: #D4D4D4">  { </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'Bob'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">age:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">35</span><span style="color: #D4D4D4"> }</span></span><span class="line"><span style="color: #D4D4D4">]</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Simple Title</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">ul</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">map</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">li</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #569CD6">}</span><span style="color: #D4D4D4"> - </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">age</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        )</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">ul</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><div class="note note-warning">            <p>warning</p><p><code>key</code> 应当是独一无二的，该值供 React 内部使用，提升列表更新性能</p>          </div><h2 id="jsx条件渲染"><a class="markdownIt-Anchor" href="#jsx条件渲染"></a> JSX 条件渲染</h2><p>语法：在 React 中，可以通过逻辑与运算符 <code>&amp;&amp;</code>、三元表达式 <code>(?:)</code> 实现基础的条件渲染</p><ol><li>逻辑与：<code>{flag &amp;&amp; &lt;span&gt;flag为真则显示span&lt;/span&gt;}</code></li><li>三元表达式：<code>{loading ? &lt;span&gt;loading...&lt;/span&gt; : &lt;span&gt;show&lt;/span&gt;}</code></li></ol><p><strong>复杂条件下，可以使用自定义函数返回不同结果的 jsx 模板来实现需求。</strong></p><h2 id="react基础事件绑定"><a class="markdownIt-Anchor" href="#react基础事件绑定"></a> React 基础事件绑定</h2><h3 id="基础绑定"><a class="markdownIt-Anchor" href="#基础绑定"></a> 基础绑定</h3><p>语法：on + 事件名称 ={事件处理程序}，整体上遵循驼峰命名法（如：handleClick）</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091708950.png" alt="image-20241109170842883" style="zoom:50%;"><h3 id="获取事件"><a class="markdownIt-Anchor" href="#获取事件"></a> 获取事件</h3><p>语法：在事件回调函数中写上形参 e</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091711394.png" alt="image-20241109171126332" style="zoom:50%;"><h3 id="传递自定义参数"><a class="markdownIt-Anchor" href="#传递自定义参数"></a> 传递自定义参数</h3><p>语法：在绑定事件中改写为箭头函数写法，将实参传递</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091713205.png" alt="image-20241109171347125" style="zoom:50%;"><h3 id="传递自定义参数和事件"><a class="markdownIt-Anchor" href="#传递自定义参数和事件"></a> 传递自定义参数和事件</h3><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091715686.png" alt="image-20241109171510601" style="zoom:50%;"><div class="note note-warning">            <p>warning</p><p>请注意自定义参数和事件参数 e 的位置。传递和接收须一一对应。</p>          </div><h2 id="react组件"><a class="markdownIt-Anchor" href="#react组件"></a> React 组件</h2><p>在 React 中，一个组件就是<strong>首字母大写</strong>的函数，内部存放了组件的逻辑和视图 UI，渲染组件只需要把组件当成标签书写即可。</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091724366.png" alt="image-20241109172427287" style="zoom:50%;"><div class="note note-warning">            <p>warning</p><p>请注意声明和使用时，组件名首字母大写。</p>          </div><h2 id="usestate基础使用"><a class="markdownIt-Anchor" href="#usestate基础使用"></a> useState 基础使用</h2><p>usestate 是 - 一个 ReactHook（函数），它允许我们向组件添加一个<strong>状态变量</strong>，从而控制影响组件的渲染结果。</p><p>本质：和普通 JS 变量不同的是，状态变量一旦发生变化组件的视图 UI 也会跟着变化（<strong>数据驱动视图</strong>）。</p><p>例如：<code>const [count, setCount] = useState(0)</code></p><ol><li>useState 是一个函数，返回值是一个数组。</li><li>数组中的第一个参数是状态变量，第二个参数是 set 函数用来修改状态变量</li><li> useState 的参数将作为 count 的初始值</li></ol><p>简单案例：</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091735328.png" alt="image-20241109173503242" style="zoom:50%;"><div class="note note-warning">            <p>warning</p><ol><li>请先将 useState 进行导入</li><li>请注意使用 setCount 时，传递的值为新值，不能使用 <code>count++</code> 或者 <code>count += 1</code> 等类似写法。</li></ol>          </div><h2 id="修改状态的规则"><a class="markdownIt-Anchor" href="#修改状态的规则"></a> 修改状态的规则</h2><p>前文提到，使用 setCount 时，传递的值为新值，不能使用 <code>count++</code> 或者 <code>count += 1</code> 等类似写法。</p><div class="note note-info">            <p>info</p><p>在 React 中，状态被认为是只读的，我们应该始终替换它而不是修改它，直接修改状态不能引发视图更新。</p>          </div><p>即，你不能使用以下方式更改 count 的值：</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091743217.png" alt="image-20241109174316164" style="zoom:50%;"><p>于是，修改对象这种复杂类型的状态变量，也同样适用。</p><h3 id="复杂类型修改"><a class="markdownIt-Anchor" href="#复杂类型修改"></a> 复杂类型修改</h3><div class="note note-info">            <p>info</p><p>在 React 中，对于对象类型的状态变量，应该始终传给 set 方法一个<strong>全新的对象</strong>来进行修改。</p>          </div><p>例如：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411091753859.png" alt="image-20241109175314730"></p><p>其中的 setUser 方法将属性展开，再书写要覆盖的属性进行赋值，这样就完成了实际上的属性修改，如果不展开，那么属性将只剩下后书写的属性。</p><h2 id="react样式控制"><a class="markdownIt-Anchor" href="#react样式控制"></a> React 样式控制</h2><p>一般分为行内写法和分离写法。</p><p>行内写法例如：</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411092143167.png" alt="image-20241109214302038" style="zoom:50%;"><p>或者像前面的写法一样，写成：<code>&lt;span style = {{ color: red }}&gt;</code></p><p>分离写法的意思是，将样式抽离为一个 css 文件进行导入使用。具体是在标签上使用 <code>className</code>（此为固定名）进行导入使用。例如：</p><figure class="shiki css"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D7BA7D">.foo</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">red</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411092147084.png" alt="image-20241109214659938" style="zoom:50%;"><h2 id="classnames类名控制"><a class="markdownIt-Anchor" href="#classnames类名控制"></a> classnames 类名控制</h2><blockquote><p>github 地址：<a href="https://github.com/JedWatson/classnames">https://github.com/JedWatson/classnames</a></p></blockquote><p>可以使用 classnames 进行类名控制，解决类名控制时使用模板字符串拼接类名过多时的拼接易出错、不直观的问题。</p><p>例如这种类名写法：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">type</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'admin'</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 该值可以是接收到的后端数据，这里只是示例</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #CE9178">`spanTitle</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'admin'</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #CE9178">'active'</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        This is John wick.</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>如果使用 classnames 则为：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">type</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'admin'</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 该值可以是接收到的后端数据，这里只是示例</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #DCDCAA">classNames</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'spanTitle'</span><span style="color: #D4D4D4">, { </span><span style="color: #CE9178">'active'</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'admin'</span><span style="color: #D4D4D4"> })</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        This is John wick.</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><h2 id="react表单受控绑定"><a class="markdownIt-Anchor" href="#react表单受控绑定"></a> React 表单受控绑定</h2><p>概念：使用 React 组件的状态（useState）控制表单的状态。</p><p>就是使用 useState 的 value 绑定输入框的 value，再通过 onChange 事件将输入的值传给 set 方法，实现输入数据视图更新的操作。例如：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">name</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">setName</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useState</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onChange</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">input</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">style</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4"> ? { </span><span style="color: #9CDCFE">display:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"none"</span><span style="color: #D4D4D4"> } : {}</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Hello, The name is </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">name</span><span style="color: #569CD6">}</span><span style="color: #D4D4D4">!</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>一旦输入框输入值，span 标签将会显示值。</p><h2 id="react获取dom"><a class="markdownIt-Anchor" href="#react获取dom"></a> React 获取 Dom</h2><p>在 React 组件中获取 / 操作 DOM，需要使用 useRef 钩子函数：</p><ol><li>使用 useRef 创建 ref 对象，并与 JSX 绑定</li><li>在 DOM 可用时，通过 inputRef.current 拿到 DOM 对象 </li></ol><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useRef</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">domRef</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">useRef</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">);  </span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">showDom</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">domRef</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">current</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dir</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">domRef</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">current</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">ref</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">domRef</span><span style="color: #569CD6">}</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">showDom</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">获取dom</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><h2 id="react父子通信"><a class="markdownIt-Anchor" href="#react父子通信"></a> React 父子通信</h2><h3 id="父传子"><a class="markdownIt-Anchor" href="#父传子"></a> 父传子</h3><ol><li>子组件标签上通过属性绑定数据</li><li>子组件通过 props 形参接收数据对象 </li></ol><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Son</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"Son"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">appName</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">name</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">"John Wick"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">Son</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">appName</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">name</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">Son</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>请注意子组件中使用的是 appName 属性，而非具体传递的 name 变量。</p><div class="note note-warning">            <p>warning</p><p>props 可以传递任意合法的 JS 数据，但 props 是只读的，子组件不能直接修改该数据。</p>          </div><h3 id="特殊的props属性-children"><a class="markdownIt-Anchor" href="#特殊的props属性-children"></a> 特殊的 props 属性 - children</h3><p>如果不是在子组件的标签属性中传递数据，而是将内容嵌套在子组件标签中，则子组件将通过一个默认的 props 属性进行接收，该属性名为 children。</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Son</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"Son"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">children</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">name</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">"John Wick"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">Son</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">hello </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">name</span><span style="color: #569CD6">}</span><span style="color: #D4D4D4">!</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">a child of Son</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #4EC9B0">Son</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><h3 id="子传父"><a class="markdownIt-Anchor" href="#子传父"></a> 子传父</h3><p>核心思想：利用父组件传递的函数传递自己的参数 / 数据</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Son</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"Son"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">I am a Son</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h1</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">onChange</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">onSendMsg</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">onSendMsg</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"Hello from Son"</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        send message</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">msg</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">setMsg</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useState</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">sendMsg</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">msg</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setMsg</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">msg</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">I am a Parent, and I have a Son who can send me a message: </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">msg</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">hr</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">Son</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onSendMsg</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">sendMsg</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">Son</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>如果传递的函数数量较少，也可以直接解构处理它。</p><h2 id="react兄弟通信"><a class="markdownIt-Anchor" href="#react兄弟通信"></a> React 兄弟通信</h2><p>很容易想到一个办法是：借助父组件进行数据传递。</p><h3 id="朴素的办法-状态提升"><a class="markdownIt-Anchor" href="#朴素的办法-状态提升"></a> 朴素的办法 - 状态提升</h3><p>假设有 B、C 组件为兄弟关系，它们存在一个共同的父组件 App，构建如下：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">B</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">bMsg</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">"Hello from B"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"B"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h2</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is B component</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h2</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">bMsg: </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">bMsg</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">AppMsg</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">bMsg</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">sending bMsg to C</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">props</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">AppMsg</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">""</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">clearing AppMsg</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">msg</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">setMsg</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useState</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">appClick</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">msg</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setMsg</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">msg</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">B</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">AppMsg</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">appClick</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">B</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">hr</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">C</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">AppMsg</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">msg</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">C</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">C</span><span style="color: #D4D4D4">({</span><span style="color: #9CDCFE">AppMsg</span><span style="color: #D4D4D4">}) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"C"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h2</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is C component</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h2</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">AppMsg</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>注意区分给 B 组件和 C 组件传递的 AppMsg 分别是什么：B 为回调函数，C 为来自 B 组件的消息字符串。</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">B</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">AppMsg</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">appClick</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">B</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">hr</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">C</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">AppMsg</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">msg</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">C</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>运行结果如下：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411111634311.gif" alt="recording"></p><h3 id="其他方法-待补充"><a class="markdownIt-Anchor" href="#其他方法-待补充"></a> 其他方法 - 待补充</h3><p>TODO</p><h2 id="跨层级通信-context"><a class="markdownIt-Anchor" href="#跨层级通信-context"></a> 跨层级通信 - Context</h2><p>适用于形成顶层 - 底层层级关系的组件通信。</p><p>假设有 App、B、C 三个组件。B 组件是被 App 使用的子组件，且 B 组件中又使用 C 组件，则此时 C 组件为底层组件而 App 为顶层组件。</p><ol><li>使用 createContext 方法创建一个上下文对象 Ctx（名称可随意）</li><li>在顶层组件（App）中通过 <code>Ctx.Provider</code> 组件提供数据</li><li>在底层组件（C）中通过 <code>useContext</code> 钩子函数获取消费数据</li></ol><p>代码示例如下：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">createContext</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">useContext</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">MsgContext</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">createContext</span><span style="color: #D4D4D4">();</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">AppMsg</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">"Hello from App."</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">AppMsg2</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">"Hello from App2."</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">MsgContext.Provider</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">AppMsg</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">AppMsg2</span><span style="color: #D4D4D4">]</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        This is App component.</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">B</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">B</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #4EC9B0">MsgContext.Provider</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">hr</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">B</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"B"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is B component</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">C</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">C</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">C</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">bMsg</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">useContext</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">MsgContext</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"C"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is C component. </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">bMsg</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>传递多个数据 <code>&lt;MsgContext.Provider value={[AppMsg, AppMsg2]}&gt;</code>，需要用数组进行传递。</p><div class="note note-info">            <p>实际上，任何能够形成顶层 - 底层层级的组件关系都可以使用 Context 进行通信。</p><p>例如，父子关系也是一种顶层 - 底层关系。</p>          </div><h2 id="useeffect概念"><a class="markdownIt-Anchor" href="#useeffect概念"></a> useEffect 概念</h2><p>useEffect 是一个 <code>React Hook</code> 函数，用于在 React 组件中创建不是由事件引起而是<strong>由渲染本身引起的</strong>操作，比如发送 AJAX 请求，更改 DOM 等等。</p><p>一个简单的场景是：当组件加载完毕之后需要获取数据（发送请求），实现数据渲染。</p><p>语法：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">useEffect</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {}, [])</span></span></code></pre></div></div></figure><ul><li>参数 1 是一个函数，可以把它叫做副作用函数，在函数内部可以放置要执行的操作。</li><li>参数 2 是一个数组（可选），在数组里放置依赖项，不同依赖项会影响第一个参数函数的执行，<strong>当是一个空数组的时候，副作用函数只会在组件渲染完毕之后执行一次。</strong></li></ul><p>代码可以是：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useEffect</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">requestUrl</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'https://smart-shop.itheima.net/index.php?s=/api/goods/list&amp;categoryId=10036'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">resList</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">setResList</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useState</span><span style="color: #D4D4D4">([])</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">useEffect</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">fetchData</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">fetch</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">requestUrl</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> {</span><span style="color: #4FC1FF">data</span><span style="color: #D4D4D4">} = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">json</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">setResList</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">fetchData</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">  }, []);</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">ul</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">resList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">map</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">li</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_name</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">li</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">ul</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">hr</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );    </span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>依赖项的具体影响如下表：</p><table><thead><tr><th style="text-align:center">依赖项</th><th style="text-align:left">副作用函数执行时机</th></tr></thead><tbody><tr><td style="text-align:center">没有依赖项：不写</td><td style="text-align:left">组件初始渲染 + 组件更新时执行</td></tr><tr><td style="text-align:center">空数组依赖：[ ]</td><td style="text-align:left"> 只在初始渲染时执行一次</td></tr><tr><td style="text-align:center">特定依赖项：[example]</td><td style="text-align:left"> 组件初始渲染 + 特定依赖项变化时执行</td></tr></tbody></table><h2 id="useeffect-清除副作用"><a class="markdownIt-Anchor" href="#useeffect-清除副作用"></a> useEffect - 清除副作用</h2><p>在 useEffect 中编写的由渲染本身引起的对接组件外部的操作，社区也经常把它叫做副作用操作。比如在 useEffect 中开启了一个定时器，我们想在组件卸载时把这个定时器再清理掉，这个过程就是清理副作用。</p><p>语法：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">useEffect</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  ...</span><span style="color: #9CDCFE">副作用操作逻辑</span><span style="color: #D4D4D4">...</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #9CDCFE">清除副作用逻辑</span><span style="color: #D4D4D4">...</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">})</span></span></code></pre></div></div></figure><p>也就是在 return 中新写一个函数，该函数<strong>最常见</strong>的执行时机是在<strong>组件卸载时自动执行</strong>。</p><p>例如，在 Son 组件中开启一个定时器，卸载时清除这个定时器。代码可以是：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useEffect</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">B</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">useEffect</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">timer</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">setInterval</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'工作中...'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    }, </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">clearInterval</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">timer</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">timer</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }, [])</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"B"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  )</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">setIsShow</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useState</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">B</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setIsShow</span><span style="color: #D4D4D4">(!</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">卸载B</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );    </span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><h2 id="react自定义hook函数"><a class="markdownIt-Anchor" href="#react自定义hook函数"></a> React 自定义 hook 函数</h2><p>假设要实现一个将某元素结构隐藏 / 显示的按钮逻辑，代码可以是：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">setIsShow</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useState</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">handleClick</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setIsShow</span><span style="color: #D4D4D4">(!</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  };</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h2</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is John Wick.</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h2</span><span style="color: #808080">&gt;</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">setIsShow</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Toggle</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );    </span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>但很显然，这种切换元素结构隐藏或显示的代码是经常使用的，如果每一次都需要手动再写一次较为麻烦，于是这里引出封装自定义 hook 函数。</p><ol><li>声明一个以 use 打头的函数</li><li>在函数体内封装可复用的逻辑（只要是可复用的逻辑）</li><li>把组件中用到的状态或者回调 return 出去（以对象或者数组）</li><li>在哪个组件中要用到这个逻辑，就执行这个函数，解构出来状态和回调进行使用</li></ol><p>所以，代码也可以是下面这种：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">useToggle</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">setIsShow</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useState</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">toggle</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setIsShow</span><span style="color: #D4D4D4">(!</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  };</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> [</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">toggle</span><span style="color: #D4D4D4">];</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">toggle</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useToggle</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h2</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is John Wick.</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h2</span><span style="color: #808080">&gt;</span><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">toggle</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Toggle</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );    </span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><div class="note note-warning">            <p>warning</p><ol><li>hook 函数只能在组件中或者其他自定义 hook 函数中调用</li><li> hook 函数只能在组件的顶层调用，不能嵌套在 if、for 或者其他函数中</li></ol>          </div><p>下面两种调用方式都是错误的：</p><ol><li><p>组件外调用</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">useToggle</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">setIsShow</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useState</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">toggle</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setIsShow</span><span style="color: #D4D4D4">(!</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  };</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> [</span><span style="color: #9CDCFE">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">toggle</span><span style="color: #D4D4D4">];</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #6A9955">// 这将报错：React Hook “useToggle” 不能在顶层调用。React Hook 必须在 React 函数组件或自定义 React Hook 函数中调用。</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">toggle</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">sendMsg</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useToggle</span><span style="color: #D4D4D4">();</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is a React App.</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );    </span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure></li><li><p>嵌套在 if 语句中</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"react"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">useToggle</span><span style="color: #D4D4D4">() {...</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">Math</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">random</span><span style="color: #D4D4D4">() &gt; </span><span style="color: #B5CEA8">0.5</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 这将报错</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">isShow</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">toggle</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">sendMsg</span><span style="color: #D4D4D4">] = </span><span style="color: #DCDCAA">useToggle</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">This is a React App.</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  );    </span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure></li></ol><h2 id="redux-html小试牛刀"><a class="markdownIt-Anchor" href="#redux-html小试牛刀"></a> Redux-html 小试牛刀</h2><p>Redux 是 React 最常用的集中状态管理工具，类似于 Vue 中的 Pinia（或者 Vuex），可以独立于框架运行<br>作用：通过集中管理的方式管理应用的状态</p><p>使用步骤：</p><ol><li>定义一个 reducer 函数（根据当前想要做的修改返回一个新的状态）</li><li>使用 createStore 方法传入 reducer 函数生成一个 store 实例对象</li><li>使用 store 实例的 subscribe 方法订阅数据的变化（数据一旦变化，可以得到通知）</li><li>使用 store 实例的 dispatch 方法提交 action 对象触发数据变化（告诉 reducer 你想怎么改数据）</li><li>使用 store 实例的 getState 方法获取最新的状态数据更新到视图中</li></ol><p>例如在 Html 中使用 redux，代码如下：</p><figure class="shiki html"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;!</span><span style="color: #569CD6">DOCTYPE</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">html</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">html</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"en"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">head</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">meta</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">charset</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"UTF-8"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">meta</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"viewport"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"width=device-width, initial-scale=1.0"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">title</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Html Redux Example</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">title</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">head</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">body</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"increment"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Increment</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"counter"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">99</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"decrement"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">Decrement</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.5/redux.min.js"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">counter</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getElementById</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'counter'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// state管理数据的初始状态，action存放的是触发的动作</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">reducer</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4"> = { </span><span style="color: #9CDCFE">counter:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">counter</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">textContent</span><span style="color: #D4D4D4">) }, </span><span style="color: #9CDCFE">action</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">action</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'INCREMENT'</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">counter:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">counter</span><span style="color: #D4D4D4"> + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> } </span><span style="color: #6A9955">// 不能直接修改state，需要基于原始的state创建一个新的对象</span></span><span class="line"><span style="color: #D4D4D4">      } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">action</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'DECREMENT'</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">counter:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">counter</span><span style="color: #D4D4D4"> - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> }</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 其他情况返回原来的state</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">store</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">Redux</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">createStore</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">reducer</span><span style="color: #D4D4D4">) </span><span style="color: #6A9955">// 创建一个Redux的store</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">subscribe</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> { </span><span style="color: #6A9955">// 每次state发生变化时，都调用这个函数</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">counter</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">textContent</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getState</span><span style="color: #D4D4D4">().</span><span style="color: #9CDCFE">counter</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 更新页面上的counter</span></span><span class="line"><span style="color: #D4D4D4">    })</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">inBtn</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getElementById</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'increment'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">inBtn</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'click'</span><span style="color: #D4D4D4">, () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">({ </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'INCREMENT'</span><span style="color: #D4D4D4"> }) </span><span style="color: #6A9955">// 触发action</span></span><span class="line"><span style="color: #D4D4D4">    })</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">deBtn</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getElementById</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'decrement'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">deBtn</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'click'</span><span style="color: #D4D4D4">, () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">({ </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'DECREMENT'</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">    })</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">body</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">html</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h2 id="redux与react"><a class="markdownIt-Anchor" href="#redux与react"></a> Redux 与 React</h2><p>在 React 中使用 redux，官方要求安装俩个其他插件：Redux Toolkit 和 react-redux</p><ul><li>Redux Toolkit（RTK）是官方推荐编写 Redux 逻辑的方式，是一套工具的集合集，<strong>简化书写方式</strong></li><li> react-redux 是用来链接 Redux 和 React 组件的中间件</li></ul><p>安装命令可以是：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955"># 创建项目</span></span><span class="line"><span style="color: #DCDCAA">npx</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">create-react-app</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">yourProjectName</span></span><span class="line"><span style="color: #6A9955"># 安装插件</span></span><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">i</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">@reduxjs/toolkit</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">react-redux</span></span></code></pre></div></div></figure><p>或者使用 vite 构建项目，命令可以是：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">create</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">vite@latest</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">my-vite-app</span></span></code></pre></div></div></figure><p>运行上述命令之后，按照提示选择 create-react-app 模板即可（SWC 是 JavaScript <a href="https://so.csdn.net/so/search?q=%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7&amp;spm=1001.2101.3001.7020">编译工具</a>比 Babel 要快，但是在功能和插件生态系统方面 Babel 更完善）。</p><h3 id="redux目录结构安排"><a class="markdownIt-Anchor" href="#redux目录结构安排"></a> Redux 目录结构安排</h3><p>安装好 Redux 后，应该对 sotre 目录结构有一定的安排，可以是：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411141957404.png" alt="image-20241114195752266"></p><p>index.js 将 modules 中的 store 导出即可，比较类似 Pinia 的目录安排。</p><h3 id="创建一个countersotre"><a class="markdownIt-Anchor" href="#创建一个countersotre"></a> 创建一个 counterSotre</h3><p>编写代码如下：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">createSlice</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"@reduxjs/toolkit"</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">counterStore</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">createSlice</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"counter"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">initialState:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">count:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">99</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 创建reducer的同时也会自动生成action creators</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">reducers:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 均是同步的，直接修改state</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">increment</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">count</span><span style="color: #D4D4D4">++;</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">decrement</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">count</span><span style="color: #D4D4D4">--;</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// action参数接受额外的参数</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">incrementByAmount</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">action</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">count</span><span style="color: #D4D4D4"> += </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">action</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">payload</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">decrementByAmount</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">action</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">count</span><span style="color: #D4D4D4"> -= </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">action</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">payload</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}) </span></span><span class="line"><span style="color: #6A9955">// 解构方便导出使用</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">increment</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">decrement</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">incrementByAmount</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">decrementByAmount</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">counterStore</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">actions</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">reducer</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">counterStore</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">reducer</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">increment</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">decrement</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">incrementByAmount</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">decrementByAmount</span><span style="color: #D4D4D4"> };</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">reducer</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><div class="note note-info">            <p><em>info</em></p><ul><li>为什么创建 Store 的方法为 createSlice？</li></ul><p>​因为在 Redux 中，"切片"（slice）是指将 Redux 状态的逻辑按照功能进行分割和组织的方式。每个切片通常包含以下几个部分：</p><ol><li><strong>初始状态</strong>：定义该切片的初始状态，通常是一个对象。</li><li><strong>reducers</strong>：一组用于更新该切片状态的函数。每个 reducer 函数定义了如何根据不同的 action 修改状态。</li><li><strong>actions</strong>：由 reducers 生成的操作，这些操作可以在组件中被触发，以更新状态。</li></ol><p>切片的主要目的是提高代码的可维护性和可读性，将不同功能的状态和行为组织到一个地方，避免将所有的状态和逻辑集中在一个大型文件中。这样可以使状态管理更加清晰和模块化。</p>          </div><h3 id="导出store"><a class="markdownIt-Anchor" href="#导出store"></a> 导出 store</h3><p>在 store 目录下的 index.js 文件中编写代码如下：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">configureStore</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"@reduxjs/toolkit"</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">counterReducer</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"./modules/counterStore"</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">store</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">configureStore</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">reducer:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">counter:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">counterReducer</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 该名称实际上是可以随意的</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">});</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>由于子模块导出时，使用的是 <code>export default</code> 方式，所以可以重新命名为 counterReducer 以供 reducer 管理。此处的 reducer 和子模块的 reducer 类似一群孩子和监护人的关系，各个子模块的 reducer 由此处 index.js 的 reducer 管理。</p><h3 id="store注入react"><a class="markdownIt-Anchor" href="#store注入react"></a> Store 注入 React</h3><p>react-redux 负责把 Redux 和 React 链接起来，内置 Provider 组件通过 store 参数把创建好的 store 实例注入到应用，<br>链接正式建立。</p><p>在由 Vite 创建的项目中，找到 <code>src\main.jsx</code> 文件（如果是 npm 创建则是 index.js）：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">StrictMode</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">createRoot</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react-dom/client'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'./index.css'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'./App.jsx'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'./store'</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 导入store</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">Provider</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react-redux'</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 导入Provider</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">createRoot</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getElementById</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'root'</span><span style="color: #D4D4D4">)).</span><span style="color: #DCDCAA">render</span><span style="color: #D4D4D4">(</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">StrictMode</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">Provider</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">store</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">App</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #4EC9B0">Provider</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #4EC9B0">StrictMode</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">)</span></span></code></pre></div></div></figure><p>使用 Provide 将 App 包裹，并指定好 store 属性，就可以在 React 中使用 redux 了。</p><h3 id="在组件中使用store"><a class="markdownIt-Anchor" href="#在组件中使用store"></a> 在组件中使用 store</h3><p>找到 App.jsx 修改为如下代码：</p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useSelector</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react-redux'</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">count</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">useSelector</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">counter</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'-clicked'</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">-</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">count</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'+clicked'</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">+</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  )</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span></span></code></pre></div></div></figure><p>这个地方的 state 参数 <code>state =&gt; state.counter</code> 指的其实是 sotre 的 index.js 文件中的 reducer 中的 counter：</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202411142117502.png" alt="image-20241114211731362" style="zoom:50%;"><p>不过现在只能显示数据，而不能修改。</p><h3 id="修改数据"><a class="markdownIt-Anchor" href="#修改数据"></a> 修改数据</h3><div class="note note-info">            <p>React 组件中修改 store 中的数据需要借助另外一个 hook 函数：<code>useDispatch</code></p><p>它的作用是生成提交 action 对象的 dispatch 函数。</p>          </div><p><code>App.jsx</code></p><figure class="shiki jsx"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">useSelector</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">useDispatch</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'react-redux'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">decrement</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">increment</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">incrementByAmount</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'./store/modules/counterStore'</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">App</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">count</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">useSelector</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">counter</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">dispatch</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">useDispatch</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">amount</span><span style="color: #D4D4D4"> = </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">handleAmountChange</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">amount</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">className</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"App"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">'Enter amount'</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onChange</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">handleAmountChange</span><span style="color: #569CD6">}</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">incrementByAmount</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">amount</span><span style="color: #D4D4D4">))</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">confirm</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">br</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">decrement</span><span style="color: #D4D4D4">())</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">-</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #569CD6">{</span><span style="color: #9CDCFE">count</span><span style="color: #569CD6">}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">onClick</span><span style="color: #D4D4D4">=</span><span style="color: #569CD6">{</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">increment</span><span style="color: #D4D4D4">())</span><span style="color: #569CD6">}</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">+</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  )</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">App</span></span></code></pre></div></div></figure><p>在这段代码中，使用 <code>dispatch</code> 方法并传入 <code>increment()</code> 时，它实际上是调用导入了的 <code>increment</code> 这个 action creator 函数，这个函数会返回一个 action 对象。例如：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C8C8C8">type</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'counter/increment'</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 这是类型自动生成的字符串</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="异步状态操作"><a class="markdownIt-Anchor" href="#异步状态操作"></a> 异步状态操作</h3><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GO-SHOPPING 商城项目笔记</title>
    <link href="/archives/Vue/47412.html"/>
    <url>/archives/Vue/47412.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><blockquote><p>本项目是基于 uni-app 技术栈开发的，能够运行在多端 (微信小程序、h5、ios/Android) 的移动端商城项目。</p></blockquote><ul><li>重点：接口需要 token 的地方，header 中， Access-Token:${token}</li><li> 重点：接口需要 platform 的地方，header 中，platform: h5 或 mp-weixin</li><li> 接口调用基础地址：<a href="http://smart-shop.itheima.net/index.php?s=/api">http://smart-shop.itheima.net/index.php?s=/api</a></li><li> 关于接口的说明：分为了 http 状态码和接口中 code 对应码</li></ul><table><thead><tr><th style="text-align:left">码值</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"> http 状态码 500</td><td style="text-align:left"> 服务器端异常</td></tr><tr><td style="text-align:left"> http 状态码 404</td><td style="text-align:left"> 服务器端异常</td></tr><tr><td style="text-align:left"> http 状态码 401</td><td style="text-align:left"> 授权信息不正确</td></tr></tbody></table><blockquote><p>测试环境，登录短信验证码统一为：246810 （不再提供真实的短信验证服务）</p><p><a href="https://apifox.com/apidoc/shared-12ab6b18-adc2-444c-ad11-0e60f5693f66/doc-2221080">接口文档地址</a></p><p><a href="https://youzan.github.io/vant/v2/#/zh-CN/">Vant2 官网地址</a></p><p>本项目使用 <code>ESLint+Standard config</code> 的代码规范标准</p></blockquote><h1 id="go-shopping商城项目笔记"><a class="markdownIt-Anchor" href="#go-shopping商城项目笔记"></a> GO-SHOPPING 商城项目笔记</h1><meta name="description" content="记录学习过的Vue2商城项目，写法接近uniapp，稍加改造可以成为uniapp项目">## 一级路由配置<p>将每个基础的一级页面以文件夹形式存放于 views 包中。包括：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281710771.png" alt="image-20240828171025686">具体项目结构如下：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281709022.png" alt="image-20240828170920935" style="zoom:80%;"></p><p>路由页如下：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281711591.png" alt="image-20240828171139419" style="zoom: 50%;"></p><h2 id="二级路由配置"><a class="markdownIt-Anchor" href="#二级路由配置"></a> 二级路由配置</h2><h3 id="实现底部导航栏tabbar"><a class="markdownIt-Anchor" href="#实现底部导航栏tabbar"></a> 实现底部导航栏 Tabbar</h3><p>配置二级路由之前需要完成底部 Tabbar 栏的设计，可以结合 vant 官网文档进行设计。<a href="https://youzan.github.io/vant/v2/">vant2 官网</a><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281712602.png" alt="image-20240828171252550"></p><h3 id="实现二级路由配置"><a class="markdownIt-Anchor" href="#实现二级路由配置"></a> 实现二级路由配置</h3><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281741912.png" alt="image-20240828174123840"></p><p>在组件中的 vant2 的 Tabbar 要实现路由模式如下：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281744188.png" alt="image-20240828174450143"></p><p>于是有：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  &lt;router-view&gt;&lt;/router-view&gt;</span></span><span class="line"><span style="color: #D4D4D4">  &lt;van-tabbar route v-model="active" active-color="#ee0a24" inactive-color="#000"&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;van-tabbar-item to= "/home" icon="gem-o"&gt;首页&lt;/van-tabbar-item&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;van-tabbar-item to= "/category" icon="apps-o"&gt;分类页&lt;/van-tabbar-item&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;van-tabbar-item to= "/cart" icon="shopping-cart-o"&gt;购物车&lt;/van-tabbar-item&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;van-tabbar-item to= "/user" icon="user-o"&gt;我的&lt;/van-tabbar-item&gt;</span></span><span class="line"><span style="color: #D4D4D4">  &lt;/van-tabbar&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>最后优化路由逻辑，将默认匹配的页面重定向到 home</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281748077.png" alt="image-20240828174814027"></p><h2 id="登录静态页"><a class="markdownIt-Anchor" href="#登录静态页"></a> 登录静态页</h2><p>新建 <code>styles/common.less</code> 重置默认样式（可以对一些想要多组件生效的样式进行重新调整）</p><figure class="shiki less"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 重置默认样式</span></span><span class="line"><span style="color: #D4D4D4">* {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">box-sizing</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">borde-box</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 文字溢出省略号</span></span><span class="line"><span style="color: #D7BA7D">.text-ellipsis-2</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">hidden</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">-webkit-line-clamp</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">text-overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">ellipsis</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: -webkit-box;</span></span><span class="line"><span style="color: #D4D4D4">   </span><span style="color: #9CDCFE">-webkit-box-orient</span><span style="color: #D4D4D4">:</span><span style="color: #CE9178">vertical</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>导入于 main.js 中：<code>import '@/styles/common.less'</code></p><p>接着准备一些素材图片于 assets<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281759229.png" alt="image-20240828175944181"></p><h3 id="配置头部navbar"><a class="markdownIt-Anchor" href="#配置头部navbar"></a> 配置头部 NavBar</h3><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">&lt;!-- 头部 NavBar --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"尊敬的用户，请登录"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">left-arrow</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">    /&gt;</span></span></code></pre></div></div></figure><p><code>$router.go(-1)</code> 的作用是返回上一页。</p><p>接着将左边的返回符号 left-arrow 颜色样式改为灰色 #333，于是找到 common.less 进行编写（两个类名增加权重）</p><figure class="shiki less"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 添加导航的通用样式</span></span><span class="line"><span style="color: #D7BA7D">.van-nav-bar</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.van-nav-bar__arrow</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>这样的好处是，一旦配置好了将来其他页面使用到导航栏此处的返回颜色都是我们此时配好的颜色。这就是通用样式的覆盖。</p><h3 id="完善主体"><a class="markdownIt-Anchor" href="#完善主体"></a> 完善主体</h3><p>接着编写主体的静态结构：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"login"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 头部 NavBar --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"尊敬的用户，请登录"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">left-arrow</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">    /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 主体部分 自定义 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"container"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"title"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">h3</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">手机号登录</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">h3</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">未注册的手机号登录后将自动注册</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"form"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"form-item"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"inp"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">maxlength</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"11"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"请输入手机号码"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"form-item"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"inp"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">maxlength</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"5"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"请输入图形验证码"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"@/assets/code.png"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"form-item"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"inp"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"请输入短信验证码"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">获取验证码</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"login-btn"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">登录</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'LoginIndex'</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.container</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">49px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">29px</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">h3</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">26px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-weight</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">normal</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">p</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#b8b8b8</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.form-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#f3f1f2</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">8px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.inp</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">outline</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">32px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">94px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">31px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">button</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">31px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">13px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#cea26a</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">transparent</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">padding-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">9px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.login-btn</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">42px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">39px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">linear-gradient</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">90deg</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">#ecb53c</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">#ff9211</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">39px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">box-shadow</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">rgba</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">,</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">,</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">,</span><span style="color: #B5CEA8">.1</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">letter-spacing</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">2px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>页面效果如下：</p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281818338.png" alt="image-20240828181803280" style="zoom: 80%;"><p>图形验证码暂时写死，短信验证码暂时不作处理</p><h3 id="完善登录逻辑"><a class="markdownIt-Anchor" href="#完善登录逻辑"></a> 完善登录逻辑</h3><p>登录页面一共有三个请求需要发送，图形验证码、短信验证码和登录请求。我们使用 axios 来请求后端接口，一般都会对 axios 进行一些配置（配置基础地址，请求响应拦截器等），于是封装 axios 为一个 request 模块，便于维护。以后使用 axios 都是创建实例去请求，这样多个实例相互独立，互不干扰。</p><ul><li><a href="https://www.axios-http.cn/docs/instance">axios 中文文档</a></li></ul><p>新建 request.js 于 utils 包下，创建一个 axios 实例（cv 中文文档中的实例和拦截器进行改造）：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">axios</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'axios'</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 创建axios实例</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">instance</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">axios</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">create</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 查看接口文档改造</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">baseURL:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'http://smart-shop.itheima.net/index.php?s=/api'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">timeout:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5000</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">headers:</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">platform:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'h5'</span><span style="color: #D4D4D4"> }</span></span><span class="line"><span style="color: #D4D4D4">})</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 自定义配置 - 请求/响应 拦截器 （如果希望不污染原本的axios需要将axios改为instance实例）</span></span><span class="line"><span style="color: #6A9955">// 添加请求拦截器</span></span><span class="line"><span style="color: #9CDCFE">instance</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">interceptors</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 在发送请求之前做些什么</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">config</span></span><span class="line"><span style="color: #D4D4D4">}, </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 对请求错误做些什么</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Promise</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reject</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">})</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 添加响应拦截器</span></span><span class="line"><span style="color: #9CDCFE">instance</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">interceptors</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 2xx 范围内的状态码都会触发该函数。</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 对响应数据做点什么 (默认axios会对响应多包装一层data，所以这里需要取出data)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">}, </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 超出 2xx 范围的状态码都会触发该函数。</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 对响应错误做点什么</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Promise</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reject</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">})</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 导出配置好的示例</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">instance</span></span></code></pre></div></div></figure><p>响应器中，response.data 原本为 response，这里改为上文是因为 axios 默认会对响应多包装一层 data，所以这里需要取出 data</p><p>接着回到登录页面 index.vue 上，导入 request 模块，异步检查一下：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/request'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'LoginIndex'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/captcha/image'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>调试返回如下</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408281850640.png" alt="image-20240828185016590"></p><h4 id="解析base64并完善点击刷新图片验证码"><a class="markdownIt-Anchor" href="#解析base64并完善点击刷新图片验证码"></a> 解析 base64 并完善点击刷新图片验证码</h4><p>由于提交的图形验证码必须带 key 才能让后端进行唯一校验，所以在 data 中提供：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">picCode:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 用户输入的图形验证码</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">picKey:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 图形验证码的key</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">picUrl:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 存放要渲染的图形验证码的url</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">},</span></span></code></pre></div></div></figure><p>接着进行响应结果的解构，存储好数据以便后续提交后端进行校验</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">   </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getPicCode</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4"> },  </span></span><span class="line"><span style="color: #C8C8C8">methods</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">   </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getPicCode</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">     </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">: { </span><span style="color: #4FC1FF">base64</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">Key</span><span style="color: #D4D4D4"> } } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/captcha/image'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">     </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">picUrl</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">base64</span></span><span class="line"><span style="color: #D4D4D4">     </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">picKey</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">Key</span></span><span class="line"><span style="color: #D4D4D4">   }</span></span><span class="line"><span style="color: #D4D4D4"> }</span></span></code></pre></div></div></figure><p>完善 template 相关代码：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"form-item"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">   &lt;input v-model="picCode" class="inp" maxlength="5" placeholder="请输入图形验证码" type="text"&gt;</span></span><span class="line"><span style="color: #D4D4D4">   &lt;img v-if="picUrl" :src="picUrl" @click="getPicCode" alt=""&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>封装登录请求到 api 包下，新建 login.js</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 登录相关接口请求</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/request'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getPicCode</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/captcha/image'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>使用时按需导入。于是到登录页 index.js 中改 <code>import request from '@/utils/request'</code> 为 <code>import { getPicCode } from '@/api/login'</code> 并修改调用语句：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">methods</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getPicCode</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">: { </span><span style="color: #4FC1FF">base64</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">Key</span><span style="color: #D4D4D4"> } } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getPicCode</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">picUrl</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">base64</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">picKey</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">Key</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>上述语句不会因为重名冲突，我们需要知道的是，如果是引入的 getPicCode 前面是不带 this 的，而自身的 getPicCode 是需要在前面加上 this. 的</p><h3 id="toast轻提示"><a class="markdownIt-Anchor" href="#toast轻提示"></a> Toast 轻提示</h3><p>校验手机号是否输入、是否输入格式正确等并给予提示。</p><p>使用 vant 库中的 Toast 轻提示，完成提示显示。需要注意的是他的两种调用方式：</p><ol><li>Toast (' 提示内容 ');</li><li>this.<span class="katex-error" title="ParseError: KaTeX parse error: LaTeX-incompatible input and strict mode is set to 'error': Unicode text character &quot;提&quot; used in math mode [unicodeTextInMathMode] at position 8: toast('提̲示文案');  引入 Toas…">toast (' 提示文案 ');  引入 Toast 组件后，会自动在 Vue 的 prototype 上挂载 `</span>toast` 方法，便于在组件内调用。</li></ol><p>这两种调用，第一种是任意地方都可以调用显示出提示内容，第二种是只有组件内才可以显示提示内容。Toast 默认采用单例模式，即同一时间只会存在一个 Toast，如果需要在同一时间弹出多个 Toast，可以参考下面的示例：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">allowMultiple</span><span style="color: #D4D4D4">();</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">toast1</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'第一个 Toast'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">toast2</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">success</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'第二个 Toast'</span><span style="color: #D4D4D4">);</span></span><span class="line"></span><span class="line"><span style="color: #9CDCFE">toast1</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">clear</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #9CDCFE">toast2</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">clear</span><span style="color: #D4D4D4">();</span></span></code></pre></div></div></figure><h3 id="短信验证倒计时"><a class="markdownIt-Anchor" href="#短信验证倒计时"></a> 短信验证倒计时</h3><p>点击获取验证码之后要开始倒计时，一分钟只能发送一次。给获取短信验证码的按钮注册点击事件并改写显示文字</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"form-item"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">   &lt;input class="inp" placeholder="请输入短信验证码" type="text"&gt;</span></span><span class="line"><span style="color: #D4D4D4">   &lt;button @click="getCode"&gt;{{ totalTime === timeNow ? '获取验证码' : `${timeNow}秒后重试` }}&lt;/button&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>提供短信验证码获取函数 getCode</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 短信验证码获取</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCode</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 只有当计时器处于未开启状态并且当前时间和总时间一致时说明可以开启倒计时</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timerId</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timeNow</span><span style="color: #D4D4D4"> === </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">totalTime</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 开启计时器</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timerId</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">setInterval</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timeNow</span><span style="color: #D4D4D4">--</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timeNow</span><span style="color: #D4D4D4"> &lt;= </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// 停止计时器</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #DCDCAA">clearInterval</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timerId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timerId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">null</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timeNow</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">totalTime</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      }, </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 获取成功给予提示</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'获取短信验证码成功'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><p>并考虑到性能问题，于是增加在用户离开登录页面之后清除定时器的功能，实现在 destroy 生命函数</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">destroyed</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 当用户退出登录页面清除定时器</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">clearInterval</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">timerId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><h3 id="手机号和图形验证码类型校验"><a class="markdownIt-Anchor" href="#手机号和图形验证码类型校验"></a> 手机号和图形验证码类型校验</h3><p>由于前端无法校验具体，只能校验数据类型和长度。所以新增两个正则数据和绑定用户输入的手机号：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 手机号正则 1开头 3-9为第二位 接着9位数字</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">reg_phone</span><span style="color: #D4D4D4">:</span><span style="color: #D16969"> /</span><span style="color: #DCDCAA">^</span><span style="color: #D16969">1</span><span style="color: #CE9178">[</span><span style="color: #D16969">3-9</span><span style="color: #CE9178">]</span><span style="color: #D16969">\d</span><span style="color: #D7BA7D">{9}</span><span style="color: #DCDCAA">$</span><span style="color: #D16969">/</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">reg_picCode</span><span style="color: #D4D4D4">:</span><span style="color: #D16969"> /</span><span style="color: #DCDCAA">^</span><span style="color: #D16969">\w</span><span style="color: #D7BA7D">{4}</span><span style="color: #DCDCAA">$</span><span style="color: #D16969">/</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 图形正则</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">phoneNum</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 用户输入的手机号码</span></span></code></pre></div></div></figure><p>增加校验的函数 validFn</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 校验手机号和图形验证码</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">validFn</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">reg_phone</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">test</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">phoneNum</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'请输入正确的手机号！'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">reg_picCode</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">test</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">picCode</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'图形验证码错误！'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span></code></pre></div></div></figure><p>并在短信验证码获取函数 getCode 中加入一行判断</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 短信验证码获取</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">getCode</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 校验手机号和图形验证码格式</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">validFn</span><span style="color: #D4D4D4">()) { </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> }</span></span><span class="line"><span style="color: #D4D4D4">      ...</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><h3 id="封装发送短信验证码请求"><a class="markdownIt-Anchor" href="#封装发送短信验证码请求"></a> 封装发送短信验证码请求</h3><p>转到 login.js 中进行封装（结合接口文档）</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getMsgCode</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">captchaCode</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">captchaKey</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mobile</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/captcha/sendSmsCaptcha'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">form:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">captchaCode</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">captchaKey</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">mobile</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>然后在短信验证码获取函数 getCode 中加入调用代码</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 短信验证码获取</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCode</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 发送获取短信验证码的请求</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getMsgCode</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">picCode</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">picKey</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">phoneNum</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(res)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'短信发送成功，请注意查收'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      ...</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><h3 id="实现登录功能-封装登录接口"><a class="markdownIt-Anchor" href="#实现登录功能-封装登录接口"></a> 实现登录功能 - 封装登录接口</h3><p>封装登录请求</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">codeLogin</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">mobile</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">smsCode</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/passport/login'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">form:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">isParty:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">mobile</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">partyData:</span><span style="color: #D4D4D4"> {},</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">smsCode</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>绑定登录按钮事件为 login，绑定用户输入的短信验证码为 smsCode（默认短信为 246810）</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 登录功能</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">login</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 校验手机号和图形验证码格式</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">validFn</span><span style="color: #D4D4D4">()) { </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 校验输入的短信验证码格式</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #D16969">/</span><span style="color: #DCDCAA">^</span><span style="color: #D16969">\d</span><span style="color: #D7BA7D">{6}</span><span style="color: #DCDCAA">$</span><span style="color: #D16969">/</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">test</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">smsCode</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'请输入正确的短信验证码！'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">codeLogin</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">phoneNum</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">smsCode</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">status</span><span style="color: #D4D4D4"> === </span><span style="color: #B5CEA8">200</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'登录成功'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/home'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'登录失败，请检查手机号和验证码是否正确'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><p>后面失败的多种情况可以通过响应拦截器进行处理，在这里暂时只考虑成功的情况</p><h2 id="响应处理器统一处理错误提示"><a class="markdownIt-Anchor" href="#响应处理器统一处理错误提示"></a> 响应处理器统一处理错误提示</h2><p>对 utils 包下的 request 拦截器进行修改</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 响应拦截器</span></span><span class="line"><span style="color: #9CDCFE">instance</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">interceptors</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 2xx 范围内的状态码都会触发该函数。</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 对响应数据做点什么 (默认axios会对响应多包装一层data，所以这里需要取出data)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">status</span><span style="color: #D4D4D4"> !== </span><span style="color: #B5CEA8">200</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">message</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Promise</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reject</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">message</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">res</span></span><span class="line"><span style="color: #D4D4D4">}, </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 超出 2xx 范围的状态码都会触发该函数。</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 对响应错误做点什么</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 服务器返回了错误响应</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">`服务器错误: </span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">status</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 请求已发出，但没有收到响应</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'请求超时或网络错误'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 其他错误</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'请求配置错误'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Promise</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reject</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">})</span></span></code></pre></div></div></figure><h2 id="登录权证信息存储"><a class="markdownIt-Anchor" href="#登录权证信息存储"></a> 登录权证信息存储</h2><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408291344002.png" alt="image-20240829134402875"></p><p>使用 vuex 构建 user 模块存储登录权证（token 和 userID）。好处是易获取、响应式，分模块便于管理维护。</p><p>在 store 包下新建 modules 包，然后在 modules 包下新建 user.js</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">namespaced:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">state</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 个人权证</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">userInfo:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">token:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">userId:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">mutations:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setUserInfo</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">userInfo</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">obj</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">actions:</span><span style="color: #D4D4D4"> {},</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">getters:</span><span style="color: #D4D4D4"> {}</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>然后在 vuex 中进行挂载</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">User</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/store/modules/user'</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C8C8C8">modules</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">User</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><p>并在登录页面将要实现跳转到首页的前一刻完成用户权证信息的存储</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'User/setUserInfo'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">)</span></span></code></pre></div></div></figure><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408291411700.png" alt="image-20240829141130620"></p><h2 id="vuex持久化处理"><a class="markdownIt-Anchor" href="#vuex持久化处理"></a> vuex 持久化处理</h2><p>vuex 刷新就会丢失信息，于是引入持久化存储。我们将获取、设置和移除信息的操作封装为 storage 模块。</p><p>在 utils 包下新建一个 storage.js</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 约定一个通用键名</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">INFO_KEY</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'go_shopping_info'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getInfo</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">defaultInfo</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">token:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">userId:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">info</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">localStorage</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getItem</span><span style="color: #D4D4D4">(</span><span style="color: #4FC1FF">INFO_KEY</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 判断info是否有值</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">info</span><span style="color: #D4D4D4"> ? </span><span style="color: #4FC1FF">JSON</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">parse</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">info</span><span style="color: #D4D4D4">) : </span><span style="color: #9CDCFE">defaultInfo</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setInfo</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">localStorage</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setItem</span><span style="color: #D4D4D4">(</span><span style="color: #4FC1FF">INFO_KEY</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">JSON</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">stringify</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">))</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">removeInfo</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">localStorage</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">removeItem</span><span style="color: #D4D4D4">(</span><span style="color: #4FC1FF">INFO_KEY</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>然后到 vuex 的 user 子模块中进行导入使用即可</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getInfo</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">setInfo</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/storage'</span></span></code></pre></div></div></figure><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408291432317.png" alt="image-20240829143212223"></p><h2 id="添加请求loading效果"><a class="markdownIt-Anchor" href="#添加请求loading效果"></a> 添加请求 Loading 效果</h2><p>需求分析：有时候因为网络原因，一次请求的结果可能需要一段时间后才能回来。此时，需要给用户添加 loading 提示。</p><p>添加 loading 提示的好处：</p><ol><li><strong>节流处理</strong>：防止用户在一次请求还没回来之前，多次进行点击，发送无效请求</li><li><strong>友好提示</strong>：告知用户，目前是在加载中，请耐心等待，用户体验会更好</li></ol><p>加在哪呢？可以统一加在拦截器中，这样一来后面也可以复用：</p><ol><li><strong>请求拦截器</strong>中，每次请求，打开 loading</li><li><strong> 响应拦截器</strong>中，每次响应，关闭 loading</li></ol><p>转到 utils 包下的 request 拦截器，在请求的时候显示 Toast 提示，并设置背景不可点击且使其不会定时消失，只能由我们清除。</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #9CDCFE">instance</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">interceptors</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 在发送请求之前做些什么</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 发送请求时显示Toast提示，背景不可点击</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">loading</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">message:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'加载中...'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">forbidClick:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 禁止背景点击</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">duration:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 值为0时，toast不会自动关闭</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">config</span></span><span class="line"><span style="color: #D4D4D4">}, </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">) {...})</span></span></code></pre></div></div></figure><p>在响应拦截器添加清除提示的代码</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 对响应数据做点什么 (默认axios会对响应多包装一层data，所以这里需要取出data)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">status</span><span style="color: #D4D4D4"> !== </span><span style="color: #B5CEA8">200</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">message</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Promise</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reject</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">message</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 关闭Toast提示</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">clear</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">res</span></span></code></pre></div></div></figure><h2 id="全局路由前置守卫"><a class="markdownIt-Anchor" href="#全局路由前置守卫"></a> 全局路由前置守卫</h2><p><a href="https://router.vuejs.org/zh/guide/">Vue-router 官网地址</a></p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408291814256.png" alt="image-20240829181413117"><br>在 router 中编写：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/store'</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 定义数组存储需要登录才能访问的路由</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">authNeedRouters</span><span style="color: #D4D4D4"> = [</span><span style="color: #CE9178">'/myorder'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'/pay'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'/productdetail/:id'</span><span style="color: #D4D4D4">]</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 创建全局路由前置守卫</span></span><span class="line"><span style="color: #9CDCFE">router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">beforeEach</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">to</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">from</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">next</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 判断to的path是否存在登录的路由数组中</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #9CDCFE">authNeedRouters</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">includes</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">to</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 不需要登录，直接进入</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">next</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">  } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 判断是否有token（实际上需要调用后端接口校验token）</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">token</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">User</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">userInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">token</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">token</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 有token，可以进入</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">next</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 没有token，跳转到登录页</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">next</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/login'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">})</span></span></code></pre></div></div></figure><h2 id="首页"><a class="markdownIt-Anchor" href="#首页"></a> 首页</h2><h3 id="完成首页静态结构"><a class="markdownIt-Anchor" href="#完成首页静态结构"></a> 完成首页静态结构</h3><p>要用到的 vant 组件有</p><ul><li>search（搜索框）</li><li>swipe &amp; swipe-item （轮播图）</li><li>grid &amp; grid-item （宫格）</li></ul><p>grid 宫格主要是使用自定义列数的：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408291915006.png" alt="image-20240829191508887" style="zoom:50%;"></p><p>所以在 utils 包下的 vant2-ui.js 中进行添加：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// vant2-ui.js按需导入组件</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vue'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">Button</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">Tabbar</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">TabbarItem</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">NavBar</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">Search</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">Swipe</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">SwipeItem</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">Grid</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">GridItem</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vant'</span></span><span class="line"></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">Tabbar</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">TabbarItem</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">Button</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">NavBar</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">Search</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">Swipe</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">SwipeItem</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">Grid</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">GridItem</span><span style="color: #D4D4D4">)</span></span></code></pre></div></div></figure><p>静态结构和样式 <code>layout/home.vue</code></p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"home"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 导航条 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"智慧商城"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 搜索框 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-search</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">readonly</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">shape</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"round"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#f1f1f2"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"请在此输入搜索关键词"</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/search'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">    /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 轮播图 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-swipe</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"my-swipe"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">autoplay</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">3000</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">indicator-color</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"white"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"@/assets/banner1.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"@/assets/banner2.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"@/assets/banner3.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-swipe</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 导航 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-grid</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">column-num</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"5"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">icon-size</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"40"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-grid-item</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">icon</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"http://cba.itlike.com/public/uploads/10001/20230320/58a7c1f62df4cb1eb47fe83ff0e566e6.png"</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">text</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"新品首发"</span></span><span class="line"><span style="color: #D4D4D4">        @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/category'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-grid</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 主会场 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"main"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"@/assets/main.png"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 猜你喜欢 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"guess"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"guess-title"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">—— 猜你喜欢 ——</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goods-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">GoodsItem</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">GoodsItem</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">GoodsItem</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/components/GoodsItem.vue'</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'HomePage'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">components:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">GoodsItem</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #6A9955">// 主题 padding</span></span><span class="line"><span style="color: #D7BA7D">.home</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 导航条样式定制</span></span><span class="line"><span style="color: #D7BA7D">.van-nav-bar</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">z-index</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">999</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#c21401</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-nav-bar__title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 搜索框样式定制</span></span><span class="line"><span style="color: #D7BA7D">.van-search</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">fixed</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">z-index</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">999</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 分类导航部分</span></span><span class="line"><span style="color: #D7BA7D">.my-swipe</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-swipe-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">185px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#39a9ed</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.my-swipe</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-swipe-item</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">185px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 主会场</span></span><span class="line"><span style="color: #D7BA7D">.main</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 猜你喜欢</span></span><span class="line"><span style="color: #D7BA7D">.guess</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.guess-title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 商品样式</span></span><span class="line"><span style="color: #D7BA7D">.goods-list</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f6f6f6</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>其中将商品项封装成组件 GoodsItem.vue 在 components 包下：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goods-item"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/prodetail'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"@/assets/product.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tit text-ellipsis-2"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        三星手机 SAMSUNG Galaxy S23 8GB+256GB 超视觉夜拍系统 超清夜景 悠雾紫</span></span><span class="line"><span style="color: #D4D4D4">        5G手机 游戏拍照旗舰机s23</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"count"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">已售104件</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"price"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"new"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">¥3999.00</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"old"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">¥6699.00</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.goods-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">148px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">6px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">127px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.right</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1.3</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex-direction</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">column</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-evenly</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.count</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#999</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.price</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#999</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.new</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f03c3c</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.old</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">text-decoration</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">line-through</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h3 id="首页-动态渲染"><a class="markdownIt-Anchor" href="#首页-动态渲染"></a> 首页 - 动态渲染</h3><p>根据接口文档封装请求首页数据模块于 api 包下，新建 home.js：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/request'</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 获取首页数据</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getHomeData</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">request</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/page/detail'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">params:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">pageId:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>接着转到 layout 的 home.vue 处理动态渲染：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">GoodsItem</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/components/GoodsItem.vue'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getHomeData</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/home'</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'HomePage'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">components:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">GoodsItem</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">bannerList:</span><span style="color: #D4D4D4"> [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">navList:</span><span style="color: #D4D4D4"> [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">prodsList:</span><span style="color: #D4D4D4"> []</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">: { </span><span style="color: #4FC1FF">pageData</span><span style="color: #D4D4D4"> } } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getHomeData</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">pageData</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">bannerList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">pageData</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">items</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">].</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 获取轮播图数据</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">navList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">pageData</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">items</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">].</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 获取导航组数据</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">prodsList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">pageData</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">items</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">6</span><span style="color: #D4D4D4">].</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 获取商品组数据</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>改造 template 中轮播图和导航部分：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">&lt;!-- 轮播图 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-swipe</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"my-swipe"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">autoplay</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">3000</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">indicator-color</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"white"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;van-swipe-item v-for="item in bannerList" :key="item.imgUrl"&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;img :src="item.imgUrl" alt=""&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;/van-swipe-item&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-swipe</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">&lt;!-- 导航 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-grid</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">column-num</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"5"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">icon-size</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"40"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;van-grid-item</span></span><span class="line"><span style="color: #D4D4D4">      v-for="item in navList" :key="item.imgUrl"</span></span><span class="line"><span style="color: #D4D4D4">      :icon="item.imgUrl"</span></span><span class="line"><span style="color: #D4D4D4">      :text="item.text"</span></span><span class="line"><span style="color: #D4D4D4">      @click="$router.push('/category')"</span></span><span class="line"><span style="color: #D4D4D4">    /&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-grid</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>接着改造商品组：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">&lt;!-- 猜你喜欢 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"guess"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;p class="guess-title"&gt;—— 猜你喜欢 ——&lt;/p&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;div class="goods-list"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;GoodsItem v-for="item in prodsList" :key="item.goods_id" :goods="item"&gt;&lt;/GoodsItem&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>父传子将 item 整个对象传给 GoodsItem 进行接收：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'GoodsItem'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">props:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">goods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Object</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">default</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {}</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><p>然后改造 template</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goods-item"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">goods</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">`/prodetail/</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">goods</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;div class="left"&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;img :src="goods.goods_image" alt="" /&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;p class="tit text-ellipsis-2"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        {{ goods.goods_name }}</span></span><span class="line"><span style="color: #D4D4D4">      &lt;/p&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;p class="count"&gt;{{goods.goods_sales}}&lt;/p&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;p class="price"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;span class="new"&gt;{{goods.goods_price_min}}&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;span class="old"&gt;{{goods.goods_price_max}}&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;/p&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>注意将商品 id 携带进行跳转时要动态取值使用反引号。</p><h2 id="搜索"><a class="markdownIt-Anchor" href="#搜索"></a> 搜索</h2><p>页面设计：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408292021783.png" alt="image-20230621144449700"></p><h3 id="搜索页静态结构"><a class="markdownIt-Anchor" href="#搜索页静态结构"></a> 搜索页静态结构</h3><p><code>view/search/index.vue</code>（需要导入 vant 组件 Icon）</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"search"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"商品搜索"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-search</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">show-action</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"请输入搜索关键词"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">clearable</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #D4D4D4"> #</span><span style="color: #9CDCFE">action</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">搜索</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-search</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 搜索历史 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"search-history"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4"> &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"title"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">最近搜索</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"delete-o"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">size</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"16"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"list-item"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/searchlist'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">{{ </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> }}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'SearchIndex'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">historyList:</span><span style="color: #D4D4D4"> [</span><span style="color: #CE9178">'炒锅'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'电视'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'冰箱'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'手机'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'自行车'</span><span style="color: #D4D4D4">]</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.search</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.searchBtn</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-search__action</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#c21401</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-icon-arrow-left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">15px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.list</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex-start</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex-wrap</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">wrap</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">gap</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.list-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">25%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">7px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">15px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">13px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">hidden</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">white-space</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">nowrap</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">text-overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">ellipsis</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h3 id="历史记录管理"><a class="markdownIt-Anchor" href="#历史记录管理"></a> 历史记录管理</h3><p>目标：构建搜索页的静态布局，完成历史记录的管理<br>需求分析：</p><ol><li>搜索历史基本渲染</li><li>点击搜索 (添加历史)</li></ol><p>添加历史说明：</p><p>点击搜索按钮或底下历史记录，都能进行搜索</p><ol><li>若之前没有相同搜索关键字，则直接追加到最前面</li><li>若之前已有相同搜索关键字，将该原有关键字移除，再追加（相当于置顶）</li></ol><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"search"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"商品搜索"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-search</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">v-model</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">search</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">search</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #DCDCAA">goSearch</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">search</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">show-action</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"请输入搜索关键词"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">clearable</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #D4D4D4"> #</span><span style="color: #9CDCFE">action</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #DCDCAA">goSearch</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">search</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">搜索</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-search</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 搜索历史 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"search-history"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4"> &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"title"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">最近搜索</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"delete-o"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">clearHistory</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">size</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"16"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"list-item"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #DCDCAA">goSearch</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">{{ </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> }}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getHistory</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">setHistory</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/storage'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'SearchIndex'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">search:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">historyList:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getHistory</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">goSearch</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">searchContent</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 判断输入的搜索词是否已经在historyList中</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">index</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">indexOf</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">searchContent</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4"> !== -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 说明存在，则将其进行删除</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">splice</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) </span><span style="color: #6A9955">// splice语法：splice(index, howMany, item1, ....., itemX)</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 将搜索词添加到historyList的最前面</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">unshift</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">searchContent</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">setHistory</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 跳转到搜索列表页面</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">`/searchlist?search=</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">searchContent</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">clearHistory</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">historyList</span><span style="color: #D4D4D4"> = []</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">setHistory</span><span style="color: #D4D4D4">([])</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">...</span></span></code></pre></div></div></figure><p>持久化存储代码：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">HISTORY_KEY</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'shopping_history_info'</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 获取搜索历史</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getHistory</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">history</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">localStorage</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getItem</span><span style="color: #D4D4D4">(</span><span style="color: #4FC1FF">HISTORY_KEY</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">history</span><span style="color: #D4D4D4"> ? </span><span style="color: #4FC1FF">JSON</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">parse</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">history</span><span style="color: #D4D4D4">) : []</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #6A9955">// 设置搜索历史</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setHistory</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">arr</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">localStorage</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setItem</span><span style="color: #D4D4D4">(</span><span style="color: #4FC1FF">HISTORY_KEY</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">JSON</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">stringify</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">arr</span><span style="color: #D4D4D4">))</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="搜索列表页"><a class="markdownIt-Anchor" href="#搜索列表页"></a> 搜索列表页</h3><h4 id="静态布局"><a class="markdownIt-Anchor" href="#静态布局"></a> 静态布局</h4><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"search"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"商品列表"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-search</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">readonly</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">shape</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"round"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#ffffff"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"手机"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">show-action</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/search'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #D4D4D4"> #</span><span style="color: #9CDCFE">action</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tool"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"apps-o"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-search</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 排序选项按钮 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sort-btns"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sort-item"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">综合</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sort-item"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">销量</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sort-item"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">价格 </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goods-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">GoodsItem</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">GoodsItem</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">GoodsItem</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/components/GoodsItem.vue'</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'SearchIndex'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">components:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">GoodsItem</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.search</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-icon-arrow-left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.tool</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">24px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.sort-btns</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.sort-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 商品样式</span></span><span class="line"><span style="color: #D7BA7D">.goods-list</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f6f6f6</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h4 id="渲染"><a class="markdownIt-Anchor" href="#渲染"></a> 渲染</h4><p>封装请求获取商品列表 <code>api/product.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'../utils/request'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getProducts</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">sortType</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">sortPrice</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">categoryId</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsName</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">page</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">obj</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/goods/list'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">params:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// all-按综合搜索(默认)，sales-按销量，price-按价格</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">sortType</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 0-价格从低到高，1-价格从高到低</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">sortPrice</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 分类id，示例值：0</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">categoryId</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 商品名称，示例值：酒</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsName</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 页码，示例值：1</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">page</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>基于搜索词进行渲染</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"search"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"商品列表"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-search</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">readonly</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">shape</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"round"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#ffffff"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">queryParam</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">show-action</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/search'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #D4D4D4"> #</span><span style="color: #9CDCFE">action</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tool"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"apps-o"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-search</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 排序选项按钮 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sort-btns"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sort-item"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">{ </span><span style="color: #C8C8C8">active</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">currentSortType</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'all'</span><span style="color: #D4D4D4"> }</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #DCDCAA">sortGoods</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'all'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">综合</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sort-item"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">{ </span><span style="color: #C8C8C8">active</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">currentSortType</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'sales'</span><span style="color: #D4D4D4"> }</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #DCDCAA">sortGoods</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'sales'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">销量</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sort-item"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">{ </span><span style="color: #C8C8C8">active</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">currentSortType</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'price'</span><span style="color: #D4D4D4"> }</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #DCDCAA">sortGoods</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'price'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">价格</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goods-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">GoodsItem</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">productList</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">goods</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">GoodsItem</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">GoodsItem</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/components/GoodsItem.vue'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getProducts</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/product'</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'SearchIndex'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">components:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">GoodsItem</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">computed:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 从router的query中拿到查询参数</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">queryParam</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(this.$route.query.search)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 如果查询参数不存在就返回一个空字符串</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">query</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">search</span><span style="color: #D4D4D4"> || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取商品列表数据</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getProducts</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsName:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">queryParam</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// page: this.page</span></span><span class="line"><span style="color: #D4D4D4">    })</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">productList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">currentSortType:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'all'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">productList:</span><span style="color: #D4D4D4"> [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">page:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">1</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 排序商品</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">sortGoods</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">sortType</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(sortType)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">currentSortType</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">sortType</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 更新当前选中的排序类型</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getProducts</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsName:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">queryParam</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">sortType:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sortType</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">productList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.search</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-icon-arrow-left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.tool</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">24px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.sort-btns</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.sort-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.active</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#ee0a24</span><span style="color: #D4D4D4"> }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 商品样式</span></span><span class="line"><span style="color: #D7BA7D">.goods-list</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f6f6f6</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h4 id="基于分类页面的分类id进行渲染"><a class="markdownIt-Anchor" href="#基于分类页面的分类id进行渲染"></a> 基于分类页面的分类 id 进行渲染</h4><p>封装请求分类页数据 <code>api/category.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/request'</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 获取分类页数据</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCategoryData</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/category/list'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>完成分类页静态结构</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"category"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 分类 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"全部分类"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 搜索框 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-search</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">readonly</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">shape</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"round"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#f1f1f2"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"请输入搜索关键词"</span></span><span class="line"><span style="color: #D4D4D4">      @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/search'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">    /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 分类列表 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"list-box"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-sidebar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">v-model</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">activeKey</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-sidebar-item</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">category_id</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">{ </span><span style="color: #C8C8C8">active</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">activeKey</span><span style="color: #D4D4D4"> }</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">activeKey</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">href</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"javascript:;"</span><span style="color: #D4D4D4">/</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-sidebar</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">`/searchlist?categoryId=</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">category_id</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">activeKey</span><span style="color: #D4D4D4">]?.</span><span style="color: #9CDCFE">children</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">category_id</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cate-goods"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">image</span><span style="color: #D4D4D4">?.</span><span style="color: #9CDCFE">external_url</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">{{ </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4"> }}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getCategoryData</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/category'</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'CategoryPage'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getCategoryList</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">activeKey:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">list:</span><span style="color: #D4D4D4"> [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">activeIndex:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCategoryList</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">: { </span><span style="color: #4FC1FF">list</span><span style="color: #D4D4D4"> } } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCategoryData</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">list</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(this.list)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #6A9955">// 主题 padding</span></span><span class="line"><span style="color: #D7BA7D">.category</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100vh</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.list-box</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">85px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f3f3f3</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">van-sidebar-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">45px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">45px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#444444</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #D7BA7D">&amp;.active</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fb442f</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.right</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#ffffff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">flex-wrap</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">wrap</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex-start</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">align-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex-start</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.cate-goods</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">33.3%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">70px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">70px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #D7BA7D">p</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 导航条样式定制</span></span><span class="line"><span style="color: #D7BA7D">.van-nav-bar</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">z-index</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">999</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 搜索框样式定制</span></span><span class="line"><span style="color: #D7BA7D">.van-search</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">fixed</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">z-index</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">999</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>修改搜索页列表的查询参数</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">import GoodsItem from '@/components/GoodsItem.vue'</span></span><span class="line"><span style="color: #D4D4D4">import </span><span style="color: #569CD6">{</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">getProducts</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">}</span><span style="color: #D4D4D4"> from '@/api/product'</span></span><span class="line"><span style="color: #D4D4D4">export default </span><span style="color: #569CD6">{</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'SearchIndex'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">components</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">GoodsItem</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">computed</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 从router的query中拿到查询参数</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">querySearch</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(this.$route.query.search)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 如果查询参数不存在就返回一个空字符串</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">query</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">search</span><span style="color: #D4D4D4"> || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">queryCategory</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">query</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">categoryId</span><span style="color: #D4D4D4"> || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取商品列表数据</span></span><span class="line"><span style="color: #D4D4D4">    const </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getProducts</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">categoryId:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">queryCategory</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsName:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">querySearch</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// page: this.page</span></span><span class="line"><span style="color: #D4D4D4">    })</span></span><span class="line"><span style="color: #D4D4D4">    this.</span><span style="color: #9CDCFE">productList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(res.data.list)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(this.querySearch)</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    return {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">currentSortType</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'all'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">productList</span><span style="color: #D4D4D4">: [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">page</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 排序商品</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">sortGoods</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">sortType</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(sortType)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">currentSortType</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">sortType</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 更新当前选中的排序类型</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getProducts</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">categoryId:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">queryCategory</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsName:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">querySearch</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">sortType:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sortType</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">productList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h2 id="商品详情页"><a class="markdownIt-Anchor" href="#商品详情页"></a> 商品详情页</h2><h3 id="静态结构"><a class="markdownIt-Anchor" href="#静态结构"></a> 静态结构</h3><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"prodetail"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"商品详情页"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-swipe</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">autoplay</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">3000</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">change</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">onChange</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">image</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">images</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">image</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #D4D4D4"> #</span><span style="color: #9CDCFE">indicator</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"custom-indicator"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">{{ </span><span style="color: #9CDCFE">current</span><span style="color: #D4D4D4"> + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> }} / {{ </span><span style="color: #9CDCFE">images</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4"> }}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-swipe</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 商品说明 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"title"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"price"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"now"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">￥0.01</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"oldprice"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">￥6699.00</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sellcount"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">已售1001件</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"msg text-ellipsis-2"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        三星手机 SAMSUNG Galaxy S23 8GB+256GB 超视觉夜拍系统 超清夜景 悠雾紫 5G手机 游戏拍照旗舰机s23</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"service"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left-words"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"passed"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">七天无理由退货</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"passed"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">48小时发货</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right-icon"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"arrow"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 商品评价 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"comment"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"comment-title"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">商品评价 (5条)</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">查看更多 </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"arrow"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"comment-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"comment-item"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"top"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"http://cba.itlike.com/public/uploads/10001/20230321/a0db9adb2e666a65bc8dd133fbed7834.png"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"name"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">神雕大侠</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-rate</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">size</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">16</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#ffd21e"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">void-icon</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"star"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">void-color</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#eee"</span><span style="color: #D4D4D4">/</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"content"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            质量很不错 挺喜欢的</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"time"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            2023-03-21 15:01:35</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 商品描述 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"desc"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"https://uimgproxy.suning.cn/uimg1/sop/commodity/kHgx21fZMWwqirkMhawkAw.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"https://uimgproxy.suning.cn/uimg1/sop/commodity/0rRMmncfF0kGjuK5cvLolg.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"https://uimgproxy.suning.cn/uimg1/sop/commodity/2P04A4Jn0HKxbKYSHc17kw.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"https://uimgproxy.suning.cn/uimg1/sop/commodity/MT4k-mPd0veQXWPPO5yTIw.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 底部 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"footer"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"icon-home"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"wap-home-o"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">首页</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"icon-cart"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"shopping-cart-o"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">购物车</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"btn-add"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">加入购物车</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"btn-buy"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">立刻购买</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'ProDetail'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">images:</span><span style="color: #D4D4D4"> [</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">'https://img01.yzcdn.cn/vant/apple-1.jpg'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">'https://img01.yzcdn.cn/vant/apple-2.jpg'</span></span><span class="line"><span style="color: #D4D4D4">      ],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">current:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">onChange</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">current</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">index</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.prodetail</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-icon-arrow-left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.custom-indicator</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">absolute</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">rgba</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.1</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">15px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.desc</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">overflow</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">scroll</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #569CD6">!important</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.info</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.now</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.oldprice</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#959595</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">text-decoration</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">line-through</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin-left</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.sellcount</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#959595</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">relative</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">4px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.msg</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">24px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.service</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fafafa</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.left-words</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">span</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.van-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">4px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.comment</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.comment-title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.right</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#959595</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.comment-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.top</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.name</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.time</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#999</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.footer</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">fixed</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">left</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">55px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#ccc</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-evenly</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.icon-home</span><span style="color: #D4D4D4">, </span><span style="color: #D7BA7D">.icon-cart</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">flex-direction</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">column</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.van-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">24px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.btn-add</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.btn-buy</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">120px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">18px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#ffa900</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.btn-buy</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fe5630</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D4D4D4">    </span></span><span class="line"><span style="color: #D7BA7D">.tips</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>封装获取商品详情的请求模块 <code>api/goodsDetail.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/request'</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 获取商品详情</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getGoodsDetail</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/goods/detail'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">params:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsId</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>获取的一个示例：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408301539204.png" alt="image-20240830153951035"></p><p>于是进行动态渲染</p><h3 id="商品说明动态渲染"><a class="markdownIt-Anchor" href="#商品说明动态渲染"></a> 商品说明动态渲染</h3><p>改造 template 中对图片的渲染：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">image</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">images</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">     &lt;img :src="image.external_url" /&gt;</span></span><span class="line"><span style="color: #D4D4D4">   </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-swipe-item</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>script 部分如下：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">import </span><span style="color: #569CD6">{</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">getGoodsDetail</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">}</span><span style="color: #D4D4D4"> from '@/api/goodsDetail'</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">export default </span><span style="color: #569CD6">{</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'ProDetail'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">computed</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">detailId</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">params</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    const </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detailId</span></span><span class="line"><span style="color: #D4D4D4">    const </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getGoodsDetail</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(res)</span></span><span class="line"><span style="color: #D4D4D4">    this.</span><span style="color: #9CDCFE">goodsObj</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detail</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(this.goodsObj)</span></span><span class="line"><span style="color: #D4D4D4">    this.</span><span style="color: #9CDCFE">images</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_images</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    return {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">goodsObj</span><span style="color: #D4D4D4">: {},</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">images</span><span style="color: #D4D4D4">: [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">current</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">onChange</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">current</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">index</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #569CD6">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>修改商品说明进行动态渲染：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">&lt;!-- 商品说明 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;div class="title"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="price"&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;span class="now"&gt;￥{{ goodsObj.goods_price_min }}&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;span class="oldprice"&gt;￥{{ goodsObj.goods_price_max }}&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"sellcount"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">已售{{ goodsObj.goods_sales }}件</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;div class="msg text-ellipsis-2"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        {{ goodsObj.goods_name }}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>到这里还没有完成评论区的动态渲染</p><h3 id="商品评论区渲染"><a class="markdownIt-Anchor" href="#商品评论区渲染"></a> 商品评论区渲染</h3><p>封装请求获取商品评价详情的模块 <code>api/goodsDetail.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 获取商品评价详情</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getGoodsCommentDetail</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">scoreType</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsId</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">page</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">obj</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/comment/list'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">params:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">scoreType</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">page</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>请求解构：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408301611303.png" alt="image-20240830161142137"></p><p>完成商品评价渲染（默认只展示三条评价）</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">&lt;!-- 商品评价 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"comment"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;div class="comment-title"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="left"&gt;商品评价 ({{ goodsCommentArray.length }}条)</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">`/productComment?id=</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">detailId</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">查看更多 &lt;van-icon name="arrow" /&gt; </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;div class="comment-list"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="comment-item" v-for="(item, index) in goodsCommentArray" :key="item.comment_id"&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;div class="top" v-if="index &lt; 3"&gt;</span></span><span class="line"><span style="color: #D4D4D4">            &lt;img :src="item.user.avatar_url ? item.user.avatar_url : defaultAvatar" alt=""&gt;</span></span><span class="line"><span style="color: #D4D4D4">            &lt;div class="name"&gt;{{item.user.nick_name}}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-rate</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">size</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">16</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">score</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#ffd21e"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">void-icon</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"star"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">void-color</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#eee"</span><span style="color: #808080">/&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;div class="content" v-if="index &lt; 3"&gt;</span></span><span class="line"><span style="color: #D4D4D4">            {{item.content}}</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"time"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4"> &lt; </span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            {{item.create_time}}</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>在生命周期钩子 created 中：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取商品详情-说明部分</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">goodsId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detailId</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getGoodsDetail</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(res)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsDetailObj</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detail</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">images</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsDetailObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_images</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取商品详情-评价部分</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">commentRes</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getGoodsCommentDetail</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">scoreType:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 默认抓取好评</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsId:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">page:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">1</span></span><span class="line"><span style="color: #D4D4D4">    })</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsCommentArray</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">commentRes</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span></code></pre></div></div></figure><p>data 提供：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">defaultAvatar:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'https://.../coding/202408301648039.png'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsDetailObj:</span><span style="color: #D4D4D4"> {}, </span><span style="color: #6A9955">// 商品说明</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsCommentArray:</span><span style="color: #D4D4D4"> {}, </span><span style="color: #6A9955">// 商品评价</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">images:</span><span style="color: #D4D4D4"> [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">current:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span></code></pre></div></div></figure><p>现在剩下商品说明的图片未渲染、商品评论区未渲染</p><h3 id="商品说明的图片渲染"><a class="markdownIt-Anchor" href="#商品说明的图片渲染"></a> 商品说明的图片渲染</h3><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408310104868.png" alt="image-20240830174412273"><br>接口返回的数据中 content 就是商品详细说明的图：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408310105026.png" alt="image-20240830174505655"></p><p>于是再于 data 中提供两个数据用于处理：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">imgSrcRegex</span><span style="color: #D4D4D4">:</span><span style="color: #D16969"> /&lt;img</span><span style="color: #CE9178">[^</span><span style="color: #D16969">&gt;</span><span style="color: #CE9178">]</span><span style="color: #D7BA7D">+</span><span style="color: #D16969">src="</span><span style="color: #CE9178">([^</span><span style="color: #D16969">"&gt;</span><span style="color: #CE9178">]</span><span style="color: #D7BA7D">+</span><span style="color: #CE9178">)</span><span style="color: #D16969">"/</span><span style="color: #569CD6">g</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 匹配接口数据html中的src图</span></span><span class="line"><span style="color: #C8C8C8">imgSrcArray</span><span style="color: #D4D4D4">: [], </span><span style="color: #6A9955">// 商品详细介绍长图</span></span></code></pre></div></div></figure><p>再到 created 中编写：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取商品详情-说明部分</span></span><span class="line"><span style="color: #D4D4D4">    ...</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取商品详情-评价部分</span></span><span class="line"><span style="color: #D4D4D4">   ...</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 正则匹配得到商品详细介绍长图</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">htmlString</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsDetailObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">content</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">srcArray</span><span style="color: #D4D4D4"> = []</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">regex</span><span style="color: #D4D4D4"> =</span><span style="color: #D16969"> /&lt;img\s</span><span style="color: #D7BA7D">+</span><span style="color: #CE9178">[^</span><span style="color: #D16969">&gt;</span><span style="color: #CE9178">]</span><span style="color: #D7BA7D">*</span><span style="color: #D16969">src="</span><span style="color: #CE9178">([^</span><span style="color: #D16969">"</span><span style="color: #CE9178">]</span><span style="color: #D7BA7D">*</span><span style="color: #CE9178">)</span><span style="color: #D16969">"/</span><span style="color: #569CD6">g</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">match</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">while</span><span style="color: #D4D4D4"> ((</span><span style="color: #9CDCFE">match</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">regex</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">exec</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">htmlString</span><span style="color: #D4D4D4">)) !== </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">srcArray</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">match</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">]) </span><span style="color: #6A9955">// 将匹配到的 src URL 添加到数组中</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">imgSrcArray</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">srcArray</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(this.imgSrcArray) // 输出结果数组</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span></code></pre></div></div></figure><p>接下来就剩下完全的评价区渲染了。</p><h2 id="商品评价区"><a class="markdownIt-Anchor" href="#商品评价区"></a> 商品评价区</h2><p>这是一个新的页面所以直接新建了。<code>views/productdetail/evaluation.vue</code></p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goodsEvaluation"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"商品评价页"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"comment-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"comment-item"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">goodsCommentArray</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">comment_id</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"top"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">user</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">avatar_url</span><span style="color: #D4D4D4"> || </span><span style="color: #9CDCFE">defaultAvatar</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"name"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">{{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">user</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">nick_name</span><span style="color: #D4D4D4">}}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-rate</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">size</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">16</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">score</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#ffd21e"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">void-icon</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"star"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">void-color</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"#eee"</span><span style="color: #D4D4D4">/</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"content"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          {{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">}}</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"time"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          {{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">create_time</span><span style="color: #D4D4D4">}}</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getGoodsCommentDetail</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/goodsDetail'</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'GoodsEvaluation'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">computed:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">detailId</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">params</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">try</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">goodsId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detailId</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">commentRes</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getGoodsCommentDetail</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">scoreType:</span><span style="color: #D4D4D4"> -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 全部评价</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsId</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsCommentArray</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">commentRes</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsCommentArray</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">catch</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">error</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Failed to fetch goods comments:'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 可以在这里添加更多的错误处理逻辑，比如显示错误提示</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">defaultAvatar:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'https://.../coding/202408301648039.png'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">goodsCommentArray:</span><span style="color: #D4D4D4"> [] </span><span style="color: #6A9955">// 商品评价</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.goodsEvaluation</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f7f7f7</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">min-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100vh</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">.van-icon-arrow-left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.comment-list</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">15px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.comment-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">8px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">15px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">box-shadow</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">2px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">8px</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">rgba</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.05</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">22px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.top</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">object-fit</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">cover</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#eaeaea</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.name</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-weight</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">600</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">flex-grow</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.van-rate</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">margin-left</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.content</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#555</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">white-space</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">normal</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">word-wrap</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">break-word</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.time</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#999</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">right</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>并转到 router 包下修改路由：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 配置动态商品id，用于确认将来是哪个商品详情页</span></span><span class="line"><span style="color: #D4D4D4">{ </span><span style="color: #C8C8C8">path</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/productdetail/:id'</span><span style="color: #D4D4D4">, </span><span style="color: #C8C8C8">component</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">ProductDetail</span><span style="color: #D4D4D4"> },</span></span><span class="line"><span style="color: #D4D4D4">{ </span><span style="color: #C8C8C8">path</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/evaluation/:id'</span><span style="color: #D4D4D4">, </span><span style="color: #C8C8C8">component</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">GoodsEvaluation</span><span style="color: #D4D4D4"> },</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 404页面，用于调试</span></span><span class="line"><span style="color: #D4D4D4">{ </span><span style="color: #C8C8C8">path</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'*'</span><span style="color: #D4D4D4">, </span><span style="color: #C8C8C8">component</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">NotFound</span><span style="color: #D4D4D4"> }</span></span></code></pre></div></div></figure><h2 id="加入购物车购买"><a class="markdownIt-Anchor" href="#加入购物车购买"></a> 加入购物车 / 购买</h2><p>该功能使用到弹层组件，可以在 vant 组件库中找到 ActionSheet</p><p>页面代码如下：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">&lt;!-- 弹层 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-action-sheet</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">v-model</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">showPannel</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'cart'</span><span style="color: #D4D4D4"> ? </span><span style="color: #CE9178">'加入购物车'</span><span style="color: #D4D4D4"> : </span><span style="color: #CE9178">'立刻购买'</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;div class="product"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="product-title"&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;div class="left"&gt;</span></span><span class="line"><span style="color: #D4D4D4">            &lt;img :src="goodsDetailObj.goods_image" alt=""&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;div class="right"&gt;</span></span><span class="line"><span style="color: #D4D4D4">            &lt;div class="price"&gt;</span></span><span class="line"><span style="color: #D4D4D4">              &lt;span&gt;¥&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">              &lt;span class="nowprice"&gt;{{ goodsDetailObj.goods_price_min }}&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">            &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">            &lt;div class="count"&gt;</span></span><span class="line"><span style="color: #D4D4D4">              &lt;span&gt;库存&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">              &lt;span&gt;{{ goodsDetailObj.stock_total }}&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">            &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="num-box"&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;span&gt;数量&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">          数字框占位</span></span><span class="line"><span style="color: #D4D4D4">        &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;!-- 有库存才显示可购买 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="showbtn" v-if="goodsDetailObj.stock_total &gt; 0"&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;div class="btn" v-if="true"&gt;加入购物车&lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;div class="btn now" v-else&gt;立刻购买&lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="btn-none" v-else&gt;该商品已抢完&lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-action-sheet</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>样式如下：</p><figure class="shiki less"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 弹层样式</span></span><span class="line"><span style="color: #D7BA7D">.product</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.product-title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">90px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">90px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.right</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.price</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fe560a</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #D7BA7D">.nowprice</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">24px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.num-box</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.btn</span><span style="color: #D4D4D4">, </span><span style="color: #D7BA7D">.btn-none</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">rgb</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">255</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">255</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">255</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">rgb</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">255</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">148</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.btn.now</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fe5630</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.btn-none</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#cccccc</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>data 中提供两个数据：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">showPannel</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #C8C8C8">mode</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'cart'</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 购物车或立即购买</span></span></code></pre></div></div></figure><p>methods 中提供两个方法：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">addToCart</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">showPannel</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">true</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'cart'</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">buyNow</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">showPannel</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">true</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'buy'</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><p>接下来还需要将弹层中的数量展示封装成数字框组件。</p><h2 id="数字框组件封装"><a class="markdownIt-Anchor" href="#数字框组件封装"></a> 数字框组件封装</h2><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408310106195.png" alt="image-20240831010611047"><br>分析：组件名 CountBox</p><ol><li>静态结构，左中右三部分</li><li>数字框的数字，应该是外部传递进来的 (父传子)</li><li> 点击 <code>+－</code>号，可以修改数字（子传父)</li><li> 使用 <code>v-model</code> 实现封装（<code>:value</code> 和 <code>@input</code> 的简写）</li><li>数字不能减到小于 1</li></ol><p>封装组件 <code>components/CountBox.vue</code></p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"count-box"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">handleSub</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"minus"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">-</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">change</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">handleChange</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"inp"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">handleAdd</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"add"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">+</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">props:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">value:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Number</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">default:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">1</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">handleSub</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4"> &lt;= </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">$emit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'input'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4"> - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">handleAdd</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">$emit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'input'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4"> + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">handleChange</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(e.target.value)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">num</span><span style="color: #D4D4D4"> = +</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 转数字处理 (1) 数字 (2) NaN</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 输入了不合法的文本 或 输入了负值，回退成原来的 value 值</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">isNaN</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">num</span><span style="color: #D4D4D4">) || </span><span style="color: #9CDCFE">num</span><span style="color: #D4D4D4"> &lt; </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">value</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">$emit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'input'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">num</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.count-box</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">110px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.add</span><span style="color: #D4D4D4">, </span><span style="color: #D7BA7D">.minus</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">outline</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.inp</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">outline</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>使用组件</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">CountBox</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/components/CountBox.vue'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'ProDetail'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">components:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">CountBox</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">addCount:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">1</span></span><span class="line"><span style="color: #D4D4D4">      ...</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"num-box"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">数量</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #4EC9B0">CountBox</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">v-model</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"addCount"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #4EC9B0">CountBox</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h2 id="加入购物车-判断登录状态"><a class="markdownIt-Anchor" href="#加入购物车-判断登录状态"></a> 加入购物车 - 判断登录状态</h2><p>需要使用到 vant 的 Dialog 组件</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">Dialog</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vant'</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">Dialog</span><span style="color: #D4D4D4">({ </span><span style="color: #9CDCFE">message:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'提示'</span><span style="color: #D4D4D4"> });</span></span></code></pre></div></div></figure><p>给弹层的加入购物车按钮绑定点击事件</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"btn"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"this.mode === 'cart'"</span><span style="color: #D4D4D4"> </span><span style="color: #F44747">@click="addCart"&gt;加入购物车&lt;/div&gt;</span></span></code></pre></div></div></figure><p>添加 token 鉴权判断，跳转携带回跳地址</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 加入购物车判断登录状态</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">addCart</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(this.$store.getters.token)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">token</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 说明没有token，没有token就需要提示登录</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$dialog</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">confirm</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">message:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'当前操作需要登录后才能进行哦'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">confirmButtonText:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'去登录'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">cancelButtonText:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'再逛逛'</span></span><span class="line"><span style="color: #D4D4D4">        }).</span><span style="color: #DCDCAA">then</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// 说明点击了去登录，需要带上backUrl</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">replace</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">path:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'/login'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">query:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">backUrl:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">fullPath</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 带上当前页面的全路径（包括查询参数）</span></span><span class="line"><span style="color: #D4D4D4">            }</span></span><span class="line"><span style="color: #D4D4D4">          })</span></span><span class="line"><span style="color: #D4D4D4">        })</span></span><span class="line"><span style="color: #D4D4D4">          .</span><span style="color: #DCDCAA">catch</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// 说明点击了再逛逛，不做任何操作</span></span><span class="line"><span style="color: #D4D4D4">          })</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><p>登录后如果有回跳地址则 replace 地回跳回去：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 判断有无回跳地址</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">url</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">query</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">backUrl</span><span style="color: #D4D4D4"> || </span><span style="color: #CE9178">'/'</span></span><span class="line"><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">replace</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">url</span><span style="color: #D4D4D4">)</span></span></code></pre></div></div></figure><h2 id="thisrouterreplace和thisrouterpush的区别"><a class="markdownIt-Anchor" href="#thisrouterreplace和thisrouterpush的区别"></a> <code>this.$router.replace</code> 和 <code>this.$router.push</code> 的区别</h2><p>假设有 A、B、C 三个页面。</p><p>我从 A 点击进入 B 页面，然后在 B 页面需要进行跳转到 C 页面，此时我触发的是 <code>this.$router.replace</code> 进行跳转，那么跳转到 C 之后 C 就会将 B 的访问记录完全覆盖。如果我在 C 页面的操作结束之后，进行返回上一页的操作，就会直接返回到 A 页面而不是 B 页面。</p><p>相对的，<code>this.$router.push</code> 则会将记录保持，你的每次访问都是一个累加的过程，不会清除。</p><p>如果把页面比作真实的纸张，跳转的过程就像把我们手里的一张纸覆盖到桌子上的另一张纸上面一样，桌子上纸张堆的是已经访问过的页面，桌子上的纸张堆中最上面那一张就是我们现在正在访问的页面，而手里的是将要访问的页面。但覆盖的方式上述两种各有不同：<code>replace</code> 会在覆盖桌子上的纸张之前将桌子上最上面的那一张丢到垃圾桶，然后再将手中的纸张覆盖上去；<code>push</code> 则是简单的将纸张放在桌子上的纸张上面，不进行其他任何操作，最终你的访问记录都在桌子上。</p><h2 id="加入购物车-封装接口进行请求"><a class="markdownIt-Anchor" href="#加入购物车-封装接口进行请求"></a> 加入购物车 - 封装接口进行请求</h2><p>接口如下：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408310106434.png" alt="image-20240830232641136"></p><p>封装加入购物车的请求接口模块 <code>api/cart.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 加入购物车的请求</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/request'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">addCart</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">goodsNum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// goodsId: 商品id, goodsNum: 商品数量, goodsSkuId: 商品规格id 如红色手机</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/cart/add'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">goodsNum</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">goodsSkuId</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>由于需要携带请求头且携带的是鉴权信息，每次请求手动去写比较麻烦，所以直接在请求拦截器中携带 <code>utils/request.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/store'</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 只要有token就在请求中携带，便于请求需要权限的接口</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">token</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">store</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">token</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">token</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">headers</span><span style="color: #D4D4D4">[</span><span style="color: #CE9178">'Access-Token'</span><span style="color: #D4D4D4">] = </span><span style="color: #9CDCFE">token</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">headers</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">platform</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'h5'</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">config</span></span></code></pre></div></div></figure><p>修改购物车渲染代码进行购物车内数量角标展示 <code>views/productdetail/index.vue</code></p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"icon-cart"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">     &lt;van-icon :badge="cartTotal || ''" name="shopping-cart-o" /&gt;</span></span><span class="line"><span style="color: #D4D4D4">     &lt;span&gt;购物车&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">   </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>导入并将商品规格赋值给 data 数据</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">addCart</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/cart'</span></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取商品详情-说明部分</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">goodsId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detailId</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getGoodsDetail</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(res)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsDetailObj</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detail</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(this.goodsDetailObj)</span></span><span class="line"><span style="color: #D4D4D4">  </span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsDetailObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">skuList</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">].</span><span style="color: #9CDCFE">goods_sku_id</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 得到商品规格id</span></span><span class="line"><span style="color: #D4D4D4">  </span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">images</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsDetailObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_images</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 得到商品轮播图</span></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>提供 data 数据来接收必要信息</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">addCount</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 加入购物车的商品数量</span></span><span class="line"><span style="color: #C8C8C8">goodsSkuId</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 商品规格id</span></span><span class="line"><span style="color: #C8C8C8">cartTotal</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 购物车内商品总数</span></span></code></pre></div></div></figure><p>编写请求代码</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 加入购物车判断登录状态</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">addCart</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      ...</span></span><span class="line"><span style="color: #D4D4D4">      </span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 说明有token，可以直接加入购物车</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">data</span><span style="color: #D4D4D4"> } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">addCart</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detailId</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addCount</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartTotal</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartTotal</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">$toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'加入购物车成功！'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">showPannel</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 关闭弹层</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><h2 id="购物车页面"><a class="markdownIt-Anchor" href="#购物车页面"></a> 购物车页面</h2><p>需求分析：</p><ol><li>基本静态结构 (快速实现）</li><li>构建 vuexcart 模块，获取数据存储</li><li>基于数据居动态渲染购物车列表</li><li>封装 getters 实现动态统计</li><li>全选反选功能</li><li>数字框修改数量功能</li><li>编辑切换状态，删除功能</li><li>空购物车处理</li></ol><h3 id="静态页面"><a class="markdownIt-Anchor" href="#静态页面"></a> 静态页面</h3><p>修改 <code>layout/cart.vue</code></p><p>使用到了 vant 的 Checkbox, CheckboxGroup 组件</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">Checkbox</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">CheckboxGroup</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vant'</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">Checkbox</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">Vue</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">CheckboxGroup</span><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><p>静态页面如下：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cart"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"购物车"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 购物车开头 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cart-title"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"all"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">共</span><span style="color: #808080">&lt;</span><span style="color: #569CD6">i</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">4</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">i</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">件商品</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"edit"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"edit"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        编辑</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 购物车列表 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cart-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cart-item"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-checkbox</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">van-checkbox</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"show"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"http://cba.itlike.com/public/uploads/10001/20230321/a072ef0eef1648a5c4eae81fad1b7583.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tit text-ellipsis-2"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">新Pad 14英寸 12+128 远峰蓝 M6平板电脑 智能安卓娱乐十核游戏学习二合一 低蓝光护眼超清4K全面三星屏5GWIFI全网通 蓝魔快本平板</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"bottom"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"price"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">¥ </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">1247.04</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"count-box"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"minus"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">-</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"inp"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">readonly</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"add"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">+</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"footer-fixed"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"all-check"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-checkbox</span><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">icon-size</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"18"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">van-checkbox</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        全选</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"all-total"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"price"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">合计：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">¥ </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">i</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"totalPrice"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">99.99</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">i</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goPay"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">结算(5)</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"delete"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">删除</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'CartPage'</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #6A9955">// 主题 padding</span></span><span class="line"><span style="color: #D7BA7D">.cart</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f5f5f5</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">min-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100vh</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.cart-title</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.all</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">i</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-style</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">normal</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">2px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.edit</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.van-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">18px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.cart-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#ffffff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.show</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.info</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">210px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">flex-direction</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">column</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.bottom</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #D7BA7D">.price</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex-end</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #D7BA7D">span</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #D7BA7D">.count-box</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">110px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #D7BA7D">.add</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #D7BA7D">.minus</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">outline</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #D7BA7D">.inp</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">outline</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.footer-fixed</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">fixed</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">left</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#ccc</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.all-check</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.van-checkbox</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.all-total</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.price</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.totalPrice</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">18px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">font-style</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">normal</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.goPay</span><span style="color: #D4D4D4">, </span><span style="color: #D7BA7D">.delete</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">min-width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">36px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2f21</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">18px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">&amp;.disabled</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#ff9779</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h3 id="构建vuex-cart模块"><a class="markdownIt-Anchor" href="#构建vuex-cart模块"></a> 构建 vuex cart 模块</h3><p>新建子模块 cart：<code>@/store/modules/cart</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getCartList</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/cart'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">namespaced:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">state</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 提供一个数组用于存储购物车列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">cartList:</span><span style="color: #D4D4D4"> []</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">mutations:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 提供方法可以设置购物车列表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setCartList</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">newCartList</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">newCartList</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">actions:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 异步获取购物车列表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCartAction</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">data</span><span style="color: #D4D4D4"> } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCartList</span><span style="color: #D4D4D4">()</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 由于后台返回数据中不包括是否选中的状态，所以本地自己维护，给每一项添加上被选中的状态</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">element</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">element</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">true</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'setCartList'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">getters:</span><span style="color: #D4D4D4"> {}</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>到 vuex 中挂载：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Cart</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/store/modules/cart'</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C8C8C8">modules</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">User</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">Cart</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><p>购物车页面中使用 created 调用 actions 异步</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 判断是否登录</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">token</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取购物车数据</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart/getCartAction'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><h3 id="动态渲染"><a class="markdownIt-Anchor" href="#动态渲染"></a> 动态渲染</h3><p>接口地址：/cart/list</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202408311201545.png" alt="image-20240831120141410"></p><p>使用辅助函数映射数组：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">mapState</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vuex'</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C8C8C8">computed</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapState</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'cartList'</span><span style="color: #D4D4D4">])</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span></code></pre></div></div></figure><p>将 template 中对应的地方进行改造：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cart-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;div class="cart-item" v-for="item in cartList" :key="item.goods_id"&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;van-checkbox :value="item.isChecked"&gt;&lt;/van-checkbox&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="show"&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;img :src="item.goods.goods_image" alt=""&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;span class="tit text-ellipsis-2"&gt;{{ item.goods.goods_name }}&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;span class="bottom"&gt;</span></span><span class="line"><span style="color: #D4D4D4">            &lt;div class="price"&gt;¥ &lt;span&gt;{{ item.goods.goods_price_min }}&lt;/span&gt;</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">CountBox</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">CountBox</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">      &lt;/div&gt;</span></span><span class="line"><span style="color: #D4D4D4">    &lt;/div&gt;</span></span></code></pre></div></div></figure><p>但未完成其他功能按钮等事件。</p><h3 id="封装getters实现动态统计"><a class="markdownIt-Anchor" href="#封装getters实现动态统计"></a> 封装 getters 实现动态统计</h3><ul><li>合计商品数量</li></ul><p>合计商品数量使用到 getters</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">getters</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 求所有的商品累加总数</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">countCartTotal</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reduce</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p><a href="https://segmentfault.com/a/1190000044748736">reduce 函数的 20 个高级用法</a></p><ul><li>合计价格</li><li>结算</li></ul><p>最终完整结果：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">getters</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 求所有的商品累加总数</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">countCartTotal</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reduce</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 选中的商品项目</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">selectedCartList</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// filter只会接收回调结果为true的元素，所以可以不用做其他判断</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">filter</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 选中的商品项目数量</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">selectedCartCount</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">) { </span><span style="color: #6A9955">// 这里的getters可以获取到上面定义的getters</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Array</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">isArray</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">) ? </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reduce</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) : </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 选中的商品总价</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">selectedPrice</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// toFixed(2) 保留两位小数</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Array</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">isArray</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">) ? </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reduce</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4"> * </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_price_min</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">toFixed</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">) : </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><p>修改购物车页面的相关 template</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"all"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">共&lt;i&gt;{{ countCartTotal }}&lt;/i&gt;件商品</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"all-total"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;div class="price"&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;span&gt;合计：&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">          &lt;span&gt;¥ &lt;i class="totalPrice"&gt;{{selectedPrice}}&lt;/i&gt;&lt;/span&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goPay"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">{</span><span style="color: #C8C8C8">disabled</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">selectedCartCount</span><span style="color: #D4D4D4"> === </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">结算({{selectedCartCount}})</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"delete"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">{</span><span style="color: #C8C8C8">disabled</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">selectedCartCount</span><span style="color: #D4D4D4"> === </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">删除</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h3 id="全选反选"><a class="markdownIt-Anchor" href="#全选反选"></a> 全选反选</h3><p>提供 mutations 便于修改 state</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"><span style="color: #D4D4D4">  </span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">toggleChecked</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 遍历购物车列表，找到对应id的商品，修改其选中状态</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4"> = !</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    })</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">allToggle</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">flag</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 遍历购物车列表，修改所有商品的选中状态</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">flag</span></span><span class="line"><span style="color: #D4D4D4">    })</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><p>给全选和商品选择框注册点击事件：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-checkbox</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #DCDCAA">toggleChecked</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">van-checkbox</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"all-check"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        &lt;van-checkbox @click="allToggle" :value="isAllChecked" icon-size="18"&gt;&lt;/van-checkbox&gt;</span></span><span class="line"><span style="color: #D4D4D4">        全选</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">methods: {</span></span><span class="line"><span style="color: #D4D4D4">    toggleChecked (goodsId) {</span></span><span class="line"><span style="color: #D4D4D4">      this.$store.commit('Cart/toggleChecked', goodsId)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    allToggle () {</span></span><span class="line"><span style="color: #D4D4D4">      this.$store.commit('Cart/allToggle', !this.isAllChecked)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span></code></pre></div></div></figure><p>辅助函数导入 isAllChecked</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">...</span><span style="color: #DCDCAA">mapGetters</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'countCartTotal'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'selectedCartList'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'selectedCartCount'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'selectedPrice'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'isAllChecked'</span><span style="color: #D4D4D4">])</span></span></code></pre></div></div></figure><h3 id="数字框修改数量功能"><a class="markdownIt-Anchor" href="#数字框修改数量功能"></a> 数字框修改数量功能</h3><p>提供更新购物车的接口模块：<code>api/cart.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 更新购物车商品</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">updateCart</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">goodsId</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsNum</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsSkuId</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">obj</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/cart/update'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">goodsNum</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">goodsSkuId</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>在 vuex 的 cart 子模块导入使用</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getCartList</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">updateCart</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/cart'</span></span></code></pre></div></div></figure><p>cart 子模块增加修改商品数量的 mutations 方法</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">changeCount</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 遍历购物车列表，找到对应id的商品，修改其数量</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">goodsId</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsNum</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsSkuId</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">obj</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_sku_id</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">goodsNum</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><p>cart 子模块增加同步购物车到后台的 actions 方法</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 将本地购物车列表同步到服务器（结算时优先调用）</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">syncCartAction</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 接口只接受三个参数：goodsId、goodsNum、goodsSkuId，所以需要遍历本地购物车列表，将选中的商品拆分为三个参数</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">paramsObj</span><span style="color: #D4D4D4"> = {}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsNum</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_sku_id</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #DCDCAA">updateCart</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 打印console提示，显示本地提交同步的参数对象</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><p>给数量框组件添加绑定事件</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">CountBox</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">input</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #DCDCAA">changeCount</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">$event</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_sku_id</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">value</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">CountBox</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>给结算按钮添加绑定事件</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goPay"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">goPay</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">{</span><span style="color: #C8C8C8">disabled</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">selectedCartCount</span><span style="color: #D4D4D4"> === </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">结算({{selectedCartCount}})</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>methods 中提供相对应的方法</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">changeCount</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">obj</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsId:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsNum:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsSkuId:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">goodsSkuId</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart/changeCount'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">goPay</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 先触发购物车与后台数据的同步</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart/syncCartAction'</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 触发真正的结算</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><p>真正的结算待做。</p><h3 id="编辑切换状态删除功能"><a class="markdownIt-Anchor" href="#编辑切换状态删除功能"></a> 编辑切换状态，删除功能</h3><p>点击编辑按钮，结算按钮变为删除按钮。</p><p>给购物车页面提供一个数据用于标识是否处于编辑状态</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">isEdit:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">},</span></span></code></pre></div></div></figure><p>并监视其状态</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">watch</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">isEdit</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">val</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">val</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 说明进入编辑状态</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart/allToggle'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 说明退出编辑状态</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart/allToggle'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>相对应的对 template 中结算按钮和编辑按钮进行修改</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"edit"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">isEdit</span><span style="color: #D4D4D4"> = !</span><span style="color: #9CDCFE">isEdit</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  &lt;van-icon name="edit" /&gt;</span></span><span class="line"><span style="color: #D4D4D4">  编辑</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #D4D4D4">/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">&lt;div v-if="!isEdit" class="goPay" @click="goPay" :class="{disabled: selectedCartCount === 0}"&gt;结算({{selectedCartCount}})</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>删除功能待做。</p><h3 id="删除商品"><a class="markdownIt-Anchor" href="#删除商品"></a> 删除商品</h3><p>封装接口模块 <code>api/cart.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 删除购物车商品</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">deleteSelected</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">cartIds</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> { </span><span style="color: #6A9955">// cartIds: 要删除的商品id数组</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/cart/clear'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">cartIds</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>vuex 子模块 Cart 提供异步方法</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// 删除选中的商品</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">delSelCartA</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 获取选中的商品id然后进行删除</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">ids</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">map</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(ids)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">deleteSelected</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">ids</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'删除成功'</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 删除后重新拉取购物车数据</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'getCartAction'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span></code></pre></div></div></figure><p>接着修复了一些小 bug：商品详情页初始不显示购物车数量、添加到购物车之后数量不会自动更新、购物车页面编辑状态退出后按钮未恢复到结算按钮。下面是修复后的 <code>store/modules/cart.js</code> 和 <code>views/productdetail.vue</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getCartList</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">updateCart</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">deleteSelected</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">addCart</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/cart'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vant'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">namespaced:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">state</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 提供一个数组用于存储购物车列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">cartList:</span><span style="color: #D4D4D4"> []</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">mutations:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 提供方法可以设置购物车列表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setCartList</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">newCartList</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">newCartList</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 修改商品选中状态</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">toggleChecked</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 遍历购物车列表，找到对应id的商品，修改其选中状态</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4"> = !</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 全选和反选</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">allToggle</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">flag</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 遍历购物车列表，修改所有商品的选中状态</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">flag</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 改变商品数量</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">changeCount</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 遍历购物车列表，找到对应id的商品，修改其数量</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">goodsId</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsNum</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsSkuId</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">obj</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_sku_id</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">goodsNum</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">actions:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 添加商品到购物车</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">addCartAction</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 先判断是否已经存在该商品，如果存在，则只修改商品数量</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">goodsId</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsNum</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">goodsSkuId</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">obj</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_sku_id</span><span style="color: #D4D4D4"> === </span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4"> += </span><span style="color: #9CDCFE">goodsNum</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 如果不存在，则添加到购物车列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">addCart</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">goodsNum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'getCartAction'</span><span style="color: #D4D4D4">) </span><span style="color: #6A9955">// 重新拉取购物车信息</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'添加成功'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 异步获取购物车列表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCartAction</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">data</span><span style="color: #D4D4D4"> } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCartList</span><span style="color: #D4D4D4">()</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 由于后台返回数据中不包括是否选中的状态，所以本地自己维护，给每一项添加上被选中的状态</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">element</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">element</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">true</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'setCartList'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 将本地购物车列表同步到服务器（结算或者离开购物车页面立刻同步）</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">syncCartAction</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 接口只接受三个参数：goodsId、goodsNum、goodsSkuId，所以需要遍历本地购物车列表，将选中的商品拆分为三个参数</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">paramsObj</span><span style="color: #D4D4D4"> = {}</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsId</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_id</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsNum</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsSkuId</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_sku_id</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #DCDCAA">updateCart</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">paramsObj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      })</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(paramsObj)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 删除选中的商品</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">delSelCartA</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 获取选中的商品id然后进行删除</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">ids</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">map</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(ids)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">deleteSelected</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">ids</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'删除成功'</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 删除后重新拉取购物车数据</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'getCartAction'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">getters:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 求所有的商品累加总数</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">countCartTotal</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reduce</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 选中的商品项目</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">selectedCartList</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// filter只会接收回调结果为true的元素，所以可以不用做其他判断</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">filter</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 选中的商品项目数量</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">selectedCartCount</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">) { </span><span style="color: #6A9955">// 这里的getters可以获取到上面定义的getters</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Array</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">isArray</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">) ? </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reduce</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) : </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 选中的商品总价</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">selectedPrice</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// toFixed(2) 保留两位小数</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Array</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">isArray</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">) ? </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">selectedCartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reduce</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">index</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sum</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4"> * </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_price_min</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">toFixed</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">) : </span><span style="color: #B5CEA8">0</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 是否全选</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">isAllChecked</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// every返回true，说明数组中每一项都为true，否则为false</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">every</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isChecked</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>商品详情页增加：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">mapGetters</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mapActions</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vuex'</span><span style="color: #D4D4D4">  </span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"><span style="color: #C8C8C8">computed</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapGetters</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'countCartTotal'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapActions</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'getCartAction'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">detailId</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">params</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">    </span></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">match</span><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 此为created内</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">while</span><span style="color: #D4D4D4"> ((</span><span style="color: #9CDCFE">match</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">regex</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">exec</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">htmlString</span><span style="color: #D4D4D4">)) !== </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">srcArray</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">match</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">]) </span><span style="color: #6A9955">// 将匹配到的 src URL 添加到数组中</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">imgSrcArray</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">srcArray</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(this.imgSrcArray) // 输出结果数组</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 异步获取购物车列表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getCartAction</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取购物车商品总数</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartTotal</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">countCartTotal</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log(this.cartTotal)</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 说明有token，可以直接加入购物车</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">obj</span><span style="color: #D4D4D4"> = { </span><span style="color: #6A9955">// 此为添加到购物车的点击事件</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsId:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detailId</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsNum:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addCount</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">goodsSkuId:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goodsSkuId</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart/addCartAction'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">obj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 获取购物车商品总数</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartTotal</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">countCartTotal</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">$toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'加入购物车成功！'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">showPannel</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 关闭弹层</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C8C8C8">watch</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 监听 countCartTotal 的变化，自动更新 cartTotal</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">countCartTotal</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">newVal</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartTotal</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">newVal</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span></code></pre></div></div></figure><h3 id="空购物车处理"><a class="markdownIt-Anchor" href="#空购物车处理"></a> 空购物车处理</h3><p>将除标题以外的盒子用大盒子包裹起来：</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cart"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"购物车"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 判断登录，且购物车列表不为空才渲染 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">isLogin</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4"> &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    ...  </span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 未登录或购物车列表为空时渲染提示页面 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-empty</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">description</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"空空如也，快去逛逛吧~"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">round</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"danger"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"bottom-button"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/home'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">去逛逛</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-empty</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>并提供计算属性</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">isLogin</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">token</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>并引入对应 Empty 组件的 css 样式</p><figure class="shiki css"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D7BA7D">.bottom-button</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">160px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">40px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h2 id="地址管理"><a class="markdownIt-Anchor" href="#地址管理"></a> 地址管理</h2><blockquote><p>地址选择里面涉及到一个地区选择器，可以自行定义数据也可以使用官方的数据。可以参考：Vant 使用 <a href="https://blog.csdn.net/qq_51055690/article/details/126281265">Vant Area Data</a></p></blockquote><h3 id="配置"><a class="markdownIt-Anchor" href="#配置"></a> 配置</h3><p>封装 api 接口：<code>api/address.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/utils/request'</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 获取地址列表</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getAddressList</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/list'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 获取某个地址的详情</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getAddressDetail</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/detail'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">params:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">addressId:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">addressId</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 添加收货地址</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">addAddress</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// console.log('api_dataObj', dataObj)</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 直接使用dataObj中的数据</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/add'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">form:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">phone:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">phone</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">region:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">region</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">detail:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detail</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 更新收货地址</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">updateAddress</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 直接使用dataObj中的数据</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/edit'</span><span style="color: #D4D4D4">, {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">addressId:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">address_id</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">form:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">form</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 设置默认地址</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setDefaultAddress</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/setDefault'</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 删除收货地址</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">deleteAddress</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">post</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/remove'</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>Vuex 子模块：<code>store/modules/address.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">getAddressList</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">updateAddress</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">deleteAddress</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">getAddressDetail</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">addAddress</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">setDefaultAddress</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/address'</span></span><span class="line"><span style="color: #6A9955">// import {Toast} from 'vant'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">namespaced:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">state</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">AddressList:</span><span style="color: #D4D4D4"> [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 初始化时从 localStorage 中获取默认地址 ID</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">defaultAddressId:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">localStorage</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getItem</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'defaultAddressId'</span><span style="color: #D4D4D4">) || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">mutations:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 编辑地址</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">editAddress</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">newAddress</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">AddressList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">newAddress</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 更新默认地址的 ID 并保存到 localStorage</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">setDefaultAddressId</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">addressId</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">localStorage</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">setItem</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'defaultAddressId'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) </span><span style="color: #6A9955">// 保存到 localStorage</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">actions:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取地址列表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getAddressList</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">data</span><span style="color: #D4D4D4"> } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getAddressList</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取某个地址的详情</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getAddressDetail</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (!</span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">throw</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Error</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address ID is required'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log('getAddressDetail被调用，addressId：', addressId)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">data</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getAddressDetail</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log('getAddressDetail返回的数据：', data)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">data</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 添加地址</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">addAddress</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'vuex_dataObj:'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">res</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">addAddress</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">status</span><span style="color: #D4D4D4"> === </span><span style="color: #B5CEA8">200</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 成功后，重新通过上面的actions方法拉取地址列表</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'getAddressList'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 设置默认地址(无用的接口，设置后拉取列表，其中不包含默认地址是否设置的状态)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setDefaultAddress</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 发送请求</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setDefaultAddress</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 成功后，重新拉取地址列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">getAddressList</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 更新地址</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">updateAddress</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 发送更新请求</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">updateAddress</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 更新之后，重新拉取地址列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">getAddressList</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 删除地址</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">deleteAddress</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">context</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 发送删除请求</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">deleteAddress</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">addressId</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 删除成功后，重新拉取地址列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">getAddressList</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">getters:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取默认地址 ID（优先从 Vuex 中获取，否则从 localStorage 中获取）</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">getDefaultAddressId</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4"> || </span><span style="color: #9CDCFE">localStorage</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getItem</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'defaultAddressId'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>Vuex 子模块 addressMap 处理引入的 vant 官方地区数据：<code>store/modules/addressMap.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@vant/area-data'</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">state</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 代码到名称的映射</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">codeToNameMap:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">provinceMap:</span><span style="color: #D4D4D4"> {},</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">cityMap:</span><span style="color: #D4D4D4"> {},</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">countyMap:</span><span style="color: #D4D4D4"> {}</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 名称到代码的映射</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">nameToCodeMap:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">provinceMap:</span><span style="color: #D4D4D4"> {},</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">cityMap:</span><span style="color: #D4D4D4"> {},</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">countyMap:</span><span style="color: #D4D4D4"> {}</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">getters</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 根据名称获取代码</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">nameToCode</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">nameToCodeMap</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">provinceMap</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">] ||</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">nameToCodeMap</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cityMap</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">] ||</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">nameToCodeMap</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">countyMap</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">] ||</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">null</span></span><span class="line"><span style="color: #D4D4D4">    )</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 根据代码获取名称</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">codeToName</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> (</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">codeToNameMap</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">provinceMap</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">] ||</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">codeToNameMap</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cityMap</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">] ||</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">codeToNameMap</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">countyMap</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">] ||</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">null</span></span><span class="line"><span style="color: #D4D4D4">    )</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">mutations</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">SET_CODE_TO_NAME_MAP</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">map</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4"> }) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">codeToNameMap</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">] = </span><span style="color: #9CDCFE">map</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">SET_NAME_TO_CODE_MAP</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">map</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4"> }) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">nameToCodeMap</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">] = </span><span style="color: #9CDCFE">map</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">actions</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 构建映射表</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">buildReverseMaps</span><span style="color: #D4D4D4"> ({ </span><span style="color: #9CDCFE">commit</span><span style="color: #D4D4D4"> }) {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">provinceCodeToNameMap</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">buildCodeToNameMap</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province_list</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">cityCodeToNameMap</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">buildCodeToNameMap</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city_list</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">countyCodeToNameMap</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">buildCodeToNameMap</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county_list</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">provinceNameToCodeMap</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">buildNameToCodeMap</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province_list</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">cityNameToCodeMap</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">buildNameToCodeMap</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city_list</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">countyNameToCodeMap</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">buildNameToCodeMap</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county_list</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SET_CODE_TO_NAME_MAP'</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">map:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">provinceCodeToNameMap</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'provinceMap'</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SET_CODE_TO_NAME_MAP'</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">map:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">cityCodeToNameMap</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'cityMap'</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SET_CODE_TO_NAME_MAP'</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">map:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">countyCodeToNameMap</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'countyMap'</span><span style="color: #D4D4D4"> })</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SET_NAME_TO_CODE_MAP'</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">map:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">provinceNameToCodeMap</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'provinceMap'</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SET_NAME_TO_CODE_MAP'</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">map:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">cityNameToCodeMap</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'cityMap'</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'SET_NAME_TO_CODE_MAP'</span><span style="color: #D4D4D4">, { </span><span style="color: #9CDCFE">map:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">countyNameToCodeMap</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">type:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'countyMap'</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 构建代码到名称的映射</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">buildCodeToNameMap</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">map</span><span style="color: #D4D4D4"> = {}</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">Object</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">keys</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">map</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">] = </span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">] </span><span style="color: #6A9955">// 代码作为键，名称作为值</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">map</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 构建名称到代码的映射</span></span><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">buildNameToCodeMap</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">map</span><span style="color: #D4D4D4"> = {}</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">Object</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">keys</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">forEach</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">map</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4">]] = </span><span style="color: #9CDCFE">code</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 名称作为键，代码作为值</span></span><span class="line"><span style="color: #D4D4D4">  })</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">map</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">namespaced:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">getters</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">mutations</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">actions</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>配置路由并新增守卫规则：<code>router/index.js</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Address</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/views/address/index.vue'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">AddressEdit</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/views/address/edit.vue'</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  { </span><span style="color: #C8C8C8">path</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/address/manage'</span><span style="color: #D4D4D4">, </span><span style="color: #C8C8C8">component</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">Address</span><span style="color: #D4D4D4"> },</span></span><span class="line"><span style="color: #D4D4D4">  { </span><span style="color: #C8C8C8">path</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/address/edit'</span><span style="color: #D4D4D4">, </span><span style="color: #C8C8C8">component</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">AddressEdit</span><span style="color: #D4D4D4"> },</span></span><span class="line"><span style="color: #D4D4D4">  </span></span><span class="line"><span style="color: #D4D4D4">...</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 定义数组存储需要登录才能访问的路由</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">authNeedRouters</span><span style="color: #D4D4D4"> = [</span><span style="color: #CE9178">'/myorder'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'/pay'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'/address'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'/address/edit'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'/address/manage'</span><span style="color: #D4D4D4">]</span></span></code></pre></div></div></figure><h3 id="地址列表"><a class="markdownIt-Anchor" href="#地址列表"></a> 地址列表</h3><p>地址列表代码：<code>views/address/index.vue</code></p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"address-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"地址列表"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4"> &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">&lt;!-- 用于区分的文字 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"address-list-header"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"header-text"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">请选择或管理收货地址</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">&lt;!-- 地址列表 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-address-list</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">v-model</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">chosenAddressId</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">switchable</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">disabled-list</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">disabledList</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">disabled-text</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">disabledText</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">default-tag-text</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"默认"</span></span><span class="line"><span style="color: #D4D4D4">        @</span><span style="color: #9CDCFE">add</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">onAdd</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        @</span><span style="color: #9CDCFE">edit</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">onEdit</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-empty</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">description</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"空空如也"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-button</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">round</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"danger"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"bottom-button"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">onAdd</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">添加地址</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">van-empty</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vant'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">mapActions</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mapGetters</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vuex'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'AddressList'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 默认选中的地址id</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">chosenAddressId:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 地址列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">list:</span><span style="color: #D4D4D4"> [],</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 禁用状态的地址列表（超出快递范围）</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">disabledList:</span><span style="color: #D4D4D4"> []</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">computed:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapGetters</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'AddressMap'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'codeToName'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapGetters</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'getDefaultAddressId'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">disabledText</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">disabledList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4"> &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #CE9178">'以下地址超出配送范围'</span><span style="color: #D4D4D4"> : </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">try</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 构建地区映射表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">buildReverseMaps</span><span style="color: #D4D4D4">()</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 获取地址列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">response</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getAddressList</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log('获取地址列表成功：', response)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">addressData</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4"> || []</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log('地址数据：', addressData)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 格式化地址列表数据</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">addressData</span></span><span class="line"><span style="color: #D4D4D4">        .</span><span style="color: #DCDCAA">filter</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> !</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">is_disabled</span><span style="color: #D4D4D4">) </span><span style="color: #6A9955">// 过滤掉禁用的地址</span></span><span class="line"><span style="color: #D4D4D4">        .</span><span style="color: #DCDCAA">map</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> ({</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">id:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">address_id</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">tel:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">phone</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">address:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">formatAddress</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">),</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">isDefault:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">is_default</span><span style="color: #D4D4D4"> || </span><span style="color: #569CD6">false</span></span><span class="line"><span style="color: #D4D4D4">        }))</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 从Vuex中获取默认地址的id</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">defaultAddressId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getDefaultAddressId</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'默认地址id：'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">) !== -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 遍历比对列表每一项的id是否与defaultAddressId相等，找到后返回索引（强等于比较，注意类型）</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">defaultIndex</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">findIndex</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">) === </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">))</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">defaultIndex</span><span style="color: #D4D4D4">) !== -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// 找到后设置为默认地址</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">defaultIndex</span><span style="color: #D4D4D4">].</span><span style="color: #9CDCFE">isDefault</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">true</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddressId</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// Vuex没有默认地址，则默认选中第一个地址</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'小主还没有默认地址哦</span><span style="color: #D7BA7D">\n</span><span style="color: #CE9178">快来设置一个吧❤️'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'未找到有效的默认地址'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddressId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">].</span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4"> || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 设置禁用的地址列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">disabledList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">addressData</span></span><span class="line"><span style="color: #D4D4D4">        .</span><span style="color: #DCDCAA">filter</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">is_disabled</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        .</span><span style="color: #DCDCAA">map</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> ({</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">id:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">address_id</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">tel:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">phone</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">address:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">formatAddress</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">),</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">isDefault:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">is_default</span><span style="color: #D4D4D4"> || </span><span style="color: #569CD6">false</span></span><span class="line"><span style="color: #D4D4D4">        }))</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">catch</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.error('获取地址列表失败：', error)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">fail</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'获取地址列表失败'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapActions</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'getAddressList'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapActions</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'AddressMap'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'buildReverseMaps'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 格式化地址：</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">formatAddress</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">provinceName</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">codeToName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province_id</span><span style="color: #D4D4D4">) || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">cityName</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">codeToName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city_id</span><span style="color: #D4D4D4">) || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">countyName</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">codeToName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county_id</span><span style="color: #D4D4D4">) || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">detailAddress</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4"> || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">result</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">`</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">provinceName</span><span style="color: #569CD6">}${</span><span style="color: #9CDCFE">cityName</span><span style="color: #569CD6">}${</span><span style="color: #9CDCFE">countyName</span><span style="color: #569CD6">}${</span><span style="color: #9CDCFE">detailAddress</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log('codeToname：', this.codeToName(item.province_id))</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">result</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">onAdd</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/edit?adsid='</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">onEdit</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log('跳转到编辑：', item)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">`/address/edit?adsid=</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.custom-nav-bar</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#ffffff</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 导航栏背景色</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 设置导航栏的高度</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">box-shadow</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">2px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">rgba</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.1</span><span style="color: #D4D4D4">); </span><span style="color: #6A9955">// 添加阴影效果</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.address-list</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">60px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 增加顶部内边距，以避免内容被导航栏遮挡</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.address-list-header</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f8f8f8</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.header-text</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">left</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">/* 地址列表项样式 */</span></span><span class="line"><span style="color: #D7BA7D">.van-address-list__item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 每一项之间的间距</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 内边距，使内容不贴边</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#ddd</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 边框颜色</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">4px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 圆角边框</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 背景色</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.van-cell__title</span><span style="color: #D4D4D4">, </span><span style="color: #D7BA7D">.van-cell__label</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">white-space</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">normal</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 允许内容换行</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">word-wrap</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">break-word</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 自动换行</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">word-break</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">break-all</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 长单词换行</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">/* 禁用状态的地址项样式 */</span></span><span class="line"><span style="color: #D7BA7D">.van-address-list__item--disabled</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#f5f5f5</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 禁用项的背景色</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#999</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">// 禁用项的文字颜色</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h3 id="地址编辑"><a class="markdownIt-Anchor" href="#地址编辑"></a> 地址编辑</h3><p>地址编辑可以是新建也可以是更新操作：<code>views/address/edit.vue</code></p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">&lt;!-- 可编辑也可以作为添加地址的页面 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"address-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"地址编辑"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"address-edit"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-address-edit</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">address-info</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">area-list</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">show-delete</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">show-set-default</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">adsId</span><span style="color: #D4D4D4"> != -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> ? </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4"> : </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">show-search-result</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">search-result</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">searchResult</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">area-columns-placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">[</span><span style="color: #CE9178">'请选择'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'请选择'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'请选择'</span><span style="color: #D4D4D4">]</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        :</span><span style="color: #9CDCFE">detail-maxlength</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #B5CEA8">20</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        @</span><span style="color: #9CDCFE">save</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">onSave</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        @</span><span style="color: #9CDCFE">delete</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">onDelete</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">        @</span><span style="color: #9CDCFE">change-default</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">onChangeDefault</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">Toast</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vant'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">mapActions</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mapGetters</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vuex'</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@vant/area-data'</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 引入vant官方的地区数据</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'AddressEdit'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">adsId:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 地址id</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">addressInfo:</span><span style="color: #D4D4D4"> {}, </span><span style="color: #6A9955">// 初始地址详情对象，若是新建地址则为空对象</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">areaList:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">areaList</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 地区列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">searchResult:</span><span style="color: #D4D4D4"> [], </span><span style="color: #6A9955">// 详细地址搜索结果</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">checkDefault:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 默认地址的标识，数据内的isDefault会随着设置按钮而改变，此字段标识数据原始状态</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">computed:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapGetters</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'AddressMap'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'nameToCode'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'codeToName'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取要进行编辑的地址id，如果为空则赋值为-1表示为新建地址</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">getAdsId</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">query</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">adsid</span><span style="color: #D4D4D4"> || -</span><span style="color: #B5CEA8">1</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 构建映射表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">buildReverseMaps</span><span style="color: #D4D4D4">()</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取要进行编辑的地址id，如果为空则赋值为-1表示为新建地址</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">adsId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getAdsId</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// console.log('adsId:', this.adsId)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 如果adsId不等于-1，则进行地址详情的拉取</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">adsId</span><span style="color: #D4D4D4"> !== -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 说明是编辑地址，则需要拉取地址详情</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">: { </span><span style="color: #4FC1FF">detail</span><span style="color: #D4D4D4"> } } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getAddressDetail</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">adsId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">id:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">address_id</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">tel:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">phone</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">province:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">codeToName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province_id</span><span style="color: #D4D4D4">) || </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">city:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">codeToName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city_id</span><span style="color: #D4D4D4">) || </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">county:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">codeToName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county_id</span><span style="color: #D4D4D4">) || </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">addressDetail:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">areaCode:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">String</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">region_id</span><span style="color: #D4D4D4">),</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">isDefault:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isDefault</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 从Vuex得到默认地址的id</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">defaultAddressId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">Address</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">defaultAddressId</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 比对当前地址是否为默认地址</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">) === </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">address_id</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'当前地址为默认地址'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isDefault</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 设置默认按钮为打开状态</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">checkDefault</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 为真说明该地址获取的时候就是默认地址</span></span><span class="line"><span style="color: #D4D4D4">      } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 说明当前地址不是默认地址</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'当前地址不是默认地址'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isDefault</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 设置默认按钮为关闭状态</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">checkDefault</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 为假说明该地址获取的时候不是默认地址</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 说明是新建地址，不做操作</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapActions</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'getAddressDetail'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'addAddress'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'updateAddress'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapActions</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'AddressMap'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'buildReverseMaps'</span><span style="color: #D4D4D4">]),</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 保存地址</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">onSave</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 判断是新建地址还是编辑地址</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">adsId</span><span style="color: #D4D4D4"> === -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 新建地址</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">country</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'中国'</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">content</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 使用映射表进行地区数据处理</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">region</span><span style="color: #D4D4D4"> = [</span></span><span class="line"><span style="color: #D4D4D4">          {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">value:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">nameToCode</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province</span><span style="color: #D4D4D4">)) || </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">label:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province</span></span><span class="line"><span style="color: #D4D4D4">          },</span></span><span class="line"><span style="color: #D4D4D4">          {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">value:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">nameToCode</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city</span><span style="color: #D4D4D4">)) || </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">label:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city</span></span><span class="line"><span style="color: #D4D4D4">          },</span></span><span class="line"><span style="color: #D4D4D4">          {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">value:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">nameToCode</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county</span><span style="color: #D4D4D4">)) || </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">label:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">        ]</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 封装数据对象</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">dataObj</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">phone:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">tel</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">region:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">region</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">detail:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressDetail</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 调用接口进行地址的保存</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addAddress</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'保存成功'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">replace</span><span style="color: #D4D4D4">({ </span><span style="color: #9CDCFE">path:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'/address/manage'</span><span style="color: #D4D4D4"> }) </span><span style="color: #6A9955">// 保存成功后返回地址列表页面</span></span><span class="line"><span style="color: #D4D4D4">      } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 编辑地址</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// console.log('编辑地址的content:', content)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">content</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 封装对象，用于发送请求</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">dataObj</span><span style="color: #D4D4D4"> = {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">address_id:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">form:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">phone:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">tel</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">region:</span><span style="color: #D4D4D4"> [</span></span><span class="line"><span style="color: #D4D4D4">              {</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">label:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">value:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">nameToCode</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province</span><span style="color: #D4D4D4">)) || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">              },</span></span><span class="line"><span style="color: #D4D4D4">              {</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">label:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">value:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">nameToCode</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city</span><span style="color: #D4D4D4">)) || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">              },</span></span><span class="line"><span style="color: #D4D4D4">              {</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">label:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE">value:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">nameToCode</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county</span><span style="color: #D4D4D4">)) || </span><span style="color: #CE9178">''</span></span><span class="line"><span style="color: #D4D4D4">              }</span></span><span class="line"><span style="color: #D4D4D4">            ],</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">detail:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressDetail</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// console.log('dataObj:', dataObj)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">updateAddress</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">dataObj</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'保存成功'</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 处理默认地址的标识问题</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">checkDefault</span><span style="color: #D4D4D4">) { </span><span style="color: #6A9955">// 为真说明当前编辑的是默认地址</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'当前是默认地址，content:'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'当前是默认地址，this.adressInfo:'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isDefault</span><span style="color: #D4D4D4"> !== </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">checkDefault</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// 说明用户取消了这个默认地址，需要将Vuex的默认地址id赋值为-1</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address/setDefaultAddressId'</span><span style="color: #D4D4D4">, -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// 否则什么也不做</span></span><span class="line"><span style="color: #D4D4D4">        } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// 说明当前编辑的不是默认地址</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'当前不是默认地址，content:'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'当前不是默认地址，this.adressInfo:'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isDefault</span><span style="color: #D4D4D4"> !== </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">checkDefault</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// 说明用户将当前不是默认地址的地址设置为默认地址</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address/setDefaultAddressId'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// 否则什么也不做</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 处理完成后跳转会地址列表页</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">replace</span><span style="color: #D4D4D4">({ </span><span style="color: #9CDCFE">path:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'/address/manage'</span><span style="color: #D4D4D4"> })</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">onDelete</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 判断是否删除的是默认地址，如果是，则将Vuex的默认地址id赋值为-1</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">checkDefault</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">commit</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address/setDefaultAddressId'</span><span style="color: #D4D4D4">, -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'删除默认地址, Vuex的默认地址id:'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">state</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">Address</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$store</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">dispatch</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address/deleteAddress'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">Toast</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'删除成功'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">setTimeout</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">replace</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/manage'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      }, </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 设置默认地址</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">onChangeDefault</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">val</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// console.log(val)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 只有编辑才可以设置默认地址</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isDefault</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">val</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'设置默认地址的按钮被触发, this.addressInfo.isDefault:'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">isDefault</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.address-list</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">60px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 增加与导航栏等高的内边距，避免内容被导航栏覆盖 */</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.address-edit</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">16px</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 给地址编辑区域增加一些内边距，使内容不贴边 */</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">; </span><span style="color: #6A9955">/* 设置背景色为白色 */</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>导入 vant 组件略过。</p><h2 id="订单结算台"><a class="markdownIt-Anchor" href="#订单结算台"></a> 订单结算台</h2><h3 id="静态结构-2"><a class="markdownIt-Anchor" href="#静态结构-2"></a> 静态结构</h3><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"订单结算台"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 地址相关 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"address"</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left-icon"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"logistics"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info-content"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"name"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">小红</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"mobile"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">13811112222</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info-address"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          江苏省 无锡市 南长街 110号 504</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        请选择配送地址</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right-icon"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"arrow"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 订单明细 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goods-item"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"http://cba.itlike.com/public/uploads/10001/20230321/8f505c6c437fc3d4b4310b57b1567544.jpg"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tit text-ellipsis-2"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">                 三星手机 SAMSUNG Galaxy S23 8GB+256GB 超视觉夜拍系统 超清夜景 悠雾紫 5G手机 游戏拍照旗舰机s23</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"count"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">x3</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"price"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">¥9.99</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"flow-num-box"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">共 12 件商品，合计：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"money"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">￥1219.00</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-detail"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-cell"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">订单总金额：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"red"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">￥1219.00</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-cell"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">优惠券：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">无优惠券可用</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-cell"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">配送费用：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">请先选择配送地址</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"red"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">+￥0.00</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">&lt;!-- 支付方式 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-way"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tit"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">支付方式</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-cell"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"balance-o"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">余额支付（可用 ¥ 999919.00 元）</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">&lt;!-- &lt;span&gt;请先选择配送地址&lt;/span&gt; --&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"red"</span><span style="color: #808080">&gt;&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"passed"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">&lt;!-- 买家留言 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"buytips"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">textarea</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"选填：买家留言（50字内）"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">cols</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"30"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">rows</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"10"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">textarea</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 底部提交 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"footer-fixed"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">实付款：</span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">￥999919</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tipsbtn"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">提交订单</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'PayIndex'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.pay</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.van-nav-bar__arrow</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.address</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex-start</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#666</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">relative</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">url(@</span><span style="color: #CE9178">/assets/border-line.png</span><span style="color: #DCDCAA">)</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">bottom</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">repeat-x</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">60px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.left-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.right-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">absolute</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">translateY</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">-7px</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.goods-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">6px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">80px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.right</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1.3</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex-direction</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">column</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-evenly</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.info</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.price</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.flow-num-box</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex-end</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.money</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.pay-cell</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.red</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.pay-detail</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.pay-way</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.tit</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.pay-cell</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.van-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.buytips</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">textarea</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.footer-fixed</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">fixed</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">left</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding-left</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#666</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">span</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">:</span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.tipsbtn</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">121px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">linear-gradient</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">90deg</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">#f9211c</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">#ff6335</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h3 id="渲染-2"><a class="markdownIt-Anchor" href="#渲染-2"></a> 渲染</h3><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-nav-bar</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">title</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"订单结算台"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">left-arrow</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click-left</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">go</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 地址相关 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"address"</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left-icon"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"logistics"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">addressList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4"> &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info-content"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"name"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">{{ </span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4"> }} </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"mobile"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">{{ </span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">phone</span><span style="color: #D4D4D4"> }}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info-address"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          {{ </span><span style="color: #9CDCFE">regionName</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">province</span><span style="color: #D4D4D4"> }} {{ </span><span style="color: #9CDCFE">regionName</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">city</span><span style="color: #D4D4D4"> }} {{ </span><span style="color: #9CDCFE">regionName</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">county</span><span style="color: #D4D4D4"> }} {{ </span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">detail</span><span style="color: #D4D4D4"> }}</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        还没有地址哦，点击右侧按钮添加吧</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right-icon"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/address/manage'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"arrow"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 订单明细 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"list"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"goods-item"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-for</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">in</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_image</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"right"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tit text-ellipsis-2"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">                 {{ </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_name</span><span style="color: #D4D4D4"> }}</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">p</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"info"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"count"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">共{{ </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4"> }}件</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">                </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"price"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">¥{{</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_price_min</span><span style="color: #D4D4D4"> * </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">goods_num</span><span style="color: #D4D4D4">}}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">              </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">p</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"flow-num-box"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">共 {{</span><span style="color: #DCDCAA">selectedCartCount</span><span style="color: #D4D4D4">()}} 件商品，合计：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"money"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">￥{{</span><span style="color: #DCDCAA">selectedPrice</span><span style="color: #D4D4D4">()}}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-detail"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-cell"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">订单总金额：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"red"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">￥{{</span><span style="color: #DCDCAA">selectedPrice</span><span style="color: #D4D4D4">()}}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-cell"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">优惠券：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">无优惠券可用</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-cell"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">配送费用：</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">请先选择配送地址</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"red"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">+￥0.00</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">&lt;!-- 支付方式 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-way"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tit"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">支付方式</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"pay-cell"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"balance-o"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">余额支付（可用 ¥ 999919.00 元）</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">&lt;!-- &lt;span&gt;请先选择配送地址&lt;/span&gt; --&gt;</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"red"</span><span style="color: #808080">&gt;&lt;</span><span style="color: #569CD6">van-icon</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"passed"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">&lt;!-- 买家留言 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"buytips"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">textarea</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">placeholder</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"选填：买家留言（50字内）"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">id</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">""</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">cols</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"30"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">rows</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"10"</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">textarea</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">&lt;!-- 底部提交 --&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"footer-fixed"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"left"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">实付款：</span><span style="color: #808080">&lt;</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">￥{{</span><span style="color: #DCDCAA">selectedPrice</span><span style="color: #D4D4D4">()}}</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">span</span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"tipsbtn"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">$router</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'/order/confirm'</span><span style="color: #D4D4D4">)</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">提交订单</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">mapActions</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mapGetters</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vuex'</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'PayIndex'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">created</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 构建地区映射表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">buildReverseMaps</span><span style="color: #D4D4D4">()</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 处理购物车详情展示</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 拉取购物车列表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getCartAction</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">selectedCartList</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'购物车列表：'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cartList</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 获取地址列表</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">list</span><span style="color: #D4D4D4"> } = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getAddressList</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">list</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'地址列表：'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressList</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 从Vuex中获取默认地址的id</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">defaultAddressId</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getDefaultAddressId</span><span style="color: #D4D4D4">()</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'默认地址id：'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">)</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressList</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4"> &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 如果有地址查询参数?adsid，则说明进行了地址切换</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'地址切换参数：'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getadsid</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getadsid</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// chosenAddress被赋值为切换的id的地址</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">address</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">find</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">String</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">address_id</span><span style="color: #D4D4D4">) === </span><span style="color: #DCDCAA">String</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">getadsid</span><span style="color: #D4D4D4">))</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">address</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'切换后的地址：'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">      } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 如果没有地址切换参数，则说明没有切换地址</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">) !== -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// 遍历比对列表每一项的id是否与defaultAddressId相等，找到后返回索引（强等于比较，注意类型）</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">defaultIndex</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">findIndex</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">String</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">address_id</span><span style="color: #D4D4D4">) === </span><span style="color: #DCDCAA">String</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">defaultAddressId</span><span style="color: #D4D4D4">))</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// console.log('默认地址索引：', defaultIndex)</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">Number</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">defaultIndex</span><span style="color: #D4D4D4">) !== -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// 找到后将数组数据转对象赋值给chosenAddress属性</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressList</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">defaultIndex</span><span style="color: #D4D4D4">]</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// 处理地址Code转为Name</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">regionId</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">String</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">region_id</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// 调用 getFullAddressInfo 方法</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">regionName</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">fetchFullAddressName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">regionId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'未找到有效的默认地址索引'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">        } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// Vuex没有默认地址，则默认选中第一个地址</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// 设置chosenAddress属性为addressList的第一个地址</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">addressList</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">]</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">regionId</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">String</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">region_id</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">regionName</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">fetchFullAddressName</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">regionId</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'无默认地址，展示数据chosenAddress：'</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">chosenAddress</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">addressList:</span><span style="color: #D4D4D4"> [], </span><span style="color: #6A9955">// 地址列表</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">chosenAddress:</span><span style="color: #D4D4D4"> {}, </span><span style="color: #6A9955">// 被选择进行展示的地址</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">regionName:</span><span style="color: #D4D4D4"> {}, </span><span style="color: #6A9955">// 将地址Code转为Name</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">cartList:</span><span style="color: #D4D4D4"> [] </span><span style="color: #6A9955">// 购物车列表</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">computed:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">getadsid</span><span style="color: #D4D4D4"> () {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$route</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">query</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">adsid</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapActions</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'getAddressList'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'getAddressDetail'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapGetters</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Address'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'getDefaultAddressId'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapActions</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'AddressMap'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'buildReverseMaps'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'fetchFullAddressName'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapActions</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'getCartAction'</span><span style="color: #D4D4D4">]),</span></span><span class="line"><span style="color: #D4D4D4">    ...</span><span style="color: #DCDCAA">mapGetters</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Cart'</span><span style="color: #D4D4D4">, [</span><span style="color: #CE9178">'selectedCartList'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'selectedCartCount'</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">'selectedPrice'</span><span style="color: #D4D4D4">])</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">lang</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"less"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scoped</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.pay</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  ::</span><span style="color: #569CD6">v-deep</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.van-nav-bar__arrow</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.address</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex-start</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#666</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">relative</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">url(@</span><span style="color: #CE9178">/assets/border-line.png</span><span style="color: #DCDCAA">)</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">bottom</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">repeat-x</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">60px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.left-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.right-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">absolute</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">translateY</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">-7px</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.goods-item</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">6px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">img</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">80px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">auto</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.right</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1.3</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex-direction</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">column</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-evenly</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">.info</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">margin-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #D7BA7D">.price</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.flow-num-box</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex-end</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.money</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.pay-cell</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">justify-content</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">space-between</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.red</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D7BA7D">.pay-detail</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.pay-way</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#333</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.tit</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">30px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.pay-cell</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.van-icon</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">margin-right</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.buytips</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">textarea</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.footer-fixed</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">position</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">fixed</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">left</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">100%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1px</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">solid</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">#efefef</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.left</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">flex</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">padding-left</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">12px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#666</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #D7BA7D">span</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">:</span><span style="color: #CE9178">#fa2209</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #D7BA7D">.tipsbtn</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">121px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">background</span><span style="color: #D4D4D4">: </span><span style="color: #DCDCAA">linear-gradient</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">90deg</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">#f9211c</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">#ff6335</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#fff</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">text-align</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">line-height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">46px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">block</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">font-size</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">14px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h2 id="订单结算"><a class="markdownIt-Anchor" href="#订单结算"></a> 订单结算</h2><p>购物车携带参数：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409020134925.png" alt="image-20240902013448659"></p><h2 id="文件上传unfinished"><a class="markdownIt-Anchor" href="#文件上传unfinished"></a> 文件上传 ——unfinished</h2><h3 id="图片上传"><a class="markdownIt-Anchor" href="#图片上传"></a> 图片上传</h3><blockquote><p>接口要求：POST <code>/upload/image</code></p><p>Header 参数：</p><ul><li>Access-Token (String)示例：<code>1741f74aed758a688515f72572dc8e37</code></li><li>platform (String)        示例值：H5</li></ul><p>Body 参数：<code>multipart/form-data</code></p><ul><li>file 对象</li></ul></blockquote><p>上传图片通常涉及到裁剪操作，于是使用 vue-cropper 插件辅助完成。</p><h4 id="安装vue-cropper"><a class="markdownIt-Anchor" href="#安装vue-cropper"></a> 安装 vue-cropper</h4><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">npm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">vue-cropper</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--save</span></span></code></pre></div></div></figure><h4 id="在组件中使用-vue-cropper"><a class="markdownIt-Anchor" href="#在组件中使用-vue-cropper"></a> 在组件中使用 <code>vue-cropper</code></h4><p>创建上传的组件，允许用户选择图片、裁剪图片并实时预览裁剪效果，然后上传裁剪后的图片。</p><figure class="shiki vue"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"avatar-upload"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">vue-cropper</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">showCropper</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">ref</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cropper"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">img</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">imageSrc</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">output-size</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4">{ </span><span style="color: #C8C8C8">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">200</span><span style="color: #D4D4D4">, </span><span style="color: #C8C8C8">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">200</span><span style="color: #D4D4D4"> }</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">output-type</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #CE9178">'jpeg'</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">can-move-box</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">auto-crop</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">fixed-box</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">fixed</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">      :</span><span style="color: #9CDCFE">center-box</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">"</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&gt;&lt;/</span><span style="color: #569CD6">vue-cropper</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-else</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">img</span><span style="color: #D4D4D4"> :</span><span style="color: #9CDCFE">src</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">avatarUrl</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">alt</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"Avatar"</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">avatarUrl</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"avatar-preview"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">input</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"file"</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">change</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">onAvatarChange</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> /</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">div</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">v-if</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">showCropper</span><span style="color: #D4D4D4">"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"cropper-controls"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">cropImage</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">裁剪并上传</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">button</span><span style="color: #D4D4D4"> @</span><span style="color: #9CDCFE">click</span><span style="color: #D4D4D4">=</span><span style="color: #D4D4D4">"</span><span style="color: #9CDCFE">cancelCrop</span><span style="color: #D4D4D4">"</span><span style="color: #808080">&gt;</span><span style="color: #D4D4D4">取消</span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">button</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">div</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">template</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">VueCropper</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'vue-cropper'</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">uploadImage</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'@/api/upload'</span><span style="color: #D4D4D4">;</span></span><span class="line"></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">components:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">VueCropper</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">data</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">avatarUrl:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 存储裁剪后的头像URL</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">imageSrc:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">,  </span><span style="color: #6A9955">// 存储用户选择的图片的URL</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">showCropper:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 控制是否显示裁剪器</span></span><span class="line"><span style="color: #D4D4D4">    };</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">onAvatarChange</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">event</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">file</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">event</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">files</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">];</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">file</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">imageSrc</span><span style="color: #D4D4D4"> = </span><span style="color: #4FC1FF">URL</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">createObjectURL</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">file</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">showCropper</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">cropImage</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 获取裁剪后的图片数据</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$refs</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cropper</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getCropBlob</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">async</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">blob</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 上传裁剪后的图片</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">try</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">formData</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">FormData</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">formData</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">append</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'file'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">blob</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">response</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">await</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">uploadImage</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">blob</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">status</span><span style="color: #D4D4D4"> === </span><span style="color: #B5CEA8">200</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">avatarUrl</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">response</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">data</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">fileInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">preview_url</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">showCropper</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">          } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$toast</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">fail</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'上传失败，请重试'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">          }</span></span><span class="line"><span style="color: #D4D4D4">        } </span><span style="color: #C586C0">catch</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">$toast</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">fail</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'上传失败，请重试'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">error</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">error</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">      });</span></span><span class="line"><span style="color: #D4D4D4">    },</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">cancelCrop</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">showCropper</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">imageSrc</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">};</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span><span class="line"></span><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D7BA7D">.avatar-upload</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">flex-direction</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">column</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">align-items</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">center</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.avatar-preview</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">width</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">200px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">height</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">200px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">50%</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">object-fit</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">cover</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-bottom</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.cropper-controls</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">margin-top</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">display</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">flex</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">gap</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.cropper-controls</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">button</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">padding</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#FF3E47</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">white</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">none</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">border-radius</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">5px</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">cursor</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">pointer</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #D7BA7D">.cropper-controls</span><span style="color: #D4D4D4"> </span><span style="color: #D7BA7D">button:hover</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">background-color</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">#E0363D</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">style</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><h2 id="打包优化"><a class="markdownIt-Anchor" href="#打包优化"></a> 打包优化</h2><h3 id="优化访问路径"><a class="markdownIt-Anchor" href="#优化访问路径"></a> 优化访问路径</h3><p>打包命令：<code>yarn build</code> 或者 <code>npm run build</code></p><p>打包如果没有配置 vue.config.js 的 <code>publicPath</code>，默认生成的匹配文件的写法是绝对路径，这意味着将来的可移植性降低。于是配置：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'@vue/cli-service'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">publicPath:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'./'</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 默认为'/'</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">transpileDependencies:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span></span><span class="line"><span style="color: #D4D4D4">})</span></span></code></pre></div></div></figure><h3 id="懒加载"><a class="markdownIt-Anchor" href="#懒加载"></a> 懒加载</h3><p>打包实际上将多个文件多合一，如果一次性加载所有的 js 文件是非常消耗性能的，因此推荐配置懒加载。</p><p><a href="https://router.vuejs.org/zh/guide/advanced/lazy-loading.html">路由懒加载</a></p><ul><li>异步组件改造 </li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">ProDetail</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">import</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'@/views/prodetail'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Pay</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">import</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'@/views/pay'</span><span style="color: #D4D4D4">)</span></span><span class="line"><span style="color: #D4D4D4">...</span></span></code></pre></div></div></figure><ul><li>路由中应用 </li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">router</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">VueRouter</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">routes:</span><span style="color: #D4D4D4"> [</span></span><span class="line"><span style="color: #D4D4D4">    ...</span></span><span class="line"><span style="color: #D4D4D4">    {</span><span style="color: #9CDCFE">path:</span><span style="color: #CE9178">'prodetail/:id'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">component:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">ProDetail</span><span style="color: #D4D4D4">},</span></span><span class="line"><span style="color: #D4D4D4">    {</span><span style="color: #9CDCFE">Path:</span><span style="color: #CE9178">'/Pay'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">component:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Pay</span><span style="color: #D4D4D4">},</span></span><span class="line"><span style="color: #D4D4D4">    ...</span></span><span class="line"><span style="color: #D4D4D4">  ]</span></span><span class="line"><span style="color: #D4D4D4">})</span></span></code></pre></div></div></figure><p>对比：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202409030451734.png" alt="image-20240903045130463"></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Vue笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue 项目打包并部署到 GitHub 为 demo</title>
    <link href="/archives/Vue/31657.html"/>
    <url>/archives/Vue/31657.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="Vue项目打包并部署到GitHub为demo，解决小白的一切打包困惑"><h1 id="一文搞清楚vue项目打包并部署到github为demo的整个流程"><a class="markdownIt-Anchor" href="#一文搞清楚vue项目打包并部署到github为demo的整个流程"></a> 一文搞清楚 Vue 项目打包并部署到 GitHub 为 demo 的整个流程</h1><blockquote><p>目标：将打包好的 Vue2 | Vue3 项目部署到 <a href="https://docs.github.com/zh/pages/getting-started-with-github-pages/about-github-pages">github pages</a> 用作项目 demo</p></blockquote><p>我将尽可能的讲述打包前后可能遇到的绝大部分问题和原因，希望能有所帮助。</p><h2 id="打包前的问题"><a class="markdownIt-Anchor" href="#打包前的问题"></a> 打包前的问题</h2><p>打包其实实际上不会碰到什么大问题，我们讨论的问题实际是打包之后想要将打包结果也就是静态页面进行部署而发生的问题：</p><ol><li>白屏问题</li><li>刷新 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status">404</a> 问题</li><li>跨域问题</li></ol><p>但要想讨论上述问题，我们得研究好打包前的配置问题，也就是为什么会出现上述问题？</p><h3 id="请求地址配置问题"><a class="markdownIt-Anchor" href="#请求地址配置问题"></a> 请求地址配置问题</h3><p>首先我这里默认你的项目中二次封装了 <code>axios</code> 并配置了 <code>base</code> 请求基地址（别告诉我请求地址是 localhost 哈），那么你的请求配置方法可能是：</p><ol><li>主动暴露 base</li></ol><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">base</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'http://your.domain.com'</span></span><span class="line"><span style="color: #C8C8C8">api</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/api/end-point'</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4"># </span><span style="color: #9CDCFE">The</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">final</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">form</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">may</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">look</span><span style="color: #D4D4D4"> </span><span style="color: #C8C8C8">like</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #C8C8C8">http</span><span style="color: #D4D4D4">:</span><span style="color: #6A9955">//your.domain.com/api/end-point</span></span></code></pre></div></div></figure><p>或者你是这样配置的（环境为 Vue3+vite）：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">base</span><span style="color: #D4D4D4">: </span><span style="color: #C586C0">import</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">meta</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">.</span><span style="color: #4FC1FF">VITE_BASE_URL</span></span><span class="line"><span style="color: #C8C8C8">api</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/api/end-point'</span></span><span class="line"></span><span class="line"><span style="color: #D4D4D4"># </span><span style="color: #9CDCFE">The</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">final</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">request</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">form</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">may</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">look</span><span style="color: #D4D4D4"> </span><span style="color: #C8C8C8">like</span><span style="color: #D4D4D4">:</span></span><span class="line"><span style="color: #C8C8C8">http</span><span style="color: #D4D4D4">:</span><span style="color: #6A9955">//your.domain.com/api/end-point</span></span></code></pre></div></div></figure><ol start="2"><li>配置 proxy 转发</li></ol><p>如果你并没有在二次封装 axios 的过程中暴露具体请求地址，而是配置了 proxy 进行代理转发，你的 proxy 配置可能是：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4"># </span><span style="color: #9CDCFE">vite</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">js</span></span><span class="line"><span style="color: #C8C8C8">devServer</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C8C8C8">proxy</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #CE9178">'/dev'</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">target:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'http://your.domain.com'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">pathRewrite:</span><span style="color: #D4D4D4"> { </span><span style="color: #CE9178">'^/dev'</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">''</span><span style="color: #D4D4D4"> }</span></span><span class="line"><span style="color: #D4D4D4">      ......</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>配置 proxy 的开发环境下，只要请求匹配到 <code>/api</code> 就会把请求转发到 <code>target</code> 并且将 <code>/dev</code> 删除，浏览器请求为（假设你的项目运行在 8088 端口）：<code>http://localhost:8088/dev/api/end-point</code>，实际请求为：<code>http://your.domain.com/api/end-point</code></p><h3 id="proxy的缺点"><a class="markdownIt-Anchor" href="#proxy的缺点"></a> proxy 的缺点</h3><p>这两者在开发环境进行请求都没有问题，都能完成任务，但是一旦进行了打包，脚手架环境消失，这第 2 种配置方法就失效了，请求会只剩下 <code>/dev/api/end-point</code> 这种形式。</p><p>可能你会问：玩呢？这怎么发请求，我明明还是见到浏览器发出请求了啊，只不过失败了。</p><p>是的，<code>/dev/api/end-point</code> 这种形式的确不能正常发请求，不过浏览器会在只给出如 <code>/dev/api/end-point</code> 的形式的请求时，自动在前面拼接上下文环境，比如在本地测试项目，浏览器就会自动拼接上 <code>http://localhost:8088</code> 使得最终形式为：<code>http://localhost:8088/dev/api/end-point</code>。不过变成这种情况的话，基本也就无法部署了（本地部署除外），因为你已经失去了脚手架的 proxy 环境，不过你依然可以在 Vue 项目的同系统环境下使用 Nginx（类似 Nginx 的也行）尝试进行监听和转发，也就是反向代理。详情请见下节中的 <a href="#history%E4%BD%BF%E7%94%A8">history 使用</a>。</p><p>那么第 1 种配置方法会在打包之后发生什么问题吗？不会，它可以正常工作（除非请求地址是 localhost，如果为 localhost 则会引起跨域问题）。</p><h3 id="js引入地址配置问题"><a class="markdownIt-Anchor" href="#js引入地址配置问题"></a> Js 引入地址配置问题</h3><p>如果说请求地址影响着数据显示问题，那么 js 引入地址影响的是打包后的页面白屏问题。</p><p>这个问题基本上就是打包后的文件引入问题，我们应当将导出后的 js 等文件的引入地址配置为相对地址。</p><p>在 vite 或 vue-cli 中 <a id="js">应当配置</a> 如下：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4"># </span><span style="color: #9CDCFE">vite</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">js</span></span><span class="line"><span style="color: #C8C8C8">base</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'./'</span><span style="color: #D4D4D4">,</span></span></code></pre></div></div></figure><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4"># </span><span style="color: #9CDCFE">vue</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">js</span></span><span class="line"><span style="color: #C8C8C8">publicPath</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'./'</span><span style="color: #D4D4D4">,</span></span></code></pre></div></div></figure><blockquote><p>对于 vue2 的 vue-cli，官方文档中不推荐直接配置 <code>output.publicPath</code> 而是始终使用 **<code>publicPath</code>**</p></blockquote><p>这将使得打包后的 <code>index.html</code> 页面的 js 引入地址为相对地址，看起来就像这样：</p><figure class="shiki html"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">link</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">href</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"css/app.363852d2.css"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">rel</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"stylesheet"</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>请注意结果为 <code>css/app.363852d2.css</code> 而非 <code>/js/app.5bd045ab.js</code></p><h2 id="解决打包后的白屏问题"><a class="markdownIt-Anchor" href="#解决打包后的白屏问题"></a> 解决打包后的白屏问题</h2><p>出现白屏问题，白屏分为：</p><ol><li>跨域造成的</li><li> js 未正确引入造成的：没有配置成相对路径，详见 <a href="#js">js 配置</a></li><li>其他……</li></ol><h3 id="解决跨域问题"><a class="markdownIt-Anchor" href="#解决跨域问题"></a> 解决跨域问题</h3><blockquote><p>相关链接：<a href="https://cloud.tencent.com/developer/article/1953193">什么是跨域问题？</a></p></blockquote><p>其实也谈不上解决，毕竟这个问题不是真正的跨域问题，<strong>真正的跨域问题只靠前端不靠服务器是不可能解决的</strong>。</p><p>一般这种情况下的跨域问题主要是打包后的文件是以 file 协议进行读取的，而 file 协议不像 http (s) 协议支持跨域，所以控制台 CROS 跨域报错</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410102158577.png" alt="image-20241010215831443"></p><p>解决方案参考：<a href="https://blog.csdn.net/qq_34727886/article/details/136163494">vite 打包本地文件，file 类型 URL 引发跨域等问题探讨</a></p><p>但我不太推荐上面的解决方案，因为利用 Nginx（或其他网络服务器）的反向代理就够了。</p><p>详情见 <a href="#history">history 使用</a></p><h3 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h3><p>诚然，我不可能见过所有的白屏问题，所以欢迎探讨。</p><h2 id="解决打包后的刷新404问题"><a class="markdownIt-Anchor" href="#解决打包后的刷新404问题"></a> 解决打包后的刷新 404 问题</h2><p>为什么会出现有基本结构但是我刷新就报 404 错误呢？</p><p>这个问题的发生满足以下条件：</p><ol><li><p>配置了默认访问或 <code>/</code> 访问重定向到某具体路由页面，如 <code>/home</code></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// Vue2</span></span><span class="line"><span style="color: #C8C8C8">path</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #C8C8C8">redirect</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/home'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span></span><span class="line"><span style="color: #6A9955">// Vue3</span></span><span class="line"><span style="color: #C8C8C8">path</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #C8C8C8">redirect</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'/article/manage'</span><span style="color: #D4D4D4">,</span></span></code></pre></div></div></figure></li><li><p>配置了路由模式为不带<code>#</code>符号的 <code>history</code> 历史模式</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// Vue2</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">router</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">VueRouter</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">mode:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'history'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">routes</span></span><span class="line"><span style="color: #D4D4D4">})</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">router</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// Vue3</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">router</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">createRouter</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// history: createWebHashHistory()</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">history:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createWebHistory</span><span style="color: #D4D4D4">(),</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">routes</span></span><span class="line"><span style="color: #D4D4D4">})</span></span><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">router</span></span></code></pre></div></div></figure></li></ol><p>为什么说满足以上条件就会触发这个问题呢？</p><p>这是因为当你第一次访问项目，你的访问地址可能是：<code>http://localhost:8088</code> 或者 <code>http://localhost:8088/</code> 而因为你的项目满足第一条，所以你的项目自动重定向到了你指定的某个具体路由页面，比如：<code>http://localhost:8088/home</code></p><p>如果你按照上述方式访问，这个时候为第一次访问，是没有任何问题的，js 正常加载，页面正常显示。一旦当你刷新之后，访问地址就变成了 <code>http://localhost:8088/home</code></p><p>这是什么地址？浏览器会认为 <code>/home</code> 是一个后端路由地址将其携带到后端服务器：” 嘿哥们，你这儿有这样一个路由地址吗？“，然而后端实际上没有这样一个路由能匹配，于是就造成了 <code>404 not found</code> 的结果。</p><p>那为什么别人做的网站 / 项目不会这样呢？当然是因为别人已经配置过了，没有经过正确配置之前，人人都一样的。</p><p>那是不是 Hash 哈希模式就可以呢？是的，hash 模式可以解决这个问题。</p><p>这是因为设置为 hash 模式后，如果有 <code>http://your.domain.com/#/homepage</code> 这样一个地址，那么其中的<code>#/homepage</code> 就是 <code>hash</code> 值，<code>hash</code> 值只在客户端（如浏览器）中使用，是不会带给服务器的，所以使用 <code>hash</code> 模式时，不存在刷新 <code>404</code> 问题。</p><h2 id="怎么使用history模式"><a class="markdownIt-Anchor" href="#怎么使用history模式"></a> 怎么使用 history 模式</h2><p>我不想出现 404 错误，我也不想使用 Hash 模式，我该怎么使用 <code>history</code> 模式来让网站变得更优雅呢？</p><p>思路：让服务器那边在收到未配置的 <code>GET</code> 路由时，都返回 <code>index.html</code> 即可。</p><p>什么意思呢？如果浏览器将这样一个后端不认识的路由真的带给了服务器，那么服务器就把 <code>index.html</code> 塞回去，<code>index.html</code> 回去了意味着它所引入的 js 就工作了，js 工作了那么前端路由就活过来了，于是就可以正确处理路由地址了，<code>404 not found</code> 问题也就迎刃而解了。</p><p>这也是为什么某些文章中使用 <a href="https://nginx.org/">Nginx</a> 配置里有 <code>try_files $uri $uri/ /index.html;</code> 存在了。</p><p>换句话说，如果你是<strong>本地部署</strong><a id="history">使用 Nginx</a>，它可以解决你的刷新 404 问题，并且，Nginx 也能解决打包后 <code>proxy</code> 失效带来的请求问题，配置 <code>conf/nginx.conf</code> 如下：</p><ul><li>请注意 Nginx 的根目录最好<strong>不要是 C 盘</strong>，防止权限不足 </li></ul><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">http {</span></span><span class="line"><span style="color: #D4D4D4">...略...</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">server {</span></span><span class="line"><span style="color: #D4D4D4">...略...</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">    # 配置Nginx监听的项目根地址</span></span><span class="line"><span style="color: #D4D4D4">    location / {</span></span><span class="line"><span style="color: #D4D4D4">        try_files $uri $uri/ /index.html;</span></span><span class="line"><span style="color: #D4D4D4">        # Vue3项目的打包目录</span></span><span class="line"><span style="color: #D4D4D4">        root D:/your/own/dist;</span></span><span class="line"><span style="color: #D4D4D4">        index index.html; # 默认首页文件名</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">    # 配置请求转发</span></span><span class="line"><span style="color: #D4D4D4">    location /dev/ {</span></span><span class="line"><span style="color: #D4D4D4">    # 配置请求监听到之后的转发目标</span></span><span class="line"><span style="color: #D4D4D4">    proxy_pass http://your.domain.com</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><blockquote><p>相关链接：<a href="https://nginx.org/en/download.html">Nginx 下载</a></p></blockquote><h3 id="github-pages上的history路由模式可行性"><a class="markdownIt-Anchor" href="#github-pages上的history路由模式可行性"></a> GitHub Pages 上的 history 路由模式可行性</h3><h3 id="我的看法"><a class="markdownIt-Anchor" href="#我的看法"></a> 我的看法</h3><p>相信看过上面你已经想到了：我能不能对部署在 GItHub 上的 demo 也这样配置？</p><p>我只能说，我没试过，但我觉得不行：<strong>因为 Nginx 和 demo 不在同一个系统环境</strong>。</p><p>上述配置能成的根本原因是：在前端将路由也带来的情况下，Nginx 进行监听并匹配成功，然后将 <code>index.html</code> 进行返回。</p><p>这里的重点在于，Nginx <strong>要能成功监听</strong>到项目的根地址，但对于部署到 GitHub 上的 demo 来说，浏览器会直接向 GitHub Pages 请求资源，而 GitHub Pages 只支持静态文件托管，它是<strong>没有针对 <code>history</code> 模式的服务端配置</strong>的。</p><p>而且，我总不可能将 Nginx 也部署到 GitHub 上吧？</p><h3 id="一个可能的方法"><a class="markdownIt-Anchor" href="#一个可能的方法"></a> 一个可能的方法</h3><p>不过，ChatGPT 有一个它的解决办法：在 <code>dist</code> 打包<strong>目录内</strong>中加入一个 <code>404.html</code> 页面用于手动返回 <code>index.html</code></p><figure class="shiki html"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"text/javascript"</span><span style="color: #808080">&gt;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 如果页面找不到路径，重定向到index.html，让Vue处理</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">redirect</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">window</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">location</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">pathname</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">window</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">location</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">href</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'/index.html?redirect='</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">redirect</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span></code></pre></div></div></figure><p>我无法验证该方法的可行性，因为我已经将我的 <code>pages</code> 给我生成的域名用来部署了 <code>hexo</code> 博客，我的所有其他仓库的 <code>pages</code> 项目都是在该域名下，这导致我的 demo 无法使用该方法，我也就无法验证了。</p><blockquote><p>相关链接：<a href="https://runoneall.github.io/%E9%80%9A%E8%BF%87Github-Pages-Hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%95%99%E7%A8%8B.html">GitHub Pages 部署 hexo 静态博客</a> -<a href="https://github.com/fluid-dev/hexo-theme-fluid">Fluid</a> 主题</p><p>我参考的那篇文章找不到了……</p></blockquote><h3 id="一个可能需要的配置参考"><a class="markdownIt-Anchor" href="#一个可能需要的配置参考"></a> 一个可能需要的配置参考</h3><p>别忘了给你的 <code>Nginx</code> 服务器加上 <code>ssl监听</code>并正确转发请求（<a href="https://www.runoob.com/w3cnote/https-ssl-intro.html">什么是 ssl 证书？</a>），因为 GItHub 的网络环境是 https 的，如果你发送 http 请求，浏览器将会进行拦截。</p><blockquote><p>可自行搜索需要的免费 ssl 证书签发厂家，如果你的远程服务器没有域名，那么你需要的 ssl 证书为 ip 证书，我使用的正是这种类型，可以搜索：<a href="https://cn.bing.com/search?q=zerossl">zerossl</a></p></blockquote><p>我的 <code>Nginx</code> 配置示例如下：</p><figure class="shiki text"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">#user  nobody;</span></span><span class="line"><span style="color: #D4D4D4">worker_processes  4;</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">#error_log  logs/error.log;</span></span><span class="line"><span style="color: #D4D4D4">#error_log  logs/error.log  notice;</span></span><span class="line"><span style="color: #D4D4D4">#error_log  logs/error.log  info;</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">#pid        logs/nginx.pid;</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">events {</span></span><span class="line"><span style="color: #D4D4D4">    worker_connections  1024;</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">http {</span></span><span class="line"><span style="color: #D4D4D4">    # 监听 HTTP 请求并重定向到 HTTPS</span></span><span class="line"><span style="color: #D4D4D4">    server {</span></span><span class="line"><span style="color: #D4D4D4">        listen 80;  # 监听 HTTP</span></span><span class="line"><span style="color: #D4D4D4">        server_name your_domain;  # 替换为你的域名或 IP</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">        # 强制 HTTP 到 HTTPS 重定向</span></span><span class="line"><span style="color: #D4D4D4">        return 301 https://$host$request_uri;</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">    # 监听 HTTPS 请求</span></span><span class="line"><span style="color: #D4D4D4">    server {</span></span><span class="line"><span style="color: #D4D4D4">        listen 443 ssl;  # 监听 HTTPS</span></span><span class="line"><span style="color: #D4D4D4">        server_name your_domain;  # 替换为你的域名或 IP</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">        ssl_certificate C:/ssl/certificate.crt;  # SSL 证书路径</span></span><span class="line"><span style="color: #D4D4D4">        ssl_certificate_key C:/ssl/private.key;  # SSL 私钥路径</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">        ssl_protocols TLSv1.2 TLSv1.3;  # 启用的 SSL 协议</span></span><span class="line"><span style="color: #D4D4D4">        ssl_ciphers HIGH:!aNULL:!MD5;  # 启用的加密算法</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">        location / {</span></span><span class="line"><span style="color: #D4D4D4">            root C:/my/test;  # 指定网站根目录</span></span><span class="line"><span style="color: #D4D4D4">            index flag.txt;  # 默认主页文件</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">        location /api {</span></span><span class="line"><span style="color: #D4D4D4">            proxy_pass http://localhost:1337;  # 代理到 Strapi</span></span><span class="line"><span style="color: #D4D4D4">            proxy_http_version 1.1;  # 使用 HTTP/1.1</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header Upgrade $http_upgrade;  # 处理 WebSocket</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header Connection 'upgrade';  # 处理 WebSocket</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header Host $host;  # 传递主机头</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header X-Real-IP $remote_addr;  # 传递客户端真实 IP</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  # 传递转发 IP</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header X-Forwarded-Proto $scheme;  # 传递原始协议</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">        location /upload {</span></span><span class="line"><span style="color: #D4D4D4">            proxy_pass http://localhost:1337;  # 代理到 Strapi</span></span><span class="line"><span style="color: #D4D4D4">            proxy_http_version 1.1;  # 使用 HTTP/1.1</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header Upgrade $http_upgrade;  # 处理 WebSocket</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header Connection 'upgrade';  # 处理 WebSocket</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header Host $host;  # 传递主机头</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header X-Real-IP $remote_addr;  # 传递客户端真实 IP</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  # 传递转发 IP</span></span><span class="line"><span style="color: #D4D4D4">            proxy_set_header X-Forwarded-Proto $scheme;  # 传递原始协议</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">        # 其他 location 配置...</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>我的 demo 使用的数据来自 <a href="https://strapi.nodejs.cn/dev-docs/quick-start">Strapi</a>（<a href="https://zhuanlan.zhihu.com/p/671975325">什么是 Strapi？</a>），我将该无头 CMS 部署到了和 Nginx 同一系统环境之下，于是有了上述配置。</p><h2 id="部署到github-pages"><a class="markdownIt-Anchor" href="#部署到github-pages"></a> 部署到 GitHub Pages</h2><h3 id="可选配置"><a class="markdownIt-Anchor" href="#可选配置"></a> 可选配置</h3><p>终于到了激动人心的部署时刻，在打包之前请根据上文做好自己项目的配置，除此之外还有一个配置对于 vite 打包的项目<strong>可选</strong>：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #6A9955">// vite.config.js</span></span><span class="line"><span style="color: #C8C8C8">build</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C8C8C8">rollupOptions</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C8C8C8">output</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">entryFileNames</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'js/[name]-[hash].js'</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 指定 JS 文件的输出路径及命名规则</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">chunkFileNames</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'js/[name]-[hash].js'</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 指定分片文件的输出路径及命名规则</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C8C8C8">assetFileNames</span><span style="color: #D4D4D4">: (</span><span style="color: #9CDCFE">assetInfo</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 设置不同类型文件的输出路径及命名规则</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">assetInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'asset'</span><span style="color: #D4D4D4"> &amp;&amp;</span><span style="color: #D16969"> /</span><span style="color: #D7BA7D">\.</span><span style="color: #CE9178">(</span><span style="color: #D16969">jpe</span><span style="color: #D7BA7D">?</span><span style="color: #D16969">g</span><span style="color: #DCDCAA">|</span><span style="color: #D16969">png</span><span style="color: #DCDCAA">|</span><span style="color: #D16969">gif</span><span style="color: #DCDCAA">|</span><span style="color: #D16969">svg</span><span style="color: #CE9178">)</span><span style="color: #DCDCAA">$</span><span style="color: #D16969">/</span><span style="color: #569CD6">i</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">test</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">assetInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'img/[name].[hash].[ext]'</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 图像文件输出路径及命名规则</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">assetInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">'asset'</span><span style="color: #D4D4D4"> &amp;&amp;</span><span style="color: #D16969"> /</span><span style="color: #D7BA7D">\.</span><span style="color: #CE9178">(</span><span style="color: #D16969">ttf</span><span style="color: #DCDCAA">|</span><span style="color: #D16969">woff</span><span style="color: #DCDCAA">|</span><span style="color: #D16969">woff2</span><span style="color: #DCDCAA">|</span><span style="color: #D16969">eot</span><span style="color: #CE9178">)</span><span style="color: #DCDCAA">$</span><span style="color: #D16969">/</span><span style="color: #569CD6">i</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">test</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">assetInfo</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">)) {</span></span><span class="line"><span style="color: #D4D4D4">          </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'fonts/[name].[hash].[ext]'</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 字体文件输出路径及命名规则</span></span><span class="line"><span style="color: #D4D4D4">        }</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'[ext]/name1-[hash].[ext]'</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 其他资源文件输出路径及命名规则</span></span><span class="line"><span style="color: #D4D4D4">      }</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>添加上述 <code>build</code> 配置项，将会将打包后的 dist 目录按类型分 <code>css</code>、<code>js</code>、<code>img</code> 文件夹。当然<strong>只是可选，非必须</strong>。</p><blockquote><p>配置项参考文章：<a href="https://blog.csdn.net/qq_33522195/article/details/137021366">vue 项目配置 vite 打包输出文件夹（css，img，js，font）</a></p></blockquote><h3 id="github部署"><a class="markdownIt-Anchor" href="#github部署"></a> Github 部署</h3><p>好了，请将项目 <code>build</code> 打包为一个 <code>dist</code> 文件夹。然后按照以下步骤进行部署：</p><ol><li><p>转到 <a href="https://github.com/">GitHub</a> 创建一个新的仓库（已有仓库跳第二步），填写 <code>Repository name</code> 仓库名并将仓库设为 <code>Public</code> 公开就可以了，其他不用设置，点击 <code>Create repository</code> 创建仓库即可。</p></li><li><p>复制仓库的 ssh 链接（<a href="https://www.cnblogs.com/lezaizhu/p/13836164.html">我没有用过 git 进行远程仓库绑定</a>），例如：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git@github.com:yourUserName/article-management-admin.git</span></span></code></pre></div></div></figure></li><li><p>找到本地刚新鲜打包的 <code>dist</code> 文件夹，进入文件夹中，目录结构应该为：</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4"># vue-cli 打包结果</span></span><span class="line"><span style="color: #D4D4D4">├─css</span></span><span class="line"><span style="color: #D4D4D4">├─img</span></span><span class="line"><span style="color: #D4D4D4">├─js</span></span><span class="line"><span style="color: #D4D4D4">├─.nojekyll</span></span><span class="line"><span style="color: #D4D4D4">├─favicon.ico</span></span><span class="line"><span style="color: #D4D4D4">└─index.html</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4"># vite 打包结果</span></span><span class="line"><span style="color: #D4D4D4">├─asset</span></span><span class="line"><span style="color: #D4D4D4">├─favicon.ico</span></span><span class="line"><span style="color: #D4D4D4">└─index.html</span></span></code></pre></div></div></figure></li><li><p>在 <code>dist</code><strong>文件夹内</strong>，执行 git 仓库初始化</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">init</span></span></code></pre></div></div></figure></li><li><p>添加所有文件到暂存区，并执行 <code>commit</code> 提交<br>注：<code>vite</code> 打包的项目可能会存在以<code>_</code>下划线开头的 <code>js</code> 文件，而 <code>GitHub Pages</code> 可能忽略该文件，导致项目 demo 无法找到文件报 404 错误，请检查你的 dist 文件夹下的 asset 目录中是否存在上述文件。如果确实存在，请在 <code>dist</code> 目录下创建一个空文件以禁用 GitHub Pages 的 Jekyll 默认处理行为，文件名为：<code>.nojekyll</code><br>参考文章：<a href="https://www.cnblogs.com/deajax/p/12430884.html">github pages 不能识别下划线开头的文件</a></p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">add</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span></span><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">commit</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-m</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"-Write down your message here."</span></span></code></pre></div></div></figure></li><li><p>绑定远程仓库</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">remote</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">add</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">origin</span><span style="color: #D4D4D4"> &lt;</span><span style="color: #CE9178">remote-ur</span><span style="color: #D4D4D4">l&gt;</span></span></code></pre></div></div></figure></li><li><p>你可以将该分支（我的默认初始化分支为 main）先 push 推送出去，已有仓库的可以跳到 8</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">push</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-u</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">origin</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">main</span></span></code></pre></div></div></figure></li><li><p>创建孤立的空分支 <code>gh-pages</code> 用于推送</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">checkout</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--orphan</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">gh-pages</span></span></code></pre></div></div></figure></li><li><p>推送代码到 <code>gh-pages</code> 分支用于部署静态页面</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">push</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-u</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">origin</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">gh-pages</span></span></code></pre></div></div></figure></li><li><p>转到 GitHub 仓库页，请切换仓库分支为 <code>gh-pages</code> 并等待 <code>GitHub</code> 的 <code>check</code> 操作：<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410110255530.png" alt="image-20241011025535410"></p></li><li><p>GitHub 的 check 操作完成后，点击仓库 <code>Settings</code> 设置项，然后在左侧侧边栏选择 <code>Pages</code>，点击构建好的链接或者右边的 <code>Visit site</code> 即可。<br><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202410110259820.png" alt="image-20241011025932731"></p></li></ol><p>小白篇到此，完结撒花🎉🎉🎉</p><p>有更多需求可以自行探索，相信你已经入门了。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Vue笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DASCTF X CBCTF 2022 九月挑战赛 dino3d</title>
    <link href="/archives/WP/29897.html"/>
    <url>/archives/WP/29897.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><h1 id="dasctf-x-cbctf-2022九月挑战赛-dino3d"><a class="markdownIt-Anchor" href="#dasctf-x-cbctf-2022九月挑战赛-dino3d"></a> DASCTF X CBCTF 2022 九月挑战赛 dino3d</h1><meta name="description" content="该文章主要是记录一个值得探讨的CTF的WEB方向的题目：DASCTF X CBCTF 2022九月挑战赛 dino3d"><blockquote><p>题目链接：<a href="https://buuoj.cn/match/matches/151/challenges">https://buuoj.cn/match/matches/151/challenges</a></p></blockquote><p>启动环境之后，玩一会，进行抓包：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20221104203141388-1667565104615-1.png" alt="1"></p><p>得到 score 分数和 checkcode，因为要玩到 1000000 分，所以直接修改分数 score 为目标分数发出看看：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20221104203423402-1667565266070-3.png" alt="2"></p><p>看来行不通，可能还要<strong>伪造 checkcode 和 tm 时间戳</strong>。</p><p>f12 查看 js 代码，ctrl+f 搜索 checkcode，找到定义：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20221104203851364-1667565535786-5.png" alt="3"></p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">checkCode</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'DASxCBCTF'</span><span style="color: #D4D4D4"> + </span><span style="color: #9CDCFE">salt</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>这里这个 salt 并不知道是什么，还需要查看代码分析。</p><p>知道定义之后，再查看另外两个搜索结果：</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20221104204137072-1667565698310-7.png" alt="4"></p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20221104204157356-1667565718617-9.png" alt="5"></p><p>判断关键信息：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C8C8C8">body</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">'score='</span><span style="color: #D4D4D4"> + </span><span style="color: #DCDCAA">parseInt</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">toString</span><span style="color: #D4D4D4">() + </span><span style="color: #CE9178">'&amp;checkCode='</span><span style="color: #D4D4D4"> + </span><span style="color: #DCDCAA">md5</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">parseInt</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">e</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">toString</span><span style="color: #D4D4D4">() + </span><span style="color: #9CDCFE">t</span><span style="color: #D4D4D4">) + </span><span style="color: #CE9178">'&amp;tm='</span><span style="color: #D4D4D4"> + ( + </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">Date</span><span style="color: #D4D4D4">).</span><span style="color: #DCDCAA">toString</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">substring</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">)</span></span></code></pre></div></div></figure><p>根据抓包结果，我们知道数据格式是：</p><figure class="shiki bash"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #9CDCFE">score</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">xxx</span><span style="color: #D4D4D4">&amp;</span><span style="color: #9CDCFE">checkCode</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">xxx</span><span style="color: #D4D4D4">&amp;</span><span style="color: #9CDCFE">tm</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">xxx</span></span></code></pre></div></div></figure><p>所以可以判定这里的 e 是分数，那么这个 md5 () 函数里面的 <strong>t</strong> 又是什么？</p><p>到这里就进展不下去了，只能再去找找这个 <strong>salt</strong>，因为根据定义（或者说赋值语句）中的 checkcode = "xxx"+salt 来看，这个 salt 可能就是 t</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20221104204811600-1667566092580-11.png" alt="image-20221104204811600-1667566092580-11"></p><p>搜索 salt 发现赋值语句：</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">salt</span><span style="color: #D4D4D4"> = </span><span style="color: #CE9178">'_wElc03e'</span><span style="color: #D4D4D4">;</span></span></code></pre></div></div></figure><p>此外并未搜索到其他新的跟 salt 有关的语句了。</p><p>那么我们就要验证一下这个 t 是不是就是 salt 了。验证的方法也很简单，直接 md5 (分数 + salt) 然后跟我们抓包的结果进行比对即可。</p><p>抓包结果：</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">score=150</span></span><span class="line"><span style="color: #D4D4D4">checkCode=c652f21617f6592c3918c8aa7aa85502</span></span></code></pre></div></div></figure><p>md5 加密结果：</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">150DASxCBCTF_wElc03e</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4">md5_after:c652f21617f6592c3918c8aa7aa85502</span></span></code></pre></div></div></figure><p>拼接加密结果和抓包结果的 checkcode 相同。这样就能伪造 checkcode 了</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">checkcode=md5(score+DASxCBCTF+_wElc03e)</span></span></code></pre></div></div></figure><p>由于我们要达到目标分才能拿到 flag，那么先直接将目标 checkcode 写出</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">flag_checkcode: 4639d0ab43e9030749f450eb6e9fbb97</span></span></code></pre></div></div></figure><p>score</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">flag_score: 1000000</span></span></code></pre></div></div></figure><p>时间戳的话，直接通过在线网站查询然后写一个未来时间的值，等到了那个值同一时间将包发出即可。（考虑网络延迟，可能要稍微快一点点将包发出）</p><p>时间戳转换网址：<a href="https://shijianchuo.net/">https://shijianchuo.net/</a></p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20221104211441095-1667567683413-13.png" alt="13"></p><p>返回查看就能得到 flag 了</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF-WP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF-WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>uni-app 涉及到的生命周期小结</title>
    <link href="/archives/Uni-app/7498.html"/>
    <url>/archives/Uni-app/7498.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="description" content="uni-app涉及到的生命周期小结"><h1 id="uni-app涉及到的生命周期小结"><a class="markdownIt-Anchor" href="#uni-app涉及到的生命周期小结"></a> uni-app 涉及到的生命周期小结</h1><p>UniApp 中，除了常见的 Vue 生命周期（如 <code>created</code>、<code>mounted</code> 等），它还提供了特定于小程序和移动应用的<strong>页面生命周期</strong>和<strong>应用生命周期</strong></p><h2 id="uniapp-常见的页面生命周期"><a class="markdownIt-Anchor" href="#uniapp-常见的页面生命周期"></a> UniApp 常见的页面生命周期</h2><h3 id="1-onloadoptions"><a class="markdownIt-Anchor" href="#1-onloadoptions"></a> 1、onLoad(options)</h3><ul><li>页面加载时触发。</li><li>常用于初始化页面数据，从页面 URL 的参数 <code>options</code> 获取数据。</li><li>只在页面首次加载时触发一次。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onLoad</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">options</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 可以从options中拿到url查询参数</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'页面加载'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">options</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="2-onshow"><a class="markdownIt-Anchor" href="#2-onshow"></a> 2、onShow()</h3><ul><li>页面显示时触发，可能在页面首次加载后，也可能在页面重新显示时（如从后台切回前台）。</li><li>常用于刷新页面数据或 UI 状态。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onShow</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'页面显示'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="3-onready"><a class="markdownIt-Anchor" href="#3-onready"></a> 3、onReady()</h3><ul><li>页面初次渲染完成时触发，只触发一次。</li><li>页面结构加载和绘制完成后触发，可以在此进行与 UI 相关的操作。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onReady</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'页面初次渲染完成'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="4-onhide"><a class="markdownIt-Anchor" href="#4-onhide"></a> 4、onHide()</h3><ul><li>页面被隐藏时触发，比如跳转到其他页面或应用切换到后台时。</li><li>常用于暂停页面中的定时器或动画。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onHide</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'页面隐藏'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="5-onunload"><a class="markdownIt-Anchor" href="#5-onunload"></a> 5、onUnload()</h3><ul><li>页面卸载（离开）时触发，常用于清理资源（如关闭网络请求或销毁定时器）。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onUnload</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'页面卸载'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="6-onpulldownrefresh"><a class="markdownIt-Anchor" href="#6-onpulldownrefresh"></a> 6、onPullDownRefresh()</h3><ul><li>监听用户下拉动作的事件处理函数。</li><li>需要在 <code>pages.json</code> 中启用页面的下拉刷新功能。</li></ul><figure class="shiki json"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">"path"</span><span style="color: #D4D4D4"> : </span><span style="color: #CE9178">"goods_list/goods_list"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">"style"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"enablePullDownRefresh"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">true</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><ul><li>在处理完数据刷新后，调用 <code>uni.stopPullDownRefresh()</code> 来结束下拉刷新状态。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">onPullDownRefresh</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'用户触发了下拉刷新'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    </span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 模拟数据请求</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">fetchData</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 数据加载完成后，停止下拉刷新</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">uni</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">stopPullDownRefresh</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">    });</span></span><span class="line"><span style="color: #D4D4D4">  },</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">methods:</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">fetchData</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">callback</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 这里可以调用 API 或执行其他操作来获取新数据</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">setTimeout</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'数据刷新完成'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">callback</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #DCDCAA">callback</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #D4D4D4">      }, </span><span style="color: #B5CEA8">2000</span><span style="color: #D4D4D4">);  </span><span style="color: #6A9955">// 模拟延迟</span></span><span class="line"><span style="color: #D4D4D4">    }</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>在 UniApp 中，<code>onReachBottom()</code> 默认是在页面滚动到离底部 50px 位置时触发。不过在 <code>pages.json</code> 文件中，可以配置 <code>onReachBottomDistance</code> 属性来调整触底的距离。这个属性指定了页面滚动到底部时触发 <code>onReachBottom()</code> 事件的距离（单位 px）。例如，将触底距离设为 150px</p><figure class="shiki json"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">{</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">"path"</span><span style="color: #D4D4D4"> : </span><span style="color: #CE9178">"goods_list/goods_list"</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">"style"</span><span style="color: #D4D4D4">: {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"enablePullDownRefresh"</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">"onReachBottomDistance"</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">150</span></span><span class="line"><span style="color: #D4D4D4">  }</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="7-onreachbottom"><a class="markdownIt-Anchor" href="#7-onreachbottom"></a> 7、onReachBottom()</h3><ul><li>页面上拉触底事件的处理函数。</li><li>用户上拉到页面底部时触发，常用于加载更多数据的场景。</li></ul><h3 id="8-onpagescrollobject"><a class="markdownIt-Anchor" href="#8-onpagescrollobject"></a> 8、onPageScroll(object</h3><ul><li>页面滚动时触发，可以获取页面的滚动距离。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onPageScroll</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">event</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'页面滚动'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">event</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">scrollTop</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="9-onshareappmessage"><a class="markdownIt-Anchor" href="#9-onshareappmessage"></a> 9、onShareAppMessage()</h3><ul><li>用户点击右上角分享时触发，返回自定义的分享内容。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onShareAppMessage</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">title:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'分享标题'</span><span style="color: #D4D4D4">,</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">path:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'/pages/index/index'</span></span><span class="line"><span style="color: #D4D4D4">  };</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h2 id="应用程序生命周期"><a class="markdownIt-Anchor" href="#应用程序生命周期"></a> 应用程序生命周期</h2><p>这些生命周期钩子是针对整个应用程序的，在不同的应用场景下会被触发。</p><h3 id="1-onlaunch"><a class="markdownIt-Anchor" href="#1-onlaunch"></a> 1、onLaunch()</h3><ul><li>当应用首次启动时触发，通常用于执行一些全局的初始化操作。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onLaunch</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">options</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'应用启动'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="2-onshow-2"><a class="markdownIt-Anchor" href="#2-onshow-2"></a> 2、onShow()</h3><ul><li>当应用从后台进入前台显示时触发。</li><li>类似页面生命周期中的 <code>onShow</code>，但是作用于整个应用。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onShow</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">options</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'应用显示'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="3-onhide"><a class="markdownIt-Anchor" href="#3-onhide"></a> 3、onHide()</h3><ul><li>当应用进入后台时触发。</li><li>可以在这里处理数据保存、暂停定时器等操作。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onHide</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'应用隐藏'</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="4-onerror"><a class="markdownIt-Anchor" href="#4-onerror"></a> 4、onError()</h3><ul><li>当应用发生 JavaScript 错误时触发。</li><li>常用于全局错误监控。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onError</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">err</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">error</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'应用出错'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">err</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="5-onpagenotfound"><a class="markdownIt-Anchor" href="#5-onpagenotfound"></a> 5、onPageNotFound()</h3><ul><li>当页面路径不存在时触发，通常用于重定向到一个有效页面。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onPageNotFound</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">uni</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">redirectTo</span><span style="color: #D4D4D4">({</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">url:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">'/pages/404/404'</span></span><span class="line"><span style="color: #D4D4D4">  });</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h2 id="小程序平台专属生命周期"><a class="markdownIt-Anchor" href="#小程序平台专属生命周期"></a> 小程序平台专属生命周期</h2><h3 id="1-onresize小程序平台专属"><a class="markdownIt-Anchor" href="#1-onresize小程序平台专属"></a> 1、onResize ()（小程序平台专属）</h3><ul><li>当小程序窗口尺寸发生变化时触发，通常在设备旋转时使用。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onResize</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">size</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'窗口尺寸变化'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">size</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h3 id="2-ontabitemtapitem小程序平台专属"><a class="markdownIt-Anchor" href="#2-ontabitemtapitem小程序平台专属"></a> 2、onTabItemTap (item)（小程序平台专属）</h3><ul><li>监听 tab 页点击的事件。</li></ul><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">onTabItemTap</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'Tab 被点击'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">item</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><p>此笔记随时可能更新，总感觉还是见得少了……</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Uni-app笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
      <tag>uni-app</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>理解闭包理解防抖</title>
    <link href="/archives/Vue/35829.html"/>
    <url>/archives/Vue/35829.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="description" content="对Vue项目中的防抖功能的浅略探讨"><h1 id="防抖"><a class="markdownIt-Anchor" href="#防抖"></a> 防抖</h1><p>防抖主要应用在一些高频次操作事件上，比如：scroll 滑动、input 输入、resize 缩放等。</p><h2 id="什么是防抖"><a class="markdownIt-Anchor" href="#什么是防抖"></a> 什么是防抖</h2><p>防抖的意思是在高频率触发的事件中，只执行最后一次操作，前面的操作都会被取消掉。例如，你在页面中连续滚动，防抖函数会等待一定的时间，如果这段时间内没有再次触发滑动，才执行实际的处理逻辑。如果在等待的时间内事件再次触发，计时器就会被重置，直到没有再触发时，才执行一次操作。</p><p>一般来说防抖函数形式如下</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">debounce</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">fn</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">delay</span><span style="color: #D4D4D4">) { </span><span style="color: #6A9955">// fn为传入的函数名</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">timer</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">;  </span><span style="color: #6A9955">// 用来保存定时器的 ID</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4">(...</span><span style="color: #9CDCFE">args</span><span style="color: #D4D4D4">) {  </span><span style="color: #6A9955">// 返回一个闭包函数</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">timer</span><span style="color: #D4D4D4">) </span><span style="color: #DCDCAA">clearTimeout</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">timer</span><span style="color: #D4D4D4">);  </span><span style="color: #6A9955">// 若已有定时器则清除它</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">timer</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">setTimeout</span><span style="color: #D4D4D4">(() </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {  </span><span style="color: #6A9955">// 设置一个新的定时器</span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// 当延时结束时，执行传入的函数，并绑定当前的上下文和参数  </span></span><span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">fn</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">apply</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">this</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">args</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">    }, </span><span style="color: #9CDCFE">delay</span><span style="color: #D4D4D4">);  </span><span style="color: #6A9955">// delay 是等待的时间，单位是毫秒 ms</span></span><span class="line"><span style="color: #D4D4D4">  };</span></span><span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div></div></figure><h2 id="使用示例"><a class="markdownIt-Anchor" href="#使用示例"></a> 使用示例</h2><p>假设我们有一个函数 <code>handleScroll</code>，它在页面滚动时处理一些操作，我们不希望它每次滚动都触发，因为这会增加不必要的性能消耗，我们希望它在滚动停止后执行，那么可以这样使用防抖函数</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">handleScroll</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"处理滚动事件中..."</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// 实际逻辑略</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 使用防抖包装滚动事件处理函数，等待300毫秒</span></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">debouncedHandleScroll</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">debounce</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">handleScroll</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">300</span><span style="color: #D4D4D4">);</span></span><span class="line"></span><span class="line"><span style="color: #6A9955">// 当页面滚动时</span></span><span class="line"><span style="color: #9CDCFE">window</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">addEventListener</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">'scroll'</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">debouncedHandleScroll</span><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><h2 id="理解防抖函数"><a class="markdownIt-Anchor" href="#理解防抖函数"></a> 理解防抖函数</h2><p>为理解防抖函数，首先要看看防抖函数怎么被使用。由上面的使用示例可以知道，调用时，<code>debounce</code> 的第一个参数为我们希望进行管理的高频次响应或处理事件函数，第二个参数为我们希望的连续事件结束后等待的时间。</p><p>一进入防抖函数，首先检查是否存在过定时器，如果有则清除，如果没有则新建一个定时器，并在定时器内调用回调，执行真正你想执行的操作。</p><p>核心是：<strong>多次触发事件时，只有最后一次触发后的延迟时间结束后才执行目标函数</strong>。</p><ul><li>什么是 timer？</li></ul><p>在上面的页面滑动例子中，<code>timer</code> 在每次被调用的时候被赋值为定时器的 <code>ID</code>。</p><p>具体来说，setTimeout 的返回值是一个定时器的标识符 <code>ID</code>。而定时器的 ID 的类型因环境不同也有所差异：在浏览器环境中，setTimeout 的返回是一个数值类型的 ID，例如第一次调用可能返回 1，第二次为 2，依次递增；在 Node.js 环境中，setTimeout 返回值可能是一个定时器对象，但仍然可以通过 clearTimeout 消除。当然也可以将 timer 写作别的名称，只要合法都行，但为了直观还是建议写成 timer</p><ul><li>为什么每次开始要判断是否清除定时器 ID？</li></ul><p>因为定时器 ID 的存在状态标识了某事件是否还在发生。</p><p>假设每次开始不清除定时器，那么每一次滑动页面都会设置一个新的定时器，<strong>这样并不能做到防抖效果</strong>，因为你只是将每一次的滑动进行了延时，最终每一次的滑动处理事件都将发生。</p><p>现在，假设每次开始都清除定时器，那么当前的滑动事件会将上一次的滑动事件定时清除，并为自己这一次的滑动事件进行定时，而这一次若为最后一次，函数将不再会被调用，也就不再会清除定时器，这一次的事件将会被正确的以设置好的时间定时进行处理。</p><blockquote><p>这种事件可以类比生活中的乘电梯事件：将电梯门看作事件处理函数，进入电梯的这一动作看作不希望的高频次事件。当人按下电梯按钮，电梯抵达并开门，开门的同时开始计时，每有一个人被红外检测到，人经过电梯门进入电梯之后，电梯门的计时就重新开始（清除上一次的计时），直到没有人进入（高频次事件停止，进入电梯的最后一个人为最后的事件），电梯门最终关闭（定时器时间到了），电梯执行上升或下降等约定好的操作（执行回调函数）。</p></blockquote><ul><li>为什么不将 timer 写在外部？为什么返回一个闭包函数？</li></ul><p><code>timer</code> 在功能上看，当然可以作为全局变量定义在整个函数外部，但是这样一来如果别处也要使用 <code>timer</code> 就会显得不太合适，<code>timer</code> 会被污染，不便于函数的封装复用并且还存在安全问题，将其私有化是一个好的选择。</p><p>而且闭包可以记录外部变量的状态（这主要依靠作用域链），这样能保证多次触发事件访问到的是<strong>同一个</strong><code>timer</code>，保证多次事件触发能清除到<strong>前一个事件</strong>的定时，最终实现防抖。</p><ul><li><s>what the hell is this closure anyway?</s> 这闭包到底是啥？</li></ul><p><strong>闭包</strong>（closure）是 JavaScript 中一个重要的概念，<strong>闭包</strong>是指一个函数可以访问它外部函数作用域中的变量，即使在外部函数已经执行结束后，它仍然可以通过引用这些变量。</p><p>什么意思呢？假设有这样一个函数</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createCounter</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">count</span><span style="color: #D4D4D4"> = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4">() {</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">count</span><span style="color: #D4D4D4"> += </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">count</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #D4D4D4">    };</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">counter</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">createCounter</span><span style="color: #D4D4D4">();</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">counter</span><span style="color: #D4D4D4">());  </span><span style="color: #6A9955">// 输出 1</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">counter</span><span style="color: #D4D4D4">());  </span><span style="color: #6A9955">// 输出 2</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">counter</span><span style="color: #D4D4D4">());  </span><span style="color: #6A9955">// 输出 3</span></span></code></pre></div></div></figure><p>按理说一个函数 return 之后函数本身就已经 over 了，但是 counter 还是能够访问到 count 的值，并进行了累加。类似这样的一个返回的函数就是闭包。闭包一般是在<strong>函数嵌套</strong>的情况下形成的。当一个函数 <code>A</code> 返回另一个内部函数 <code>B</code>，并且 <code>B</code> 可以访问 <code>A</code> 函数内部定义的变量时，闭包就形成了。</p><ul><li><code>...args</code> 是什么？为什么？</li></ul><p>在 JavaScript 中，<code>...args</code> 是一种称为 <strong>剩余参数（Rest Parameters）</strong> 的语法，它用于将函数的<strong>不定数量的参数</strong>收集到一个数组中。这样可以让函数接受任意数量的参数，并将它们组合在一起，便于操作和处理。</p><p>说到为什么要使用它，还得说说它的好处。假设有这样一个函数</p><figure class="shiki js"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">logArguments</span><span style="color: #D4D4D4">(...</span><span style="color: #9CDCFE">args</span><span style="color: #D4D4D4">) {</span></span><span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">args</span><span style="color: #D4D4D4">);  </span><span style="color: #6A9955">// args 是一个数组，包含了所有传入的参数</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">logArguments</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">);   </span><span style="color: #6A9955">// 输出 [1, 2, 3]</span></span><span class="line"><span style="color: #DCDCAA">logArguments</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"a"</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">"b"</span><span style="color: #D4D4D4">);  </span><span style="color: #6A9955">// 输出 ["a", "b"]</span></span><span class="line"><span style="color: #DCDCAA">logArguments</span><span style="color: #D4D4D4">();          </span><span style="color: #6A9955">// 输出 []</span></span></code></pre></div></div></figure><p>不论传入多少参数，有还是没有，它都能够接收并存储在 <code>args</code> 数组中。</p><p>那为什么防抖中要用到呢？</p><p>一来是为了使得函数能够处理任意数量的参数，使其更通用；二来是为了能够<strong>正确</strong>地传递参数。可别不以为意，有时候还真没多少人能正确地传递参数。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Vue笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用 python 创建简易的 http 服务传递文件</title>
    <link href="/archives/notes/22192.html"/>
    <url>/archives/notes/22192.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><h1 id="python快速搭建简易http服务器"><a class="markdownIt-Anchor" href="#python快速搭建简易http服务器"></a> python 快速搭建简易 http 服务器</h1><meta name="description" content="使用python创建简易的http服务传递文件"><h2 id="1-cd命令到你想要起服务的目录"><a class="markdownIt-Anchor" href="#1-cd命令到你想要起服务的目录"></a> 1、cd 命令到你想要起服务的目录</h2><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">cd</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">/var/www/html</span></span><span class="line"><span style="color: #DCDCAA">/*仅举例*/</span></span></code></pre></div></div></figure><h2 id="2-在终端运行"><a class="markdownIt-Anchor" href="#2-在终端运行"></a> 2、在终端运行</h2><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">python3.8</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-m</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">http.server</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">7777</span><span style="color: #CE9178">（python3）</span></span><span class="line"></span><span class="line"><span style="color: #DCDCAA">python3.8</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-m</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">SimpleHTTPServer</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">6666</span><span style="color: #CE9178">（python2）</span></span></code></pre></div></div></figure><p>请将上面的四位数数字端口号替换成你想要的端口，不出意外你会得到</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202303111111599.png" alt="image-20230311111120223"></p><p>这样就是正常的了。</p><h2 id="3-连接"><a class="markdownIt-Anchor" href="#3-连接"></a> 3、连接</h2><p>Linux 系统下：<br>如果你是虚拟机，请使用 <code>ifconfig</code> 查询到你的 ip，然后用 <strong>你查询到的 ip: 端口</strong> 进行连接；<br>如果你是公网服务器，直接使用 <strong>你的公网 ip: 端口</strong> 即可（请记得开放你所需要的端口）</p><p>Win 的话，查询 <code>ip</code> 请使用 <code>ipconfig</code><br>连接操作和上面一致</p><p>连接效果如下</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/202303111116954.png" alt="image-20230311111615917"></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>随记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>http</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>解决 hexo 主题无法显示使用相对路径的图床图片</title>
    <link href="/archives/notes/55208.html"/>
    <url>/archives/notes/55208.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="解决hexo主题无法显示使用相对路径的图床图片"><h1 id="解决hexo主题无法显示使用相对路径的图床图片"><a class="markdownIt-Anchor" href="#解决hexo主题无法显示使用相对路径的图床图片"></a> 解决 hexo 主题无法显示使用相对路径的图床图片</h1><h2 id="问题情况"><a class="markdownIt-Anchor" href="#问题情况"></a> 问题情况</h2><p>本地预览查看明明使用图床的图片缺无法正常显示，报 403 问题，显示如下</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20240626004028362.png" alt="image-20240626004028362"></p><h2 id="原因"><a class="markdownIt-Anchor" href="#原因"></a> 原因</h2><p>http 请求体的 header 中有一个 referrer 字段，用来表示发起 http 请求的源地址信息，这个 referrer 信息是可以省略但是不可修改的，只能设置是否带上这个 referrer 信息，而不能定制 referrer 里面的值。</p><p>服务器端在拿到这个 referrer 值后就可以进行相关的处理，比如图片资源，可以通过 referrer 值判断请求是否来自本站，若不是则返回 403 或者重定向返回其他信息，从而实现图片的防盗链。上面出现 403 就是因为，请求的是别人服务器上的资源，但把自己的 referrer 信息带过去了，被对方服务器拦截返回了 403。</p><h2 id="解决"><a class="markdownIt-Anchor" href="#解决"></a> 解决</h2><p>前端可以通过 meta 来设置 referrer policy (来源策略)，具体参考<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Referrer-Policy">这里</a>。浏览器中 referrer 默认的值是 <code>no-referrer-when-downgrade</code>，就是除了降级请求的情况以外都会带上 referrer 信息。降级请求是指 https 协议的地址去请求 http 协议，所以 403 的情况可以将请求的图片地址换成 http 协议，这样降级请求也不会带上 referrer。另一种推荐的方法是把 referrer 设置成 <code>no-referrer</code>，这样发送请求不会带上 referrer 信息，对方服务器也就无法拦截。</p><p>由于我个人使用的主题为 <code>fluid</code>，暂未找到可以直接修改的配置文件进行添加配置项配置 meta，所以采用的是每次写 md 文档时，在开头加上</p><figure class="shiki html"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">meta</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"referrer"</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">content</span><span style="color: #D4D4D4">=</span><span style="color: #CE9178">"no-referrer"</span><span style="color: #D4D4D4"> </span><span style="color: #808080">/&gt;</span></span></code></pre></div></div></figure><p>无需额外设置，如果使用的是 typora 会直接识别</p><p>如果你的主题可以找到配置文件进行 meta 项的添加修改，可以加上下面这句</p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4">meta(name="referrer" content="no-referrer")</span></span></code></pre></div></div></figure><p>最后别忘了使用 <code>hexo g</code> 重新生成一下，确认可行之后使用 <code>hexo d</code> 同步即可</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>随记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo图片问题</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用浏览器爬取 qq 群的用户 qq 号</title>
    <link href="/archives/notes/17306.html"/>
    <url>/archives/notes/17306.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="使用浏览器爬取qq群的用户qq号"><h1 id="使用浏览器爬取qq群的用户qq号"><a class="markdownIt-Anchor" href="#使用浏览器爬取qq群的用户qq号"></a> 使用浏览器爬取 qq 群的用户 qq 号</h1><p>首先登录 <a href="https://qun.qq.com/member.html">qq 群网页版</a><br>在控制台中运行 js 脚本提取 qq 号码:</p><figure class="shiki javascript"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">qq_sl</span><span style="color: #D4D4D4">=</span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getElementById</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"groupMemberNum"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">qq_js</span><span style="color: #D4D4D4">=</span><span style="color: #9CDCFE">Math</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">trunc</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">qq_sl</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">innerHTML</span><span style="color: #D4D4D4">/</span><span style="color: #B5CEA8">21</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">qq_number</span><span style="color: #D4D4D4">=</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #9CDCFE">window</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">scrollTo</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">,</span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">body</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">scrollHeight</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">qq_ds</span><span style="color: #D4D4D4">=</span><span style="color: #DCDCAA">setInterval</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">function</span><span style="color: #D4D4D4">(){</span></span><span class="line"><span style="color: #9CDCFE">window</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">scrollTo</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">,</span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">body</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">scrollHeight</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">qq_number</span><span style="color: #D4D4D4">++;</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"正在加载所有页面："</span><span style="color: #D4D4D4">+</span><span style="color: #9CDCFE">qq_number</span><span style="color: #D4D4D4">+</span><span style="color: #CE9178">"/"</span><span style="color: #D4D4D4">+</span><span style="color: #9CDCFE">qq_js</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">qq_js</span><span style="color: #D4D4D4">&lt;=</span><span style="color: #9CDCFE">qq_number</span><span style="color: #D4D4D4">){</span></span><span class="line"><span style="color: #DCDCAA">clearInterval</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">qq_ds</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"加载完毕，正在获取页面所有QQ号码..."</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">classan</span><span style="color: #D4D4D4"> =</span><span style="color: #9CDCFE">document</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getElementsByClassName</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"mb"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">number</span><span style="color: #D4D4D4">= </span><span style="color: #9CDCFE">classan</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4">;</span></span><span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">nr</span><span style="color: #D4D4D4">=</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; </span><span style="color: #9CDCFE">nr</span><span style="color: #D4D4D4">&lt; </span><span style="color: #9CDCFE">number</span><span style="color: #D4D4D4"> ; </span><span style="color: #9CDCFE">nr</span><span style="color: #D4D4D4">++){</span></span><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">class_qq</span><span style="color: #D4D4D4">=</span><span style="color: #9CDCFE">classan</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">nr</span><span style="color: #D4D4D4">].</span><span style="color: #DCDCAA">getAttribute</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"class"</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #569CD6">var</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">qq</span><span style="color: #D4D4D4">=</span><span style="color: #9CDCFE">qq</span><span style="color: #D4D4D4">+</span><span style="color: #CE9178">"</span><span style="color: #D7BA7D">\n</span><span style="color: #CE9178">"</span><span style="color: #D4D4D4">+</span><span style="color: #9CDCFE">class_qq</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">substring</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">qq</span><span style="color: #D4D4D4">);</span></span><span class="line"><span style="color: #D4D4D4">}</span></span><span class="line"><span style="color: #D4D4D4">},</span><span style="color: #B5CEA8">500</span><span style="color: #D4D4D4">);</span></span></code></pre></div></div></figure><p>生成字典，自行手动储存。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>随记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>浅略了解团队协作必须的 Git 的使用</title>
    <link href="/archives/Git/undefined.html"/>
    <url>/archives/Git/undefined.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><h1 id="git学习"><a class="markdownIt-Anchor" href="#git学习"></a> Git 学习</h1><h2 id="git能做什么"><a class="markdownIt-Anchor" href="#git能做什么"></a> Git 能做什么？</h2><p>Git 是一个分布式版本控制工具，主要用于管理文件。学习 Git 之后可以实现：</p><ul><li>代码回溯</li><li>版本切换</li><li>多人协作</li><li>远程备份</li></ul><h2 id="什么是本地仓库远程仓库"><a class="markdownIt-Anchor" href="#什么是本地仓库远程仓库"></a> 什么是本地仓库？远程仓库？</h2><p>本地仓库和远程仓库都可以顾名思义。当在本地创建了一个本地仓库之后，可以选择不推送到远程，这样也能实现本地文件的版本控制，当推送到远程仓库之后就可以免除换电脑的烦恼，且多人协作也可以流畅进行。</p><h2 id="git全局配置"><a class="markdownIt-Anchor" href="#git全局配置"></a> Git 全局配置</h2><p>安装 Git 只需找到官网然后一路下一步即可。</p><p>在安装之后可以将 git 加入环境变量方便使用，然后我们进行全局配置：配置用户名和 email 地址。之后的每次 Git 提交都会使用此配置信息。</p><p>在 Git 命令行中执行以下命令</p><ul><li>设置用户信息 </li></ul><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">config</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--global</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">user.name</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"Your Name"</span></span><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">config</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--global</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">user.email</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">"Your Email Address"</span></span></code></pre></div></div></figure><ul><li>查看配置信息</li></ul><p>配置好上面的信息后执行下面的命令进行检查</p><figure class="shiki sh"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #DCDCAA">git</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">config</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--list</span></span></code></pre></div></div></figure><blockquote><p>注：上面设置的用户信息的 user.name 和 user.email 并不一定要注册仓库的账号名和邮箱地址</p></blockquote><h2 id="git命令"><a class="markdownIt-Anchor" href="#git命令"></a> Git 命令</h2><h3 id="本地仓库"><a class="markdownIt-Anchor" href="#本地仓库"></a> 本地仓库</h3><ol><li>在任意目录下创建一个空目录（如 repo1）作为本地 Git 仓库</li><li>进入这个目录中，Git bash here</li><li> 执行命令 <code>git init</code></li></ol><p>如果在当前目录中可找到<code>.git</code> 文件夹（此文件夹为隐藏文件夹）则说明 Git 仓库创建成功</p><p>除了上述方法生成本地仓库，还可以克隆 <code>git clone repoAddress</code> 远程仓库到本地，这样也能拥有一个本地仓库，注意一个目录下只能存在一个仓库，且不用再准备一个空的目录，因为克隆下来的仓库会将仓库封装到以仓库名为名字的文件夹下</p><h4 id="常用命令"><a class="markdownIt-Anchor" href="#常用命令"></a> 常用命令</h4><table><thead><tr><th style="text-align:left">git status</th><th style="text-align:left"> 查看文件状态</th></tr></thead><tbody><tr><td style="text-align:left"> git add</td><td style="text-align:left"> 将文件的修改加入暂存区</td></tr><tr><td style="text-align:left"> git reset</td><td style="text-align:left"> 将暂存区的文件取消暂存或者是切换到指定的版本 git reset --hard version</td></tr><tr><td style="text-align:left">git commit</td><td style="text-align:left"> 将暂存区的文件修改提交到版本库</td></tr><tr><td style="text-align:left"> git log</td><td style="text-align:left"> 查看日志</td></tr></tbody></table><h4 id="基本概念"><a class="markdownIt-Anchor" href="#基本概念"></a> 基本概念</h4><blockquote><p>看到克隆或创建的仓库的<code>.git</code> 文件夹你可能会好奇这到底是什么？</p></blockquote><ul><li>版本库：其实该<code>.git</code> 文件夹就是版本库，版本库汇总存储了很多配置信息、日志信息、文件版本信息等</li><li>工作区：包含<code>.git</code> 文件夹的目录就是工作区，也成为工作目录，主要存放开发的代码文件</li><li>暂存区：<code>.git</code> 文件夹文件夹中有很多文件，当你新增一个文件（如 1.txt）与.git 文件夹同级，此时 <code>1.txt</code> 已经在工作区，但他还未被 Git 进行版本管理，Git 进行版本控制的流程为：<mark>工作区 -&gt; 暂存区 -&gt; 版本库</mark>。<br>所以此时要进行 <code>git add fileName1 filename2 ...</code> 操作将其添加到暂存区，此操作将会使得<code>.git</code> 目录下出现一个 <code>index</code> 文件，也可以叫做 stage，也就是暂存区了。<br>然后执行 <code>git commit -m "HintMsg" fileName</code> 即可将其提交到版本库中进行管理</li></ul><blockquote><p>那么工作区那么多文件，我该如何分辨哪些是被版本控制的哪些没有呢？</p></blockquote><p>Git 工作区中的文件存在两种状态：</p><ul><li>untracked 未跟踪（未被纳入版本控制）</li><li>tracked 已跟踪 （已被纳入版本控制）<ul><li>Unmodified 为修改状态</li><li> Modified 已修改状态</li><li> Staged 已暂存状态</li></ul></li></ul><p>可以执行指令 <code>git status</code> 查看当前仓库是否存在可提交的文件，并展示文件状态</p><p>注意：当一个文件已经被 tracked，之后只是进行了修改，是无需重新进行 <code>git add</code> 操作的，可以直接 commit，未被 commit 前它的状态是 Modified 属于 tracked 当中，可使用上述命令查看验证。</p><h3 id="远程仓库"><a class="markdownIt-Anchor" href="#远程仓库"></a> 远程仓库</h3><table><thead><tr><th style="text-align:left">git remote</th><th style="text-align:left"> 查看远程仓库，查看详细信息 git remote -v</th></tr></thead><tbody><tr><td style="text-align:left">git remote add <shortname> <url></url></shortname></td><td style="text-align:left">添加本地仓库关联的远程仓库，shortName 为别名一般为 origin</td></tr><tr><td style="text-align:left">git clone</td><td style="text-align:left"> 从远程仓库克隆</td></tr><tr><td style="text-align:left"> git pull</td><td style="text-align:left"> 从远程仓库拉取</td></tr><tr><td style="text-align:left"> git push <shorname> branchName</shorname></td><td style="text-align:left"> 推送到远程仓库</td></tr></tbody></table><h2 id="git分支"><a class="markdownIt-Anchor" href="#git分支"></a> Git 分支</h2><p>分支是 Git 使用过程中非常重要的概念。使用分支意味着你可以把你的工作从开发主线上分离开来，以免影响开发主线。<br>同一个仓库可以有多个分支，各个分支相互独立，互不干扰。<br>通过 <code>git init </code>命令创建本地仓库时默认会创建一个 master 分支。</p><table><thead><tr><th style="text-align:left">git branch</th><th style="text-align:left"> 查看分支，-r 列出所有远程分支，-a 列出所有本地分支和远程分支</th></tr></thead><tbody><tr><td style="text-align:left"> git branch [name]</td><td style="text-align:left"> 创建分支</td></tr><tr><td style="text-align:left"> git checkout [name]</td><td style="text-align:left"> 切换分支</td></tr><tr><td style="text-align:left"> git push [shortName] [name]</td><td style="text-align:left"> 推送至远程仓库分支</td></tr><tr><td style="text-align:left"> git merge [name]</td><td style="text-align:left"> 合并分支，将指定分支合并至当前分支</td></tr><tr><td style="text-align:left"> git branch -d [name]</td><td style="text-align:left"> 删除分支</td></tr></tbody></table><h2 id="git标签"><a class="markdownIt-Anchor" href="#git标签"></a> Git 标签</h2><p>GIt 标签类似快照，存储着某一时刻的代码内容、状态等。可类比为版本号 v1.0、v2.0 等</p><table><thead><tr><th style="text-align:left">git tag</th><th style="text-align:left"> 列出已有的标签</th></tr></thead><tbody><tr><td style="text-align:left"> git tag [name]</td><td style="text-align:left"> 创建标签</td></tr><tr><td style="text-align:left"> git push [shortName] [name]</td><td style="text-align:left"> 将标签推送到远程仓库</td></tr><tr><td style="text-align:left"> git checkout -b [branch] [name]</td><td style="text-align:left"> 检出标签</td></tr></tbody></table><blockquote><p>注意：检出标签必须使用 - b 指定检出的分支名，由于标签不是分支，所以切换到某个标签只能将其检出为一个分支，如：<code>git checkout -b bv1 v1.0</code></p></blockquote><h2 id="git-idea配置"><a class="markdownIt-Anchor" href="#git-idea配置"></a> Git &amp; IDEA 配置</h2><p>打开 IDEA 的设置，找到版本控制（Version Control）-&gt;Git，将 Git 的本地可执行文件路径（Path to Git executable）补充正确，如果自动检测可用也是可以的，点击右边的测试（Test）如果出现 Git 的版本号就可以，别忘了点击应用</p><p>之后只需要在一个打开的项目中，点击 IDEA 上方导航栏的 VCS-&gt; 创建 Git 仓库（Create Git Repository），选择你要进行管理的项目父文件夹，如：demo-project 下有 src、pom.xml 等文件，就可以选择 demo-project 作为仓库文件夹，<code>.git</code> 版本库会出现在和 src 同级的目录中。此后 VCS 就会变成 Git 了。</p><p>注：IDEA 已帮你省略 add 到暂存区的操作，可以直接选择要提交的文件进行 commit 即可</p><p>当你进行 commit 操作时可能会出现显示可提交的文件的视图而不是我们常看到的目录 - 文件等结构，这时你可以点击上方的小按钮进行选择，选择目录即可</p><p><img src="https://gitee.com/CSJ021005/f0ur_lin_-picgo/raw/master/image-20240626203148193.png" alt="image-20240626203148193"></p><p>在提交时，提交源码和必要的配置文件即可，无需提交字节码、target 文件夹等</p><p>那么文件那么多，我怎么选择性的提交呢？</p><p>这就是<code>.gitignore</code> 文件的作用之处了，这个文件可配置哪些文件是我们不需要进行提交的，例如：</p><figure class="shiki text"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki dark-plus"><code><span class="line"><span style="color: #D4D4D4"># Maven #</span></span><span class="line"><span style="color: #D4D4D4">target/</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4"># IDEA #</span></span><span class="line"><span style="color: #D4D4D4">.idea/</span></span><span class="line"><span style="color: #D4D4D4">*.iml</span></span><span class="line"><span style="color: #D4D4D4"></span></span><span class="line"><span style="color: #D4D4D4"># Eclipse #</span></span><span class="line"><span style="color: #D4D4D4">.settings/</span></span><span class="line"><span style="color: #D4D4D4">.classpath</span></span><span class="line"><span style="color: #D4D4D4">.project</span></span></code></pre></div></div></figure><p>带 <code>/</code> 的名字表示是一个文件夹而非文件</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Git笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>在 Windows 中启用 DOH 功能</title>
    <link href="/archives/notes/46175.html"/>
    <url>/archives/notes/46175.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><h1 id="windows设置中启用doh"><a class="markdownIt-Anchor" href="#windows设置中启用doh"></a> Windows 设置中启用 DOH</h1><meta name="description" content="在Windows中启用Google谷歌浏览器、Firefox浏览器的DOH功能"><blockquote><p>适用环境：Windows11（Win10 可以开启浏览器的 DOH）<br>DNS 检测工具：<a href="https://www.nstool.netease.com/">网易 DNS 在线检测</a><br>参考文章：</p><ul><li>网络设置 DOH：<a href="https://zhuanlan.zhihu.com/p/590105276">Windows 11 22H2 开启 DoH（DNS over HTTPS）</a></li><li>检测：<a href="https://wkings.blog/archives/1253">DNS、DoT、DoH 协议测试方法</a></li></ul></blockquote><h2 id="google浏览器和firefox浏览器启用doh"><a class="markdownIt-Anchor" href="#google浏览器和firefox浏览器启用doh"></a> Google 浏览器和 Firefox 浏览器启用 DOH</h2><blockquote><p>Google 浏览器版本：123.0.6312.86（正式版本） （64 位）<br>Firefox 浏览器版本：123.0.1 (64 位)</p></blockquote><h2 id="google浏览器"><a class="markdownIt-Anchor" href="#google浏览器"></a> Google 浏览器</h2><p>找到<code>设置-&gt;隐私和安全-&gt;安全-&gt;高级</code>在高级区启用使用安全 DNS，并填写 DNS 提供商即可。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32753108/1711905304052-6ab911ae-a57d-433f-9295-726ca12cf59d.png#averageHue=%2325272b&amp;clientId=u46ce7476-c18b-4&amp;from=paste&amp;height=542&amp;id=u7e72b470&amp;originHeight=723&amp;originWidth=1437&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=76344&amp;status=done&amp;style=none&amp;taskId=u66ac412b-9daf-4157-97cb-359a6bb90d3&amp;title=&amp;width=1078" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2024/png/32753108/1711905398251-83fc3bce-72de-4982-b6fc-00fda7a52c36.png#averageHue=%232d2e31&amp;clientId=u46ce7476-c18b-4&amp;from=paste&amp;height=425&amp;id=u8e9fd09e&amp;originHeight=566&amp;originWidth=689&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=37874&amp;status=done&amp;style=none&amp;taskId=ud8be3634-e5fe-48df-9622-8b69db22293&amp;title=&amp;width=517" alt="image.png"><br>DNS 提供商填写<a href="https://zhuanlan.zhihu.com/p/590105276">网络设置 DOH</a> 这篇参考文章中的就好。<br>所有设置妥当之后请调用 cmd 输入 <code>ipconfig /flushdns</code> 该命令使得设置生效。</p><h2 id="firefox浏览器"><a class="markdownIt-Anchor" href="#firefox浏览器"></a> Firefox 浏览器</h2><p>在设置页面直接搜索 <code>dns</code> 即可。设置如图：<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32753108/1711905924937-6e642b87-9294-4a5b-bcf4-567904db0425.png#averageHue=%23293741&amp;clientId=u46ce7476-c18b-4&amp;from=paste&amp;height=716&amp;id=ubbcb1742&amp;originHeight=955&amp;originWidth=683&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=64012&amp;status=done&amp;style=none&amp;taskId=ue1c01ceb-bcd1-4f4e-92bd-ca3db108d44&amp;title=&amp;width=512" alt="image.png"><br>DNS 提供商填写<a href="https://zhuanlan.zhihu.com/p/590105276">网络设置 DOH</a> 这篇参考文章中的就好。<br>所有设置妥当之后请调用 cmd 输入 <code>ipconfig /flushdns</code> 该命令使得设置生效。</p><h2 id="检测是否成功开启doh"><a class="markdownIt-Anchor" href="#检测是否成功开启doh"></a> 检测是否成功开启 DOH</h2><blockquote><p>涉及工具：<a href="https://dns.lookup.dog/#installation">dog 工具</a><br>协议：<br>-U, --udp Use the DNS protocol over UDP<br>-T, --tcp Use the DNS protocol over TCP<br>-S, --tls Use the DNS-over-TLS protocol<br>-H, --https Use the DNS-over-HTTPS protocol</p></blockquote><p>命令示例：<code>dog.exe -H @[https://dns.alidns.com/dns-query](https://dns.alidns.com/dns-query) bilibili.com</code></p><p>先写到这，想起什么了再补充。2024.4.1</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>随记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DOH</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>解决谷歌浏览器问题：您的浏览器由贵组织托管解决</title>
    <link href="/archives/notes/27484.html"/>
    <url>/archives/notes/27484.html</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.7.0/hint.min.css"><meta name="referrer" content="no-referrer"><meta name="description" content="解决Google浏览器：您的浏览器由贵组织托管"><h1 id="解决google浏览器您的浏览器由贵组织托管"><a class="markdownIt-Anchor" href="#解决google浏览器您的浏览器由贵组织托管"></a> 解决 Google 浏览器：您的浏览器由贵组织托管</h1><p>参考：<a href="https://blog.csdn.net/w528_net/article/details/119839068">https://blog.csdn.net/w528_net/article/details/119839068</a></p><p>注册表地址：<code>计算机\HKEY_CURRENT_USER\SOFTWARE\Policies\Google\Chrome</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>随记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Google浏览器</tag>
      
      <tag>谷歌浏览器</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
