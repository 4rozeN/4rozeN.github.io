let DarkmodeBtn=document.querySelector("#color-toggle-btn .nav-link"),BackgroundDiv=document.querySelector("#web_bg"),BackgroundImages={dark:{desktop:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/sunset-night.webp",mobile:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva_mobile.webp"},light:{desktop:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/Castle%20in%20the%20Sky.jpg",mobile:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva_mobile.webp"},defaultImage:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva.webp"},excludePages=["/","/links/","/about/","/categories/","/tags/"],isMobile=()=>window.innerWidth<768,preloadImages=()=>{let o=new Set;Object.values(BackgroundImages).forEach(e=>{"object"==typeof e?(o.add(e.desktop),o.add(e.mobile)):o.add(e)}),o.forEach(e=>{(new Image).src=e})},setBackgroundImage=(e,o)=>{var a=isMobile();let t;t=o||(null!==e&&!excludePages.includes(location.pathname)&&e?a?BackgroundImages[e].mobile:BackgroundImages[e].desktop:a?BackgroundImages.dark.mobile:BackgroundImages.defaultImage),BackgroundDiv.setAttribute("style",`background-image: url(${t});`)},getCurrentMode=()=>"dark"===document.documentElement.getAttribute("data-user-color-scheme")?"dark":"light",handleToggleMode=()=>{var e=getCurrentMode();excludePages.includes(location.pathname)||setBackgroundImage(e)},resizeTimeout,handleResize=()=>{clearTimeout(resizeTimeout),resizeTimeout=setTimeout(()=>{var e=getCurrentMode();setBackgroundImage(e)},200)},initBackground=()=>{preloadImages();var e=location.pathname,o=getCurrentMode(),e=(excludePages.includes(e)?setBackgroundImage(null):setBackgroundImage(o),document.querySelector("#banner")),o=document.querySelector("#banner .mask");e&&e.setAttribute("style","background-image: url()"),o&&o.setAttribute("style","background-color: rgba(0,0,0,0)")};DarkmodeBtn?DarkmodeBtn.addEventListener("click",()=>{setTimeout(()=>{handleToggleMode()},100)}):console.warn("未找到切换按钮"),window.addEventListener("resize",handleResize,{passive:!0}),window.addEventListener("DOMContentLoaded",()=>{console.log("DOM 加载完毕，将初始化背景图"),initBackground()});