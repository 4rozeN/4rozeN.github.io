let DarkmodeBtn=document.querySelector("#color-toggle-btn .nav-link"),BackgroundDiv=document.querySelector("#web_bg"),BackgroundImages={dark:{desktop:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/sunset-night.webp",mobile:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva_mobile.webp"},light:{desktop:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/Castle%20in%20the%20Sky.jpg",mobile:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva_mobile.webp"},defaultImage:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva.webp"},excludePages=["/","/links/","/about/","/categories/","/tags/"],isMobile=()=>window.matchMedia("(max-width: 768px)").matches,preloadImages=()=>{let o=new Set;Object.values(BackgroundImages).forEach(e=>{"object"==typeof e?(o.add(e.desktop),o.add(e.mobile)):o.add(e)}),o.forEach(e=>{(new Image).src=e}),console.log("preload completed.")},setBackgroundImage=(e,o=void 0)=>{var a=isMobile();let t;o?(t=o,console.log("当前页面将使用自定义背景图")):null===e?(t=a?BackgroundImages.dark.mobile:BackgroundImages.defaultImage,console.log("当前页面将使用默认背景图")):(t=a?BackgroundImages[e].mobile:BackgroundImages[e].desktop,console.log(`当前使用${e}模式背景图`)),BackgroundDiv.setAttribute("style",`background-image: url(${t});`)},getCurrentMode=()=>"dark"===document.documentElement.getAttribute("data-user-color-scheme")?(console.log("当前模式为：dark（从 <html> data-user-color-scheme 获取）"),"dark"):(console.log("当前模式为：light（从 <html> data-user-color-scheme 获取）"),"light"),handleToggleMode=()=>{var e=getCurrentMode();excludePages.includes(location.pathname)?console.log("当前页面无需切换背景"):(console.log("模式切换，将重新设置背景"),setBackgroundImage(e))},initBackground=()=>{preloadImages();var e=location.pathname,o=getCurrentMode(),e=(excludePages.includes(e)?setBackgroundImage(null):setBackgroundImage(o),document.querySelector("#banner")),o=document.querySelector("#banner .mask");e&&e.setAttribute("style","background-image: url()"),o&&o.setAttribute("style","background-color: rgba(0,0,0,0)")};DarkmodeBtn?DarkmodeBtn.addEventListener("click",()=>{setTimeout(()=>{handleToggleMode()},100)}):console.warn("未找到切换按钮"),window.addEventListener("DOMContentLoaded",()=>{console.log("DOM 加载完毕，将初始化背景图"),initBackground()});