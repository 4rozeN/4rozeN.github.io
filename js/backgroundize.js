let DarkmodeBtn=document.querySelector("#color-toggle-btn .nav-link"),BackgroundDiv=document.querySelector("#web_bg"),BackgroundImages={dark:{desktop:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/sunset-night.webp",mobile:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva_mobile.webp"},light:{desktop:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/ruanmei.webp",mobile:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva_mobile.webp"},defaultImage:"https://ali-4rozen-oss.oss-cn-guangzhou.aliyuncs.com/blog/eva.webp"},excludePages=["/","/links/","/about/","/categories/","/tags/","/collections/"],isMobile=()=>window.innerWidth<768,clearBannerMask=()=>{var e=document.querySelector("#banner .mask");e&&(e.style.backgroundColor="rgba(0,0,0,0)")},preloadImages=()=>{let o=new Set;Object.values(BackgroundImages).forEach(e=>{"object"==typeof e?(o.add(e.desktop),o.add(e.mobile)):o.add(e)}),o.forEach(e=>{(new Image).src=e})},setBackgroundImage=(e,o)=>{var a=isMobile();let n;n=o||(null!==e&&!excludePages.includes(location.pathname)&&e?a?BackgroundImages[e].mobile:BackgroundImages[e].desktop:a?BackgroundImages.dark.mobile:BackgroundImages.defaultImage),BackgroundDiv.style.backgroundImage=`url(${n})`},getCurrentMode=()=>"dark"===document.documentElement.getAttribute("data-user-color-scheme")?"dark":"light",handleToggleMode=()=>{var e=getCurrentMode();excludePages.includes(location.pathname)||setBackgroundImage(e),clearBannerMask()},resizeTimeout,handleResize=()=>{clearTimeout(resizeTimeout),resizeTimeout=setTimeout(()=>{var e=getCurrentMode();setBackgroundImage(e)},200)},initBackground=()=>{preloadImages();var e=location.pathname,o=getCurrentMode();excludePages.includes(e)?setBackgroundImage(null):setBackgroundImage(o),clearBannerMask()};DarkmodeBtn?DarkmodeBtn.addEventListener("click",()=>{setTimeout(()=>{handleToggleMode()},100)}):console.warn("未找到切换按钮"),window.addEventListener("resize",handleResize,{passive:!0}),window.addEventListener("DOMContentLoaded",()=>{console.log("DOM 加载完毕，将初始化背景图"),initBackground()});